Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_1', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=1, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 1 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.7231216430664062
loss_r_feature 40.29237365722656
main criterion 0.36087942123413086
------------iteration 200----------
total loss 2.503411293029785
loss_r_feature 40.40550994873047
main criterion 0.16286112368106842
------------iteration 300----------
total loss 1.819865107536316
loss_r_feature 29.02208709716797
main criterion 0.08838255703449249
------------iteration 400----------
total loss 1.9233100414276123
loss_r_feature 30.958574295043945
main criterion 0.1029631495475769
------------iteration 500----------
total loss 1.535439372062683
loss_r_feature 25.70187759399414
main criterion 0.002520623616874218
------------iteration 600----------
total loss 1.765903115272522
loss_r_feature 26.977497100830078
main criterion 0.1845233291387558
------------iteration 700----------
total loss 0.9536904096603394
loss_r_feature 13.340188980102539
main criterion 0.09924715012311935
------------iteration 800----------
total loss 0.4898947775363922
loss_r_feature 6.395015239715576
main criterion 0.016724325716495514
------------iteration 900----------
total loss 0.528343915939331
loss_r_feature 7.380703926086426
main criterion 0.0018426955211907625
------------iteration 1000----------
total loss 0.455365389585495
loss_r_feature 6.051076889038086
main criterion 0.0023757116869091988
------------iteration 1100----------
total loss 0.259570837020874
loss_r_feature 2.497112989425659
main criterion 0.0005542102153412998
------------iteration 1200----------
total loss 0.2203383445739746
loss_r_feature 1.997882604598999
main criterion 7.752415694994852e-05
------------iteration 1300----------
total loss 0.1733846813440323
loss_r_feature 1.2418582439422607
main criterion 6.652080628555268e-05
------------iteration 1400----------
total loss 0.15923228859901428
loss_r_feature 0.9766688346862793
main criterion 4.007151073892601e-05
------------iteration 1500----------
total loss 0.1666708141565323
loss_r_feature 1.2182576656341553
main criterion 4.4963377149542794e-05
------------iteration 1600----------
total loss 0.1393536776304245
loss_r_feature 0.6877270936965942
main criterion 2.7371437681722455e-05
------------iteration 1700----------
total loss 0.12370630353689194
loss_r_feature 0.3941519558429718
main criterion 1.1216664461244363e-05
------------iteration 1800----------
total loss 0.1169087290763855
loss_r_feature 0.27573272585868835
main criterion 1.1869537047459744e-05
------------iteration 1900----------
total loss 0.11110704392194748
loss_r_feature 0.16588851809501648
main criterion 1.019791579892626e-05
------------iteration 2000----------
total loss 0.1114932969212532
loss_r_feature 0.1718386858701706
main criterion 1.3064498489256948e-05
------------iteration 2100----------
total loss 1.6436266899108887
loss_r_feature 22.454652786254883
main criterion 0.0842347964644432
------------iteration 2200----------
total loss 0.6948880553245544
loss_r_feature 7.58891487121582
main criterion 0.007941621355712414
------------iteration 2300----------
total loss 0.38167813420295715
loss_r_feature 2.325087070465088
main criterion 0.0003574850270524621
------------iteration 2400----------
total loss 0.4947645664215088
loss_r_feature 4.971203804016113
main criterion 0.0006063582259230316
------------iteration 2500----------
total loss 0.6027705669403076
loss_r_feature 7.278691291809082
main criterion 0.00013185886200517416
------------iteration 2600----------
total loss 0.3729974329471588
loss_r_feature 3.099088191986084
main criterion 2.4868006221367978e-05
------------iteration 2700----------
total loss 0.28746217489242554
loss_r_feature 1.5394271612167358
main criterion 1.5471132428501733e-05
------------iteration 2800----------
total loss 0.24918639659881592
loss_r_feature 0.9453940391540527
main criterion 2.9948201699880883e-05
------------iteration 2900----------
total loss 0.22006915509700775
loss_r_feature 0.3826822340488434
main criterion 2.6094276108779013e-05
------------iteration 3000----------
total loss 0.20953698456287384
loss_r_feature 0.1832837015390396
main criterion 3.319587267469615e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_2', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=2, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 2 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.293046712875366
loss_r_feature 26.73004150390625
main criterion 0.5643364787101746
------------iteration 200----------
total loss 1.8116281032562256
loss_r_feature 24.443357467651367
main criterion 0.22331060469150543
------------iteration 300----------
total loss 1.1103096008300781
loss_r_feature 16.309328079223633
main criterion 0.0014699199236929417
------------iteration 400----------
total loss 1.1038364171981812
loss_r_feature 12.824661254882812
main criterion 0.21905383467674255
------------iteration 500----------
total loss 0.8762940168380737
loss_r_feature 12.581653594970703
main criterion 0.009644310921430588
------------iteration 600----------
total loss 0.6009095907211304
loss_r_feature 8.080216407775879
main criterion 0.00046993684372864664
------------iteration 700----------
total loss 0.5663182139396667
loss_r_feature 7.539716720581055
main criterion 0.0007948434795252979
------------iteration 800----------
total loss 0.49906301498413086
loss_r_feature 6.5455217361450195
main criterion 0.0005425006966106594
------------iteration 900----------
total loss 0.39064329862594604
loss_r_feature 4.789621829986572
main criterion 0.0004010839038528502
------------iteration 1000----------
total loss 0.32943540811538696
loss_r_feature 3.8097739219665527
main criterion 0.0008408601861447096
------------iteration 1100----------
total loss 0.30682241916656494
loss_r_feature 3.361258029937744
main criterion 0.0013079253258183599
------------iteration 1200----------
total loss 0.22760629653930664
loss_r_feature 2.1107640266418457
main criterion 0.0003861031436827034
------------iteration 1300----------
total loss 0.20624329149723053
loss_r_feature 1.9727140665054321
main criterion 0.0001768669462762773
------------iteration 1400----------
total loss 0.1750001460313797
loss_r_feature 1.443512201309204
main criterion 0.00043136958265677094
------------iteration 1500----------
total loss 0.16388919949531555
loss_r_feature 1.3132696151733398
main criterion 7.492681470466778e-05
------------iteration 1600----------
total loss 0.14919793605804443
loss_r_feature 1.0803354978561401
main criterion 9.750125900609419e-05
------------iteration 1700----------
total loss 0.13677603006362915
loss_r_feature 0.8732635974884033
main criterion 3.7648431316483766e-05
------------iteration 1800----------
total loss 0.12775364518165588
loss_r_feature 0.7161685824394226
main criterion 4.246789467288181e-05
------------iteration 1900----------
total loss 0.12528380751609802
loss_r_feature 0.6794813275337219
main criterion 7.265823660418391e-05
------------iteration 2000----------
total loss 0.12206383794546127
loss_r_feature 0.6162253618240356
main criterion 5.1673796406248584e-05
------------iteration 2100----------
total loss 1.3159396648406982
loss_r_feature 15.645282745361328
main criterion 0.004689736757427454
------------iteration 2200----------
total loss 0.7266275882720947
loss_r_feature 7.782593250274658
main criterion 0.0023430553264915943
------------iteration 2300----------
total loss 0.45291534066200256
loss_r_feature 3.6553640365600586
main criterion 0.0002587295894045383
------------iteration 2400----------
total loss 0.3697371780872345
loss_r_feature 2.8515865802764893
main criterion 0.0007244304288178682
------------iteration 2500----------
total loss 0.4041292667388916
loss_r_feature 3.7310309410095215
main criterion 0.0003564299549907446
------------iteration 2600----------
total loss 0.31078967452049255
loss_r_feature 2.495744228363037
main criterion 0.00013199460227042437
------------iteration 2700----------
total loss 0.25662586092948914
loss_r_feature 1.5671021938323975
main criterion 4.4031428842572495e-05
------------iteration 2800----------
total loss 0.22412793338298798
loss_r_feature 1.1322810649871826
main criterion 9.452210360905156e-05
------------iteration 2900----------
total loss 0.20097950100898743
loss_r_feature 0.6892638802528381
main criterion 6.642055086558685e-05
------------iteration 3000----------
total loss 0.1924704611301422
loss_r_feature 0.5215474963188171
main criterion 8.938508108258247e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_3', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=3, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 3 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1733063459396362
loss_r_feature 13.540124893188477
main criterion 0.12743738293647766
------------iteration 200----------
total loss 1.2694703340530396
loss_r_feature 13.268285751342773
main criterion 0.2512500584125519
------------iteration 300----------
total loss 0.7129278779029846
loss_r_feature 8.590993881225586
main criterion 0.0023655041586607695
------------iteration 400----------
total loss 0.7499204874038696
loss_r_feature 8.049696922302246
main criterion 0.08842577040195465
------------iteration 500----------
total loss 0.6899486780166626
loss_r_feature 8.268572807312012
main criterion 0.012765072286128998
------------iteration 600----------
total loss 0.6899418830871582
loss_r_feature 7.4354400634765625
main criterion 0.07970412075519562
------------iteration 700----------
total loss 0.47579410672187805
loss_r_feature 4.897103786468506
main criterion 0.03420497104525566
------------iteration 800----------
total loss 0.40127089619636536
loss_r_feature 4.235881805419922
main criterion 0.009790358133614063
------------iteration 900----------
total loss 0.36118966341018677
loss_r_feature 3.8460423946380615
main criterion 0.00032809344702400267
------------iteration 1000----------
total loss 0.30993056297302246
loss_r_feature 3.2210347652435303
main criterion 0.0008715773583389819
------------iteration 1100----------
total loss 0.23262368142604828
loss_r_feature 2.0542619228363037
main criterion 0.0005686801741831005
------------iteration 1200----------
total loss 0.2706673741340637
loss_r_feature 3.367208957672119
main criterion 0.00021247022959869355
------------iteration 1300----------
total loss 0.222866490483284
loss_r_feature 2.585404872894287
main criterion 5.8735255151987076e-05
------------iteration 1400----------
total loss 0.13503983616828918
loss_r_feature 0.9583032131195068
main criterion 2.459807728882879e-05
------------iteration 1500----------
total loss 0.15388916432857513
loss_r_feature 1.3926016092300415
main criterion 7.818220183253288e-05
------------iteration 1600----------
total loss 0.13644346594810486
loss_r_feature 1.1192809343338013
main criterion 2.6199404601356946e-05
------------iteration 1700----------
total loss 0.11175783723592758
loss_r_feature 0.6576542854309082
main criterion 2.327059701201506e-05
------------iteration 1800----------
total loss 0.1078575924038887
loss_r_feature 0.6097404956817627
main criterion 2.396877243882045e-05
------------iteration 1900----------
total loss 0.10385095328092575
loss_r_feature 0.5437394380569458
main criterion 3.438745261519216e-05
------------iteration 2000----------
total loss 0.1026519313454628
loss_r_feature 0.5221608877182007
main criterion 2.7570518795982935e-05
------------iteration 2100----------
total loss 0.6929527521133423
loss_r_feature 4.820018291473389
main criterion 0.03169259428977966
------------iteration 2200----------
total loss 0.6952108144760132
loss_r_feature 5.335812568664551
main criterion 0.046010348945856094
------------iteration 2300----------
total loss 0.5816672444343567
loss_r_feature 3.609440565109253
main criterion 0.09341604262590408
------------iteration 2400----------
total loss 0.40455129742622375
loss_r_feature 2.2384843826293945
main criterion 0.0009585340740159154
------------iteration 2500----------
total loss 0.3092997372150421
loss_r_feature 1.5595359802246094
main criterion 0.00025510237901471555
------------iteration 2600----------
total loss 0.2312847226858139
loss_r_feature 1.583225131034851
main criterion 6.014610335114412e-05
------------iteration 2700----------
total loss 0.20253866910934448
loss_r_feature 1.230883002281189
main criterion 2.5152441594400443e-05
------------iteration 2800----------
total loss 0.19528180360794067
loss_r_feature 1.219369649887085
main criterion 7.466420356649905e-05
------------iteration 2900----------
total loss 0.1664249449968338
loss_r_feature 0.6332316994667053
main criterion 8.109182817861438e-05
------------iteration 3000----------
total loss 0.16333520412445068
loss_r_feature 0.5553513169288635
main criterion 8.363366214325652e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_4', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=4, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 4 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.972151517868042
loss_r_feature 45.46154022216797
main criterion 0.323655903339386
------------iteration 200----------
total loss 2.5555899143218994
loss_r_feature 43.401432037353516
main criterion 0.041584279388189316
------------iteration 300----------
total loss 1.797560691833496
loss_r_feature 27.574581146240234
main criterion 0.143703430891037
------------iteration 400----------
total loss 1.5907526016235352
loss_r_feature 25.68231773376465
main criterion 0.040227774530649185
------------iteration 500----------
total loss 1.5178850889205933
loss_r_feature 25.129358291625977
main criterion 0.0028357720002532005
------------iteration 600----------
total loss 1.2689439058303833
loss_r_feature 20.643592834472656
main criterion 0.0030963346362113953
------------iteration 700----------
total loss 1.0734411478042603
loss_r_feature 16.726398468017578
main criterion 0.03371633589267731
------------iteration 800----------
total loss 1.0716692209243774
loss_r_feature 17.273658752441406
main criterion 0.003007306484505534
------------iteration 900----------
total loss 0.7949889898300171
loss_r_feature 12.141156196594238
main criterion 0.010876943357288837
------------iteration 1000----------
total loss 0.515874981880188
loss_r_feature 7.071050643920898
main criterion 0.0006817183457314968
------------iteration 1100----------
total loss 0.36405861377716064
loss_r_feature 4.255572319030762
main criterion 0.001685897703282535
------------iteration 1200----------
total loss 0.21236258745193481
loss_r_feature 1.8218845129013062
main criterion 0.0005605504848062992
------------iteration 1300----------
total loss 0.25514471530914307
loss_r_feature 2.680943012237549
main criterion 0.00028001246391795576
------------iteration 1400----------
total loss 0.16932418942451477
loss_r_feature 1.0965712070465088
main criterion 2.598918763396796e-05
------------iteration 1500----------
total loss 0.16988059878349304
loss_r_feature 1.1685786247253418
main criterion 3.307891165604815e-05
------------iteration 1600----------
total loss 0.16339212656021118
loss_r_feature 1.0961819887161255
main criterion 2.613998731249012e-05
------------iteration 1700----------
total loss 0.13427244126796722
loss_r_feature 0.5182648301124573
main criterion 1.5712392269051634e-05
------------iteration 1800----------
total loss 0.13120971620082855
loss_r_feature 0.4838670790195465
main criterion 2.215503263869323e-05
------------iteration 1900----------
total loss 0.12484108656644821
loss_r_feature 0.36601096391677856
main criterion 1.8879987692344002e-05
------------iteration 2000----------
total loss 0.12428727746009827
loss_r_feature 0.3538340926170349
main criterion 1.0742854101408739e-05
------------iteration 2100----------
total loss 1.3488608598709106
loss_r_feature 14.903648376464844
main criterion 0.22086603939533234
------------iteration 2200----------
total loss 1.1924729347229004
loss_r_feature 15.775184631347656
main criterion 0.0004944927059113979
------------iteration 2300----------
total loss 0.8972072601318359
loss_r_feature 10.855027198791504
main criterion 0.0012090308591723442
------------iteration 2400----------
total loss 0.3870880603790283
loss_r_feature 2.609649658203125
main criterion 0.001360834576189518
------------iteration 2500----------
total loss 0.3340608775615692
loss_r_feature 2.373751401901245
main criterion 8.236871508415788e-05
------------iteration 2600----------
total loss 0.3174232840538025
loss_r_feature 2.303398609161377
main criterion 8.005851123016328e-05
------------iteration 2700----------
total loss 0.2535654902458191
loss_r_feature 1.0839005708694458
main criterion 1.8184518921771087e-05
------------iteration 2800----------
total loss 0.2657677233219147
loss_r_feature 1.3090136051177979
main criterion 3.103266135440208e-05
------------iteration 2900----------
total loss 0.2223767191171646
loss_r_feature 0.5018066167831421
main criterion 2.348071757296566e-05
------------iteration 3000----------
total loss 0.2101379930973053
loss_r_feature 0.27833640575408936
main criterion 2.7008707547793165e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_5', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=5, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 5 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.058311700820923
loss_r_feature 21.384906768798828
main criterion 0.589435875415802
------------iteration 200----------
total loss 1.3564269542694092
loss_r_feature 19.097061157226562
main criterion 0.03589162230491638
------------iteration 300----------
total loss 1.2303078174591064
loss_r_feature 17.113847732543945
main criterion 0.042195260524749756
------------iteration 400----------
total loss 1.019209861755371
loss_r_feature 13.815042495727539
main criterion 0.04135393351316452
------------iteration 500----------
total loss 0.878119945526123
loss_r_feature 11.75529956817627
main criterion 0.04235958307981491
------------iteration 600----------
total loss 0.7312214374542236
loss_r_feature 7.96562385559082
main criterion 0.12920673191547394
------------iteration 700----------
total loss 0.4765256345272064
loss_r_feature 6.157846450805664
main criterion 0.00040110122063197196
------------iteration 800----------
total loss 0.49383533000946045
loss_r_feature 6.74260139465332
main criterion 0.00435267761349678
------------iteration 900----------
total loss 0.3803456127643585
loss_r_feature 4.625062465667725
main criterion 0.00018920109141618013
------------iteration 1000----------
total loss 0.3129952549934387
loss_r_feature 3.7803707122802734
main criterion 0.0002367079141549766
------------iteration 1100----------
total loss 0.29861029982566833
loss_r_feature 3.8860182762145996
main criterion 0.0002148856146959588
------------iteration 1200----------
total loss 0.3277668356895447
loss_r_feature 4.675710678100586
main criterion 2.626460809551645e-05
------------iteration 1300----------
total loss 0.25319358706474304
loss_r_feature 3.2636115550994873
main criterion 4.312601959099993e-05
------------iteration 1400----------
total loss 0.21769864857196808
loss_r_feature 2.6147265434265137
main criterion 5.820192745886743e-05
------------iteration 1500----------
total loss 0.19226470589637756
loss_r_feature 2.1645262241363525
main criterion 5.417062129708938e-05
------------iteration 1600----------
total loss 0.15507954359054565
loss_r_feature 1.4596563577651978
main criterion 4.105036350665614e-05
------------iteration 1700----------
total loss 0.13851675391197205
loss_r_feature 1.1326494216918945
main criterion 4.4061376684112474e-05
------------iteration 1800----------
total loss 0.13469098508358002
loss_r_feature 1.0659072399139404
main criterion 3.488598304102197e-05
------------iteration 1900----------
total loss 0.12911641597747803
loss_r_feature 0.9596360325813293
main criterion 5.7857359934132546e-05
------------iteration 2000----------
total loss 0.1273859143257141
loss_r_feature 0.9257245659828186
main criterion 3.825193925877102e-05
------------iteration 2100----------
total loss 0.7133566737174988
loss_r_feature 7.417241096496582
main criterion 0.001398678170517087
------------iteration 2200----------
total loss 0.4496004283428192
loss_r_feature 4.856996059417725
main criterion 0.00024710476282052696
------------iteration 2300----------
total loss 0.41578906774520874
loss_r_feature 4.464107036590576
main criterion 0.00014900427777320147
------------iteration 2400----------
total loss 0.37664511799812317
loss_r_feature 3.959932327270508
main criterion 0.00028038566233590245
------------iteration 2500----------
total loss 0.3940286636352539
loss_r_feature 4.270394325256348
main criterion 0.00011606710904743522
------------iteration 2600----------
total loss 0.3719421625137329
loss_r_feature 4.073553562164307
main criterion 0.00013386693899519742
------------iteration 2700----------
total loss 0.3553934395313263
loss_r_feature 4.005148410797119
main criterion 6.433919770643115e-05
------------iteration 2800----------
total loss 0.241278275847435
loss_r_feature 1.953763723373413
main criterion 0.00012413680087774992
------------iteration 2900----------
total loss 0.1956343799829483
loss_r_feature 1.1414154767990112
main criterion 7.733491656836122e-05
------------iteration 3000----------
total loss 0.1913316249847412
loss_r_feature 1.0731573104858398
main criterion 0.00010782746539916843
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_6', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=6, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 6 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1036441326141357
loss_r_feature 5.7360148429870605
main criterion 0.4401158392429352
------------iteration 200----------
total loss 0.7187400460243225
loss_r_feature 6.181490421295166
main criterion 0.014279307797551155
------------iteration 300----------
total loss 0.516806423664093
loss_r_feature 4.256775856018066
main criterion 0.008824056014418602
------------iteration 400----------
total loss 0.4953001141548157
loss_r_feature 4.088367938995361
main criterion 0.003930453211069107
------------iteration 500----------
total loss 0.4040348529815674
loss_r_feature 3.275548219680786
main criterion 0.0012759523233398795
------------iteration 600----------
total loss 0.35732775926589966
loss_r_feature 2.8885650634765625
main criterion 0.003504851832985878
------------iteration 700----------
total loss 0.31375160813331604
loss_r_feature 2.4981331825256348
main criterion 0.0007065685349516571
------------iteration 800----------
total loss 0.35947614908218384
loss_r_feature 2.4673733711242676
main criterion 0.05356532707810402
------------iteration 900----------
total loss 0.24849656224250793
loss_r_feature 1.8551948070526123
main criterion 5.767300899606198e-05
------------iteration 1000----------
total loss 0.2529880106449127
loss_r_feature 2.557224988937378
main criterion 0.00026868534041568637
------------iteration 1100----------
total loss 0.18323716521263123
loss_r_feature 1.2987477779388428
main criterion 0.0007016770541667938
------------iteration 1200----------
total loss 0.16685770452022552
loss_r_feature 1.2935703992843628
main criterion 0.0001150376265286468
------------iteration 1300----------
total loss 0.1556985080242157
loss_r_feature 1.2736879587173462
main criterion 0.00030313446768559515
------------iteration 1400----------
total loss 0.12991896271705627
loss_r_feature 0.9813722968101501
main criterion 4.753277971758507e-05
------------iteration 1500----------
total loss 0.11464089900255203
loss_r_feature 0.8280437588691711
main criterion 6.69681976432912e-05
------------iteration 1600----------
total loss 0.10492280125617981
loss_r_feature 0.7416689395904541
main criterion 8.047770097618923e-05
------------iteration 1700----------
total loss 0.09521537274122238
loss_r_feature 0.5879287123680115
main criterion 2.893253076763358e-05
------------iteration 1800----------
total loss 0.0869072750210762
loss_r_feature 0.45670366287231445
main criterion 2.8741338610416278e-05
------------iteration 1900----------
total loss 0.08389423787593842
loss_r_feature 0.41648778319358826
main criterion 4.9690268497215584e-05
------------iteration 2000----------
total loss 0.08293942362070084
loss_r_feature 0.39996474981307983
main criterion 3.8604695873800665e-05
------------iteration 2100----------
total loss 0.37995022535324097
loss_r_feature 2.17549204826355
main criterion 0.00963436346501112
------------iteration 2200----------
total loss 0.5248498916625977
loss_r_feature 2.8726367950439453
main criterion 0.0018917231354862452
------------iteration 2300----------
total loss 0.3877476155757904
loss_r_feature 2.1686079502105713
main criterion 0.0002712535497266799
------------iteration 2400----------
total loss 0.32616177201271057
loss_r_feature 2.5447583198547363
main criterion 0.00042531435610726476
------------iteration 2500----------
total loss 0.24345603585243225
loss_r_feature 1.7119264602661133
main criterion 0.00012836710084229708
------------iteration 2600----------
total loss 0.2694241404533386
loss_r_feature 2.551910877227783
main criterion 0.0001703342713881284
------------iteration 2700----------
total loss 0.16486874222755432
loss_r_feature 0.8611270785331726
main criterion 3.301134711364284e-05
------------iteration 2800----------
total loss 0.14310485124588013
loss_r_feature 0.6878305077552795
main criterion 4.1894589230651036e-05
------------iteration 2900----------
total loss 0.13018667697906494
loss_r_feature 0.5496907830238342
main criterion 7.377561269095168e-05
------------iteration 3000----------
total loss 0.12444998323917389
loss_r_feature 0.46142828464508057
main criterion 9.130345279118046e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_7', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=7, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 7 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0449156761169434
loss_r_feature 2.6591122150421143
main criterion 0.5792412757873535
------------iteration 200----------
total loss 0.6518824696540833
loss_r_feature 3.3153226375579834
main criterion 0.11016546934843063
------------iteration 300----------
total loss 0.45916107296943665
loss_r_feature 2.3400278091430664
main criterion 0.029020465910434723
------------iteration 400----------
total loss 0.4057967960834503
loss_r_feature 1.854844331741333
main criterion 0.04304997995495796
------------iteration 500----------
total loss 0.34134534001350403
loss_r_feature 1.6840598583221436
main criterion 0.0024561933241784573
------------iteration 600----------
total loss 0.32002460956573486
loss_r_feature 1.4340312480926514
main criterion 0.030793264508247375
------------iteration 700----------
total loss 0.21898797154426575
loss_r_feature 1.0755624771118164
main criterion 0.0005392232560552657
------------iteration 800----------
total loss 0.23557747900485992
loss_r_feature 1.1359230279922485
main criterion 0.0033882143907248974
------------iteration 900----------
total loss 0.20408765971660614
loss_r_feature 0.9338428974151611
main criterion 7.746893243165687e-05
------------iteration 1000----------
total loss 0.17963828146457672
loss_r_feature 0.8992283344268799
main criterion 0.000529530574567616
------------iteration 1100----------
total loss 0.14602938294410706
loss_r_feature 0.7326292991638184
main criterion 6.300646055024117e-05
------------iteration 1200----------
total loss 0.10921834409236908
loss_r_feature 0.6668269038200378
main criterion 4.017158425995149e-05
------------iteration 1300----------
total loss 0.11891642957925797
loss_r_feature 0.7346161603927612
main criterion 0.00032494214246980846
------------iteration 1400----------
total loss 0.09549597650766373
loss_r_feature 0.5735225081443787
main criterion 1.985337985388469e-05
------------iteration 1500----------
total loss 0.09381613880395889
loss_r_feature 0.7203315496444702
main criterion 4.7455407184315845e-05
------------iteration 1600----------
total loss 0.0811081975698471
loss_r_feature 0.5865603089332581
main criterion 5.282521669869311e-05
------------iteration 1700----------
total loss 0.06793441623449326
loss_r_feature 0.4026288390159607
main criterion 2.6006564439740032e-05
------------iteration 1800----------
total loss 0.06416390091180801
loss_r_feature 0.3727414906024933
main criterion 3.0269493436207995e-05
------------iteration 1900----------
total loss 0.061374835669994354
loss_r_feature 0.34338444471359253
main criterion 3.6226720112608746e-05
------------iteration 2000----------
total loss 0.06098124384880066
loss_r_feature 0.33897483348846436
main criterion 3.914693297701888e-05
------------iteration 2100----------
total loss 0.5135411024093628
loss_r_feature 1.1149722337722778
main criterion 0.15627950429916382
------------iteration 2200----------
total loss 0.4134898781776428
loss_r_feature 1.4967045783996582
main criterion 0.0039379047229886055
------------iteration 2300----------
total loss 0.29786235094070435
loss_r_feature 1.088860273361206
main criterion 0.000142716831760481
------------iteration 2400----------
total loss 0.2645556330680847
loss_r_feature 1.4875950813293457
main criterion 0.0005411195452325046
------------iteration 2500----------
total loss 0.18505384027957916
loss_r_feature 1.3050661087036133
main criterion 0.0002380973455728963
------------iteration 2600----------
total loss 0.17014874517917633
loss_r_feature 1.1258503198623657
main criterion 6.437402043957263e-05
------------iteration 2700----------
total loss 0.1282549798488617
loss_r_feature 0.8884655833244324
main criterion 3.213352101738565e-05
------------iteration 2800----------
total loss 0.10992997139692307
loss_r_feature 0.710279107093811
main criterion 3.804079460678622e-05
------------iteration 2900----------
total loss 0.09275714308023453
loss_r_feature 0.501573920249939
main criterion 8.533733489457518e-05
------------iteration 3000----------
total loss 0.09032740443944931
loss_r_feature 0.4850177466869354
main criterion 8.790480205789208e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_8', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=8, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 8 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.6065075397491455
loss_r_feature 11.761394500732422
main criterion 0.6211045384407043
------------iteration 200----------
total loss 0.8661222457885742
loss_r_feature 9.825296401977539
main criterion 0.0019835522398352623
------------iteration 300----------
total loss 0.6269955039024353
loss_r_feature 5.95189094543457
main criterion 0.048556916415691376
------------iteration 400----------
total loss 0.708150327205658
loss_r_feature 6.12293815612793
main criterion 0.12658631801605225
------------iteration 500----------
total loss 0.445797860622406
loss_r_feature 4.451761722564697
main criterion 0.0009528943919576705
------------iteration 600----------
total loss 0.37930047512054443
loss_r_feature 3.9205777645111084
main criterion 0.0002518658002372831
------------iteration 700----------
total loss 0.3971310257911682
loss_r_feature 4.540127754211426
main criterion 0.0002817668719217181
------------iteration 800----------
total loss 0.3641018867492676
loss_r_feature 2.9697749614715576
main criterion 0.05356070399284363
------------iteration 900----------
total loss 0.2506215572357178
loss_r_feature 2.046816825866699
main criterion 0.00041160520049743354
------------iteration 1000----------
total loss 0.27193355560302734
loss_r_feature 2.691626787185669
main criterion 0.0038363533094525337
------------iteration 1100----------
total loss 0.2648487091064453
loss_r_feature 2.8295040130615234
main criterion 0.00015972022083587945
------------iteration 1200----------
total loss 0.24155494570732117
loss_r_feature 2.678691864013672
main criterion 4.309319774620235e-05
------------iteration 1300----------
total loss 0.1929144263267517
loss_r_feature 1.8642990589141846
main criterion 6.020085129421204e-05
------------iteration 1400----------
total loss 0.16421668231487274
loss_r_feature 1.4946341514587402
main criterion 5.8008481573779136e-05
------------iteration 1500----------
total loss 0.18251574039459229
loss_r_feature 2.030952215194702
main criterion 7.941306103020906e-05
------------iteration 1600----------
total loss 0.13142167031764984
loss_r_feature 1.152077555656433
main criterion 4.427532621775754e-05
------------iteration 1700----------
total loss 0.09434554725885391
loss_r_feature 0.5155616402626038
main criterion 2.379010220465716e-05
------------iteration 1800----------
total loss 0.09163226932287216
loss_r_feature 0.5275301933288574
main criterion 2.8381822630763054e-05
------------iteration 1900----------
total loss 0.08554957807064056
loss_r_feature 0.436191588640213
main criterion 3.8900132494745776e-05
------------iteration 2000----------
total loss 0.08457690477371216
loss_r_feature 0.42313483357429504
main criterion 2.461301482981071e-05
------------iteration 2100----------
total loss 0.5587613582611084
loss_r_feature 3.276169776916504
main criterion 0.06025164574384689
------------iteration 2200----------
total loss 0.5309226512908936
loss_r_feature 3.7684669494628906
main criterion 0.00037050654646009207
------------iteration 2300----------
total loss 0.4352419376373291
loss_r_feature 3.1244630813598633
main criterion 0.00017051708709914237
------------iteration 2400----------
total loss 0.37963777780532837
loss_r_feature 3.736921787261963
main criterion 0.0001934050815179944
------------iteration 2500----------
total loss 0.293000727891922
loss_r_feature 2.217008590698242
main criterion 9.6795083663892e-05
------------iteration 2600----------
total loss 0.26999321579933167
loss_r_feature 2.2132680416107178
main criterion 3.903850301867351e-05
------------iteration 2700----------
total loss 0.21903027594089508
loss_r_feature 1.872358798980713
main criterion 4.324855035520159e-05
------------iteration 2800----------
total loss 0.15129798650741577
loss_r_feature 0.9050962924957275
main criterion 7.05491765984334e-05
------------iteration 2900----------
total loss 0.1351662427186966
loss_r_feature 0.78989177942276
main criterion 9.070991654880345e-05
------------iteration 3000----------
total loss 0.12795773148536682
loss_r_feature 0.696179986000061
main criterion 0.00010318419663235545
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_9', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=9, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 9 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.4356677532196045
loss_r_feature 2.5188426971435547
main criterion 0.9489390254020691
------------iteration 200----------
total loss 0.4530063271522522
loss_r_feature 1.7789041996002197
main criterion 0.015680357813835144
------------iteration 300----------
total loss 0.3565969467163086
loss_r_feature 1.0203994512557983
main criterion 0.002614889293909073
------------iteration 400----------
total loss 0.3097958564758301
loss_r_feature 0.7547661662101746
main criterion 0.014232526533305645
------------iteration 500----------
total loss 0.3076445758342743
loss_r_feature 1.1243271827697754
main criterion 0.0006827748147770762
------------iteration 600----------
total loss 0.24573075771331787
loss_r_feature 0.7382569313049316
main criterion 0.0006214039167389274
------------iteration 700----------
total loss 0.24472197890281677
loss_r_feature 1.1492455005645752
main criterion 0.0005413151229731739
------------iteration 800----------
total loss 0.21380820870399475
loss_r_feature 0.9644553661346436
main criterion 0.0005729221156798303
------------iteration 900----------
total loss 0.17505581676959991
loss_r_feature 0.7742650508880615
main criterion 0.00013229207252152264
------------iteration 1000----------
total loss 0.1790071427822113
loss_r_feature 0.9362017512321472
main criterion 6.500850577140227e-05
------------iteration 1100----------
total loss 0.17867228388786316
loss_r_feature 0.6692858934402466
main criterion 0.028725845739245415
------------iteration 1200----------
total loss 0.13040104508399963
loss_r_feature 0.608797550201416
main criterion 2.3210503059090115e-05
------------iteration 1300----------
total loss 0.12800155580043793
loss_r_feature 0.8779975175857544
main criterion 6.111992843216285e-05
------------iteration 1400----------
total loss 0.1009380891919136
loss_r_feature 0.4701921045780182
main criterion 7.638712850166485e-05
------------iteration 1500----------
total loss 0.0918627455830574
loss_r_feature 0.5297485589981079
main criterion 5.9145302657270804e-05
------------iteration 1600----------
total loss 0.0744994655251503
loss_r_feature 0.44377046823501587
main criterion 2.7348794901627116e-05
------------iteration 1700----------
total loss 0.060825832188129425
loss_r_feature 0.28539949655532837
main criterion 3.169609044562094e-05
------------iteration 1800----------
total loss 0.051383811980485916
loss_r_feature 0.1930224597454071
main criterion 2.5219982489943504e-05
------------iteration 1900----------
total loss 0.04609066620469093
loss_r_feature 0.1323324292898178
main criterion 3.2150946935871616e-05
------------iteration 2000----------
total loss 0.045421965420246124
loss_r_feature 0.12706638872623444
main criterion 2.0562743884511292e-05
------------iteration 2100----------
total loss 0.5105075836181641
loss_r_feature 1.0465922355651855
main criterion 0.002872752957046032
------------iteration 2200----------
total loss 0.4281947612762451
loss_r_feature 0.893965482711792
main criterion 0.00023937480000313371
------------iteration 2300----------
total loss 0.3725035488605499
loss_r_feature 1.2389756441116333
main criterion 0.00038819268229417503
------------iteration 2400----------
total loss 0.2757302522659302
loss_r_feature 1.172629475593567
main criterion 0.00033554626861587167
------------iteration 2500----------
total loss 0.24120378494262695
loss_r_feature 0.9368416666984558
main criterion 0.00018758013902697712
------------iteration 2600----------
total loss 0.18624216318130493
loss_r_feature 0.9182533621788025
main criterion 0.00010371220560045913
------------iteration 2700----------
total loss 0.1480022668838501
loss_r_feature 0.7703784108161926
main criterion 2.4170265533030033e-05
------------iteration 2800----------
total loss 0.09616972506046295
loss_r_feature 0.4361077547073364
main criterion 3.9743230445310473e-05
------------iteration 2900----------
total loss 0.07981153577566147
loss_r_feature 0.4071665406227112
main criterion 8.598206477472559e-05
------------iteration 3000----------
total loss 0.06583470106124878
loss_r_feature 0.20347534120082855
main criterion 9.570729889674112e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_10', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=10, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 10 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7526159882545471
loss_r_feature 0.9203457832336426
main criterion 0.353128045797348
------------iteration 200----------
total loss 0.44183439016342163
loss_r_feature 0.7427340149879456
main criterion 0.04197198897600174
------------iteration 300----------
total loss 0.33123543858528137
loss_r_feature 0.43106016516685486
main criterion 0.029426228255033493
------------iteration 400----------
total loss 0.3834521174430847
loss_r_feature 0.4633444845676422
main criterion 0.08875039964914322
------------iteration 500----------
total loss 0.3056984841823578
loss_r_feature 0.4375612735748291
main criterion 0.00284253410063684
------------iteration 600----------
total loss 0.23754216730594635
loss_r_feature 0.3982817530632019
main criterion 0.0006368152098730206
------------iteration 700----------
total loss 0.2299584001302719
loss_r_feature 0.4861298203468323
main criterion 0.00019688476459123194
------------iteration 800----------
total loss 0.24807612597942352
loss_r_feature 0.41467830538749695
main criterion 0.023809360340237617
------------iteration 900----------
total loss 0.18577918410301208
loss_r_feature 0.6423699259757996
main criterion 0.00014091825869400054
------------iteration 1000----------
total loss 0.1773655116558075
loss_r_feature 0.6680148839950562
main criterion 0.00046114937867969275
------------iteration 1100----------
total loss 0.1251954585313797
loss_r_feature 0.6350479125976562
main criterion 6.144040526123717e-05
------------iteration 1200----------
total loss 0.12490185350179672
loss_r_feature 0.5188555717468262
main criterion 2.279335785715375e-05
------------iteration 1300----------
total loss 0.10505995899438858
loss_r_feature 0.41874203085899353
main criterion 9.022561425808817e-05
------------iteration 1400----------
total loss 0.08762017637491226
loss_r_feature 0.4191506505012512
main criterion 1.7732938431436196e-05
------------iteration 1500----------
total loss 0.22315792739391327
loss_r_feature 0.5254532694816589
main criterion 0.14398424327373505
------------iteration 1600----------
total loss 0.06625805795192719
loss_r_feature 0.4207289218902588
main criterion 5.096754102851264e-05
------------iteration 1700----------
total loss 0.04431360214948654
loss_r_feature 0.1408790498971939
main criterion 2.2822867322247475e-05
------------iteration 1800----------
total loss 0.0405375100672245
loss_r_feature 0.19074231386184692
main criterion 1.697548577794805e-05
------------iteration 1900----------
total loss 0.03339981287717819
loss_r_feature 0.10938428342342377
main criterion 1.7517580999992788e-05
------------iteration 2000----------
total loss 0.032295115292072296
loss_r_feature 0.09993750602006912
main criterion 1.4605632713937666e-05
------------iteration 2100----------
total loss 0.8438887596130371
loss_r_feature 0.6253584623336792
main criterion 0.34650665521621704
------------iteration 2200----------
total loss 0.542568564414978
loss_r_feature 0.37643545866012573
main criterion 0.08507440239191055
------------iteration 2300----------
total loss 0.3571213483810425
loss_r_feature 0.8581683039665222
main criterion 0.0008254801505245268
------------iteration 2400----------
total loss 0.28720152378082275
loss_r_feature 0.9118630886077881
main criterion 0.0004941520164720714
------------iteration 2500----------
total loss 0.23255100846290588
loss_r_feature 0.975387692451477
main criterion 0.003222033381462097
------------iteration 2600----------
total loss 0.18256130814552307
loss_r_feature 0.7845488786697388
main criterion 8.037906809477136e-05
------------iteration 2700----------
total loss 0.12555140256881714
loss_r_feature 0.571662425994873
main criterion 2.9576427550637163e-05
------------iteration 2800----------
total loss 0.08677969127893448
loss_r_feature 0.4094221591949463
main criterion 3.096370346611366e-05
------------iteration 2900----------
total loss 0.05643117427825928
loss_r_feature 0.25703033804893494
main criterion 3.8823352952022105e-05
------------iteration 3000----------
total loss 0.0416339710354805
loss_r_feature 0.07261781394481659
main criterion 4.409418397699483e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_11', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=11, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 11 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.724360466003418
loss_r_feature 17.040996551513672
main criterion 0.4688359797000885
------------iteration 200----------
total loss 1.295718789100647
loss_r_feature 15.068506240844727
main criterion 0.1674073040485382
------------iteration 300----------
total loss 0.7171596884727478
loss_r_feature 8.970888137817383
main criterion 0.0008949963958002627
------------iteration 400----------
total loss 0.5804476737976074
loss_r_feature 6.96183967590332
main criterion 0.01232671458274126
------------iteration 500----------
total loss 0.534609854221344
loss_r_feature 6.241064548492432
main criterion 0.023459402844309807
------------iteration 600----------
total loss 0.5813794732093811
loss_r_feature 7.326147556304932
main criterion 0.0005078791291452944
------------iteration 700----------
total loss 0.5222160816192627
loss_r_feature 6.901391983032227
main criterion 0.0004949273425154388
------------iteration 800----------
total loss 0.43802544474601746
loss_r_feature 5.100113868713379
main criterion 0.01079021766781807
------------iteration 900----------
total loss 0.375205934047699
loss_r_feature 4.6485514640808105
main criterion 9.115975262830034e-05
------------iteration 1000----------
total loss 0.41317498683929443
loss_r_feature 5.5744500160217285
main criterion 7.913414447102696e-05
------------iteration 1100----------
total loss 0.35580506920814514
loss_r_feature 4.492926597595215
main criterion 0.00019937055185437202
------------iteration 1200----------
total loss 0.31504321098327637
loss_r_feature 3.821136474609375
main criterion 5.3518047934630886e-05
------------iteration 1300----------
total loss 0.2812316417694092
loss_r_feature 3.407320499420166
main criterion 6.40258367639035e-05
------------iteration 1400----------
total loss 0.21626418828964233
loss_r_feature 2.2946109771728516
main criterion 5.733925718232058e-05
------------iteration 1500----------
total loss 0.22048808634281158
loss_r_feature 2.5421066284179688
main criterion 0.00011963464930886403
------------iteration 1600----------
total loss 0.21993204951286316
loss_r_feature 2.6716718673706055
main criterion 0.00011229426309000701
------------iteration 1700----------
total loss 0.15940387547016144
loss_r_feature 1.5426026582717896
main criterion 8.38028863654472e-05
------------iteration 1800----------
total loss 0.14823296666145325
loss_r_feature 1.3856093883514404
main criterion 3.547425149008632e-05
------------iteration 1900----------
total loss 0.1286526620388031
loss_r_feature 1.0275737047195435
main criterion 5.953772779321298e-05
------------iteration 2000----------
total loss 0.1289466768503189
loss_r_feature 1.041367769241333
main criterion 4.185366560705006e-05
------------iteration 2100----------
total loss 0.7023364305496216
loss_r_feature 5.936988830566406
main criterion 0.0013787855859845877
------------iteration 2200----------
total loss 0.6109576225280762
loss_r_feature 5.97243070602417
main criterion 7.599991658935323e-05
------------iteration 2300----------
total loss 0.6196821331977844
loss_r_feature 5.447013854980469
main criterion 0.002975406590849161
------------iteration 2400----------
total loss 0.5102574229240417
loss_r_feature 5.5963239669799805
main criterion 0.00026778210303746164
------------iteration 2500----------
total loss 0.47386741638183594
loss_r_feature 5.091922283172607
main criterion 0.00011174950486747548
------------iteration 2600----------
total loss 0.4238843619823456
loss_r_feature 4.366687297821045
main criterion 0.00015614714357070625
------------iteration 2700----------
total loss 0.311770498752594
loss_r_feature 2.9049184322357178
main criterion 6.669868162134662e-05
------------iteration 2800----------
total loss 0.2396923154592514
loss_r_feature 1.963924765586853
main criterion 9.42880506045185e-05
------------iteration 2900----------
total loss 0.20775987207889557
loss_r_feature 1.615521788597107
main criterion 9.270907321479172e-05
------------iteration 3000----------
total loss 0.1825355440378189
loss_r_feature 1.1818821430206299
main criterion 0.00012334676284808666
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_12', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=12, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 12 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8575628995895386
loss_r_feature 7.492121696472168
main criterion 0.13405868411064148
------------iteration 200----------
total loss 0.7599736452102661
loss_r_feature 6.955204486846924
main criterion 0.04290459305047989
------------iteration 300----------
total loss 0.5153468251228333
loss_r_feature 4.662124156951904
main criterion 0.006801119074225426
------------iteration 400----------
total loss 0.4465968906879425
loss_r_feature 3.560495376586914
main criterion 0.001596443704329431
------------iteration 500----------
total loss 0.5098965764045715
loss_r_feature 5.008526802062988
main criterion 0.008397449739277363
------------iteration 600----------
total loss 0.5074779391288757
loss_r_feature 5.24143648147583
main criterion 0.0005695490981452167
------------iteration 700----------
total loss 0.4336141347885132
loss_r_feature 4.099281311035156
main criterion 0.0004035351157654077
------------iteration 800----------
total loss 0.3761060833930969
loss_r_feature 3.2919249534606934
main criterion 0.0014252037508413196
------------iteration 900----------
total loss 0.3586699962615967
loss_r_feature 3.0382192134857178
main criterion 0.0014399383217096329
------------iteration 1000----------
total loss 0.34538745880126953
loss_r_feature 3.0827925205230713
main criterion 7.118942448869348e-05
------------iteration 1100----------
total loss 0.2887974977493286
loss_r_feature 2.2761292457580566
main criterion 0.00014186848420649767
------------iteration 1200----------
total loss 0.32875216007232666
loss_r_feature 3.3267369270324707
main criterion 9.238076745532453e-05
------------iteration 1300----------
total loss 0.28847023844718933
loss_r_feature 2.7309274673461914
main criterion 9.804157161852345e-05
------------iteration 1400----------
total loss 0.23840036988258362
loss_r_feature 1.9565929174423218
main criterion 9.584318468114361e-05
------------iteration 1500----------
total loss 0.2081642895936966
loss_r_feature 1.587925672531128
main criterion 0.00012772958143614233
------------iteration 1600----------
total loss 0.17964813113212585
loss_r_feature 1.240105152130127
main criterion 0.00010339443542761728
------------iteration 1700----------
total loss 0.17177456617355347
loss_r_feature 1.2721295356750488
main criterion 5.3584459237754345e-05
------------iteration 1800----------
total loss 0.14598402380943298
loss_r_feature 0.8796972036361694
main criterion 5.3786654461873695e-05
------------iteration 1900----------
total loss 0.1238740012049675
loss_r_feature 0.5123621821403503
main criterion 5.315169255482033e-05
------------iteration 2000----------
total loss 0.12579382956027985
loss_r_feature 0.5657663941383362
main criterion 5.3836040024179965e-05
------------iteration 2100----------
total loss 0.6565201878547668
loss_r_feature 5.122293472290039
main criterion 0.00040977305616252124
------------iteration 2200----------
total loss 0.6384488344192505
loss_r_feature 4.931649208068848
main criterion 9.552518895361573e-05
------------iteration 2300----------
total loss 0.6138413548469543
loss_r_feature 4.78743314743042
main criterion 0.0002459807728882879
------------iteration 2400----------
total loss 0.5011240839958191
loss_r_feature 3.3334245681762695
main criterion 0.00019447048543952405
------------iteration 2500----------
total loss 0.4947553277015686
loss_r_feature 3.718768358230591
main criterion 0.00010672806820366532
------------iteration 2600----------
total loss 0.37043601274490356
loss_r_feature 2.106480836868286
main criterion 0.00019495854212436825
------------iteration 2700----------
total loss 0.30128589272499084
loss_r_feature 1.4034044742584229
main criterion 7.380467286566272e-05
------------iteration 2800----------
total loss 0.2746327817440033
loss_r_feature 1.604257345199585
main criterion 0.00013295344251673669
------------iteration 2900----------
total loss 0.2150373011827469
loss_r_feature 0.9621596336364746
main criterion 0.00010809886589413509
------------iteration 3000----------
total loss 0.18295437097549438
loss_r_feature 0.46162617206573486
main criterion 0.00012457923730835319
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_13', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=13, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 13 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7429031729698181
loss_r_feature 4.00536584854126
main criterion 0.18183691799640656
------------iteration 200----------
total loss 0.5595479011535645
loss_r_feature 3.5258843898773193
main criterion 0.010880498215556145
------------iteration 300----------
total loss 0.4958707094192505
loss_r_feature 2.6548397541046143
main criterion 0.06444309651851654
------------iteration 400----------
total loss 0.34012866020202637
loss_r_feature 1.773050308227539
main criterion 0.0008226161007769406
------------iteration 500----------
total loss 0.405862033367157
loss_r_feature 2.626326084136963
main criterion 0.0007323562749661505
------------iteration 600----------
total loss 0.3697977662086487
loss_r_feature 3.119246482849121
main criterion 0.0005036072107031941
------------iteration 700----------
total loss 0.29913127422332764
loss_r_feature 1.7548608779907227
main criterion 0.001516236923635006
------------iteration 800----------
total loss 0.2759245038032532
loss_r_feature 1.6492587327957153
main criterion 0.0007225830340757966
------------iteration 900----------
total loss 0.24414214491844177
loss_r_feature 1.3362617492675781
main criterion 0.0008784771198406816
------------iteration 1000----------
total loss 0.25978389382362366
loss_r_feature 1.948677897453308
main criterion 8.956240344559774e-05
------------iteration 1100----------
total loss 0.22503447532653809
loss_r_feature 1.4886717796325684
main criterion 0.00012832393986172974
------------iteration 1200----------
total loss 0.24529901146888733
loss_r_feature 2.0869545936584473
main criterion 0.0012103329645469785
------------iteration 1300----------
total loss 0.17434042692184448
loss_r_feature 0.9126957654953003
main criterion 5.0317568820901215e-05
------------iteration 1400----------
total loss 0.18895375728607178
loss_r_feature 1.4323146343231201
main criterion 4.305406764615327e-05
------------iteration 1500----------
total loss 0.1395845115184784
loss_r_feature 0.7212746143341064
main criterion 8.047273877309635e-05
------------iteration 1600----------
total loss 0.14181989431381226
loss_r_feature 0.9630424976348877
main criterion 5.443942063720897e-05
------------iteration 1700----------
total loss 0.10295705497264862
loss_r_feature 0.3774622082710266
main criterion 5.932322528678924e-05
------------iteration 1800----------
total loss 0.09372549504041672
loss_r_feature 0.33057212829589844
main criterion 5.1708531827898696e-05
------------iteration 1900----------
total loss 0.08869440108537674
loss_r_feature 0.30038660764694214
main criterion 4.387429362395778e-05
------------iteration 2000----------
total loss 0.08302892744541168
loss_r_feature 0.20001646876335144
main criterion 5.035140202380717e-05
------------iteration 2100----------
total loss 0.573842465877533
loss_r_feature 2.747149705886841
main criterion 0.003755047218874097
------------iteration 2200----------
total loss 0.439035028219223
loss_r_feature 2.2263059616088867
main criterion 8.047496521612629e-05
------------iteration 2300----------
total loss 0.4145205318927765
loss_r_feature 1.5837345123291016
main criterion 9.970519749913365e-05
------------iteration 2400----------
total loss 0.39110735058784485
loss_r_feature 1.595893144607544
main criterion 0.000510019192006439
------------iteration 2500----------
total loss 0.36879387497901917
loss_r_feature 2.3855581283569336
main criterion 0.0001394304563291371
------------iteration 2600----------
total loss 0.30461424589157104
loss_r_feature 1.912952184677124
main criterion 6.126488733571023e-05
------------iteration 2700----------
total loss 0.219141885638237
loss_r_feature 0.7411218285560608
main criterion 6.006808689562604e-05
------------iteration 2800----------
total loss 0.1908271461725235
loss_r_feature 0.9233404397964478
main criterion 0.00011035596253350377
------------iteration 2900----------
total loss 0.1308407336473465
loss_r_feature 0.31416404247283936
main criterion 7.862586062401533e-05
------------iteration 3000----------
total loss 0.12059758603572845
loss_r_feature 0.25028255581855774
main criterion 0.00011145528696943074
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_14', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=14, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 14 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.449083089828491
loss_r_feature 39.75523376464844
main criterion 0.10444192588329315
------------iteration 200----------
total loss 2.0003154277801514
loss_r_feature 33.604549407958984
main criterion 0.0010294769890606403
------------iteration 300----------
total loss 1.3516169786453247
loss_r_feature 21.5606689453125
main criterion 0.03048979863524437
------------iteration 400----------
total loss 1.4145556688308716
loss_r_feature 20.370380401611328
main criterion 0.1619119942188263
------------iteration 500----------
total loss 0.9336528182029724
loss_r_feature 14.470824241638184
main criterion 0.018319323658943176
------------iteration 600----------
total loss 0.9647303223609924
loss_r_feature 15.252792358398438
main criterion 0.002210700185969472
------------iteration 700----------
total loss 0.674060046672821
loss_r_feature 9.586104393005371
main criterion 0.0335812121629715
------------iteration 800----------
total loss 0.8398406505584717
loss_r_feature 12.51735782623291
main criterion 0.03690795600414276
------------iteration 900----------
total loss 0.5271941423416138
loss_r_feature 7.637123107910156
main criterion 0.0004090133588761091
------------iteration 1000----------
total loss 0.47425639629364014
loss_r_feature 6.894020080566406
main criterion 0.00026002241065725684
------------iteration 1100----------
total loss 0.5503718852996826
loss_r_feature 8.052757263183594
main criterion 0.025539929047226906
------------iteration 1200----------
total loss 0.5453920960426331
loss_r_feature 8.555270195007324
main criterion 0.00019282310677226633
------------iteration 1300----------
total loss 0.3699943721294403
loss_r_feature 5.008254051208496
main criterion 0.0023756485898047686
------------iteration 1400----------
total loss 0.32829105854034424
loss_r_feature 4.305228233337402
main criterion 0.000223456765525043
------------iteration 1500----------
total loss 0.3649774193763733
loss_r_feature 5.100041389465332
main criterion 9.652545122662559e-05
------------iteration 1600----------
total loss 0.27552419900894165
loss_r_feature 3.3928487300872803
main criterion 0.0001199123144033365
------------iteration 1700----------
total loss 0.25970545411109924
loss_r_feature 3.1150615215301514
main criterion 0.0001041239156620577
------------iteration 1800----------
total loss 0.22665123641490936
loss_r_feature 2.4718427658081055
main criterion 7.698430999880657e-05
------------iteration 1900----------
total loss 0.21802020072937012
loss_r_feature 2.313969135284424
main criterion 0.00010337595449527726
------------iteration 2000----------
total loss 0.21318180859088898
loss_r_feature 2.217672348022461
main criterion 7.609571912325919e-05
------------iteration 2100----------
total loss 1.0830644369125366
loss_r_feature 13.967761039733887
main criterion 0.0013615478528663516
------------iteration 2200----------
total loss 0.7304176688194275
loss_r_feature 9.458000183105469
main criterion 0.00043950811959803104
------------iteration 2300----------
total loss 0.6092991232872009
loss_r_feature 7.597262859344482
main criterion 0.0004381352919153869
------------iteration 2400----------
total loss 0.8003292679786682
loss_r_feature 11.174806594848633
main criterion 0.0006614685407839715
------------iteration 2500----------
total loss 0.9036260843276978
loss_r_feature 13.399574279785156
main criterion 0.00035590308834798634
------------iteration 2600----------
total loss 0.5400473475456238
loss_r_feature 6.66367769241333
main criterion 0.00028607313288375735
------------iteration 2700----------
total loss 0.388921856880188
loss_r_feature 3.849583148956299
main criterion 8.0571357102599e-05
------------iteration 2800----------
total loss 0.3393394351005554
loss_r_feature 3.04349946975708
main criterion 0.00017617510457057506
------------iteration 2900----------
total loss 0.28975385427474976
loss_r_feature 2.126298666000366
main criterion 0.00019781116861850023
------------iteration 3000----------
total loss 0.2623496949672699
loss_r_feature 1.5862853527069092
main criterion 0.0002464241406414658
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_15', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=15, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 15 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.296053409576416
loss_r_feature 35.58327102661133
main criterion 0.12054163217544556
------------iteration 200----------
total loss 1.3412216901779175
loss_r_feature 20.122690200805664
main criterion 0.0012256430927664042
------------iteration 300----------
total loss 1.4707585573196411
loss_r_feature 21.564760208129883
main criterion 0.07597031444311142
------------iteration 400----------
total loss 1.0457432270050049
loss_r_feature 14.950151443481445
main criterion 0.024461034685373306
------------iteration 500----------
total loss 0.8688381314277649
loss_r_feature 12.408638000488281
main criterion 0.000668919354211539
------------iteration 600----------
total loss 0.9234710931777954
loss_r_feature 12.773321151733398
main criterion 0.04307198524475098
------------iteration 700----------
total loss 0.6435966491699219
loss_r_feature 8.739527702331543
main criterion 0.00043672541505657136
------------iteration 800----------
total loss 0.5643972158432007
loss_r_feature 7.117780685424805
main criterion 0.02633250132203102
------------iteration 900----------
total loss 0.48758435249328613
loss_r_feature 6.272247314453125
main criterion 0.0003769857285078615
------------iteration 1000----------
total loss 0.4366915225982666
loss_r_feature 5.735281944274902
main criterion 0.0002037750673480332
------------iteration 1100----------
total loss 0.3805580139160156
loss_r_feature 4.8497633934021
main criterion 0.000427273684181273
------------iteration 1200----------
total loss 0.3246287405490875
loss_r_feature 3.904715061187744
main criterion 9.882607264444232e-05
------------iteration 1300----------
total loss 0.29064738750457764
loss_r_feature 3.3889222145080566
main criterion 0.0001308190549025312
------------iteration 1400----------
total loss 0.2651744782924652
loss_r_feature 2.9858078956604004
main criterion 0.00021116359857842326
------------iteration 1500----------
total loss 0.2682194709777832
loss_r_feature 3.199248790740967
main criterion 0.00014288723468780518
------------iteration 1600----------
total loss 0.21025431156158447
loss_r_feature 2.130570888519287
main criterion 0.00020730958203785121
------------iteration 1700----------
total loss 0.21934232115745544
loss_r_feature 2.376248359680176
main criterion 7.684914453420788e-05
------------iteration 1800----------
total loss 0.1747729331254959
loss_r_feature 1.5193020105361938
main criterion 0.00012583198258653283
------------iteration 1900----------
total loss 0.1660039871931076
loss_r_feature 1.3643453121185303
main criterion 8.513555803801864e-05
------------iteration 2000----------
total loss 0.16271203756332397
loss_r_feature 1.3002341985702515
main criterion 0.00012658210471272469
------------iteration 2100----------
total loss 1.4875109195709229
loss_r_feature 18.961761474609375
main criterion 0.0029067094437777996
------------iteration 2200----------
total loss 0.6356419324874878
loss_r_feature 6.591653823852539
main criterion 0.0007926079561002553
------------iteration 2300----------
total loss 0.6119709610939026
loss_r_feature 6.4683146476745605
main criterion 0.0005524391308426857
------------iteration 2400----------
total loss 0.7921016216278076
loss_r_feature 10.648427963256836
main criterion 0.0005223105545155704
------------iteration 2500----------
total loss 0.48501598834991455
loss_r_feature 4.9888739585876465
main criterion 0.00019252143101766706
------------iteration 2600----------
total loss 0.536068856716156
loss_r_feature 6.416355133056641
main criterion 0.0001751791569404304
------------iteration 2700----------
total loss 0.3329590857028961
loss_r_feature 2.8752832412719727
main criterion 9.279263758799061e-05
------------iteration 2800----------
total loss 0.28238818049430847
loss_r_feature 2.211021900177002
main criterion 0.00015665730461478233
------------iteration 2900----------
total loss 0.21779249608516693
loss_r_feature 1.1176849603652954
main criterion 0.00020172407676000148
------------iteration 3000----------
total loss 0.20559823513031006
loss_r_feature 0.9200417399406433
main criterion 0.0002498118265066296
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_16', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=16, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 16 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.3702563047409058
loss_r_feature 19.41698455810547
main criterion 0.030767735093832016
------------iteration 200----------
total loss 1.0107977390289307
loss_r_feature 12.740535736083984
main criterion 0.011103793978691101
------------iteration 300----------
total loss 0.8403249979019165
loss_r_feature 10.045568466186523
main criterion 0.009637926705181599
------------iteration 400----------
total loss 0.8101537823677063
loss_r_feature 9.69786548614502
main criterion 0.020747579634189606
------------iteration 500----------
total loss 0.6213923096656799
loss_r_feature 7.05572509765625
main criterion 0.0010377237340435386
------------iteration 600----------
total loss 0.5439434051513672
loss_r_feature 5.874736309051514
main criterion 0.0012827346799895167
------------iteration 700----------
total loss 0.44326478242874146
loss_r_feature 4.56479024887085
main criterion 0.0006417050026357174
------------iteration 800----------
total loss 0.42412006855010986
loss_r_feature 4.43544864654541
main criterion 0.001415557460859418
------------iteration 900----------
total loss 0.3620806932449341
loss_r_feature 3.5527162551879883
main criterion 0.00021161578479222953
------------iteration 1000----------
total loss 0.3462238609790802
loss_r_feature 3.515021800994873
main criterion 0.0004463323566596955
------------iteration 1100----------
total loss 0.30247342586517334
loss_r_feature 2.917513847351074
main criterion 0.0010753165697678924
------------iteration 1200----------
total loss 0.33084970712661743
loss_r_feature 3.782944679260254
main criterion 0.0002650640963111073
------------iteration 1300----------
total loss 0.25341811776161194
loss_r_feature 2.51206374168396
main criterion 0.00012459667050279677
------------iteration 1400----------
total loss 0.2344886064529419
loss_r_feature 2.3356475830078125
main criterion 9.592344576958567e-05
------------iteration 1500----------
total loss 0.24060609936714172
loss_r_feature 2.6715729236602783
main criterion 0.00039160926826298237
------------iteration 1600----------
total loss 0.19187036156654358
loss_r_feature 1.8794586658477783
main criterion 0.00011474258644739166
------------iteration 1700----------
total loss 0.17309699952602386
loss_r_feature 1.6174609661102295
main criterion 0.00013798492727801204
------------iteration 1800----------
total loss 0.16282159090042114
loss_r_feature 1.4868204593658447
main criterion 8.0133781011682e-05
------------iteration 1900----------
total loss 0.15767599642276764
loss_r_feature 1.4232218265533447
main criterion 0.000130005762912333
------------iteration 2000----------
total loss 0.15500803291797638
loss_r_feature 1.379660964012146
main criterion 8.059299580054358e-05
------------iteration 2100----------
total loss 0.6966112852096558
loss_r_feature 6.451308250427246
main criterion 0.0016041869530454278
------------iteration 2200----------
total loss 0.7021893858909607
loss_r_feature 6.772307395935059
main criterion 0.0004041892825625837
------------iteration 2300----------
total loss 0.6011930704116821
loss_r_feature 5.696554183959961
main criterion 0.0002905892615672201
------------iteration 2400----------
total loss 0.49390241503715515
loss_r_feature 3.919280767440796
main criterion 0.0020053284242749214
------------iteration 2500----------
total loss 0.5956487655639648
loss_r_feature 6.7863945960998535
main criterion 0.0005610105581581593
------------iteration 2600----------
total loss 0.3418467938899994
loss_r_feature 2.1786320209503174
main criterion 0.0002388817083556205
------------iteration 2700----------
total loss 0.35014578700065613
loss_r_feature 3.0058560371398926
main criterion 8.865598647389561e-05
------------iteration 2800----------
total loss 0.262681782245636
loss_r_feature 1.7592633962631226
main criterion 0.0001371896651107818
------------iteration 2900----------
total loss 0.194283589720726
loss_r_feature 0.7180138826370239
main criterion 0.00013625735300593078
------------iteration 3000----------
total loss 0.18403246998786926
loss_r_feature 0.585638165473938
main criterion 0.00023299828171730042
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_17', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=17, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 17 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.119386076927185
loss_r_feature 5.956657409667969
main criterion 0.46963581442832947
------------iteration 200----------
total loss 0.5478817224502563
loss_r_feature 3.812568187713623
main criterion 0.014222145080566406
------------iteration 300----------
total loss 0.505009114742279
loss_r_feature 3.209097385406494
main criterion 0.0033858115784823895
------------iteration 400----------
total loss 0.47725534439086914
loss_r_feature 3.1840271949768066
main criterion 0.016268083825707436
------------iteration 500----------
total loss 0.46687957644462585
loss_r_feature 3.1567513942718506
main criterion 0.0012631712015718222
------------iteration 600----------
total loss 0.3995732069015503
loss_r_feature 2.6323602199554443
main criterion 0.004020235501229763
------------iteration 700----------
total loss 0.3280104994773865
loss_r_feature 1.9182687997817993
main criterion 0.0009576675365678966
------------iteration 800----------
total loss 0.36744531989097595
loss_r_feature 1.8486500978469849
main criterion 0.061622023582458496
------------iteration 900----------
total loss 0.2741592824459076
loss_r_feature 1.6065220832824707
main criterion 0.005811972077935934
------------iteration 1000----------
total loss 0.2495877742767334
loss_r_feature 1.6653099060058594
main criterion 0.00028897245647385716
------------iteration 1100----------
total loss 0.2181728482246399
loss_r_feature 1.3310537338256836
main criterion 0.0001383126509608701
------------iteration 1200----------
total loss 0.19117513298988342
loss_r_feature 1.307342290878296
main criterion 0.00011900869867531583
------------iteration 1300----------
total loss 0.1778116524219513
loss_r_feature 1.2565417289733887
main criterion 8.264455391326919e-05
------------iteration 1400----------
total loss 0.15242154896259308
loss_r_feature 1.0750843286514282
main criterion 5.606621198239736e-05
------------iteration 1500----------
total loss 0.1342211216688156
loss_r_feature 1.012701392173767
main criterion 0.0001518808858236298
------------iteration 1600----------
total loss 0.11395537108182907
loss_r_feature 0.8018749356269836
main criterion 6.273765757214278e-05
------------iteration 1700----------
total loss 0.10330735892057419
loss_r_feature 0.7653913497924805
main criterion 6.05946515861433e-05
------------iteration 1800----------
total loss 0.09488826990127563
loss_r_feature 0.7080304622650146
main criterion 4.914925011689775e-05
------------iteration 1900----------
total loss 0.09125402569770813
loss_r_feature 0.7003148794174194
main criterion 8.106118912110105e-05
------------iteration 2000----------
total loss 0.0891614556312561
loss_r_feature 0.6744765043258667
main criterion 6.799613038310781e-05
------------iteration 2100----------
total loss 0.5430826544761658
loss_r_feature 1.9441297054290771
main criterion 0.008137471973896027
------------iteration 2200----------
total loss 0.4586072266101837
loss_r_feature 1.2700308561325073
main criterion 0.002585745882242918
------------iteration 2300----------
total loss 0.38805434107780457
loss_r_feature 1.2408723831176758
main criterion 0.00013362415484152734
------------iteration 2400----------
total loss 0.3766385316848755
loss_r_feature 1.8247593641281128
main criterion 0.00032969596213661134
------------iteration 2500----------
total loss 0.2988473176956177
loss_r_feature 1.3684897422790527
main criterion 0.00019674355280585587
------------iteration 2600----------
total loss 0.2482967972755432
loss_r_feature 1.1662235260009766
main criterion 0.0001819191238610074
------------iteration 2700----------
total loss 0.21353869140148163
loss_r_feature 1.2213501930236816
main criterion 7.57424277253449e-05
------------iteration 2800----------
total loss 0.14869001507759094
loss_r_feature 0.6315905451774597
main criterion 0.00012939651787746698
------------iteration 2900----------
total loss 0.11846219003200531
loss_r_feature 0.5052753686904907
main criterion 0.00011342159996274859
------------iteration 3000----------
total loss 0.10699064284563065
loss_r_feature 0.4032161235809326
main criterion 0.00018503516912460327
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_18', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=18, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 18 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.2613062858581543
loss_r_feature 26.879356384277344
main criterion 0.5303726196289062
------------iteration 200----------
total loss 1.607354760169983
loss_r_feature 23.99500274658203
main criterion 0.052708059549331665
------------iteration 300----------
total loss 1.3455899953842163
loss_r_feature 20.507049560546875
main criterion 0.003437646199017763
------------iteration 400----------
total loss 1.1064878702163696
loss_r_feature 16.39311408996582
main criterion 0.008499101735651493
------------iteration 500----------
total loss 1.1750941276550293
loss_r_feature 17.519697189331055
main criterion 0.020429786294698715
------------iteration 600----------
total loss 1.1041653156280518
loss_r_feature 14.775267601013184
main criterion 0.12196961790323257
------------iteration 700----------
total loss 0.7607763409614563
loss_r_feature 10.85603141784668
main criterion 0.010318865068256855
------------iteration 800----------
total loss 0.7028846740722656
loss_r_feature 10.049554824829102
main criterion 0.005965165328234434
------------iteration 900----------
total loss 0.5270092487335205
loss_r_feature 7.220702171325684
main criterion 0.0005539105040952563
------------iteration 1000----------
total loss 0.5772461295127869
loss_r_feature 8.457344055175781
main criterion 0.0012811267515644431
------------iteration 1100----------
total loss 0.481828898191452
loss_r_feature 6.618023872375488
main criterion 0.0006206740508787334
------------iteration 1200----------
total loss 0.3417704105377197
loss_r_feature 4.382507801055908
main criterion 0.0004351989773567766
------------iteration 1300----------
total loss 0.31254199147224426
loss_r_feature 3.9636471271514893
main criterion 0.0003325577708892524
------------iteration 1400----------
total loss 0.2359251230955124
loss_r_feature 2.512333393096924
main criterion 0.00011647448263829574
------------iteration 1500----------
total loss 0.23204778134822845
loss_r_feature 2.543978214263916
main criterion 0.000686859420966357
------------iteration 1600----------
total loss 0.21707789599895477
loss_r_feature 2.3362491130828857
main criterion 0.00017799899796955287
------------iteration 1700----------
total loss 0.16879945993423462
loss_r_feature 1.4304887056350708
main criterion 0.00010177723743254319
------------iteration 1800----------
total loss 0.15969422459602356
loss_r_feature 1.2882921695709229
main criterion 7.105812983354554e-05
------------iteration 1900----------
total loss 0.14672553539276123
loss_r_feature 1.0490590333938599
main criterion 0.0001369984238408506
------------iteration 2000----------
total loss 0.14280344545841217
loss_r_feature 0.976495623588562
main criterion 8.84977780515328e-05
------------iteration 2100----------
total loss 0.7968675494194031
loss_r_feature 8.937408447265625
main criterion 0.0012829318875446916
------------iteration 2200----------
total loss 0.7403779625892639
loss_r_feature 8.826712608337402
main criterion 0.0008903344278223813
------------iteration 2300----------
total loss 0.6656534075737
loss_r_feature 7.7534050941467285
main criterion 0.000648243585601449
------------iteration 2400----------
total loss 0.6841974854469299
loss_r_feature 8.28555679321289
main criterion 0.0008478534291498363
------------iteration 2500----------
total loss 0.5517640709877014
loss_r_feature 6.336869239807129
main criterion 0.000478377565741539
------------iteration 2600----------
total loss 0.39476004242897034
loss_r_feature 3.5858683586120605
main criterion 0.0003306116268504411
------------iteration 2700----------
total loss 0.39275631308555603
loss_r_feature 3.8683559894561768
main criterion 0.0001509181020082906
------------iteration 2800----------
total loss 0.2607555687427521
loss_r_feature 1.5416170358657837
main criterion 0.00018380940309725702
------------iteration 2900----------
total loss 0.24285945296287537
loss_r_feature 1.399147391319275
main criterion 0.00019848084775730968
------------iteration 3000----------
total loss 0.22215481102466583
loss_r_feature 1.0337214469909668
main criterion 0.0002487622550688684
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_19', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=19, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 19 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.4777683019638062
loss_r_feature 17.755828857421875
main criterion 0.1734718531370163
------------iteration 200----------
total loss 1.194068431854248
loss_r_feature 15.981568336486816
main criterion 0.0019669923931360245
------------iteration 300----------
total loss 1.0756185054779053
loss_r_feature 12.422341346740723
main criterion 0.11694735288619995
------------iteration 400----------
total loss 0.8073831796646118
loss_r_feature 9.928823471069336
main criterion 0.013986430130898952
------------iteration 500----------
total loss 0.890881359577179
loss_r_feature 9.146917343139648
main criterion 0.15904687345027924
------------iteration 600----------
total loss 0.6212337613105774
loss_r_feature 7.414511680603027
main criterion 0.0010639745742082596
------------iteration 700----------
total loss 0.5898405313491821
loss_r_feature 6.931606292724609
main criterion 0.00023600955319125205
------------iteration 800----------
total loss 0.49557042121887207
loss_r_feature 5.735560417175293
main criterion 0.0028648872394114733
------------iteration 900----------
total loss 0.40579262375831604
loss_r_feature 4.347436428070068
main criterion 0.0004090063739567995
------------iteration 1000----------
total loss 0.3674853444099426
loss_r_feature 3.5460801124572754
main criterion 0.01870456151664257
------------iteration 1100----------
total loss 0.29925698041915894
loss_r_feature 3.2015933990478516
main criterion 0.0004150382592342794
------------iteration 1200----------
total loss 0.2712273895740509
loss_r_feature 2.8709592819213867
main criterion 0.0002989433123730123
------------iteration 1300----------
total loss 0.2416093647480011
loss_r_feature 2.4107625484466553
main criterion 0.00028088572435081005
------------iteration 1400----------
total loss 0.22452732920646667
loss_r_feature 2.1738123893737793
main criterion 7.948168786242604e-05
------------iteration 1500----------
total loss 0.1813526153564453
loss_r_feature 1.4265146255493164
main criterion 0.005054018460214138
------------iteration 1600----------
total loss 0.1785951852798462
loss_r_feature 1.6172314882278442
main criterion 0.00027132598916068673
------------iteration 1700----------
total loss 0.1437084823846817
loss_r_feature 1.0430210828781128
main criterion 0.00010551515879342332
------------iteration 1800----------
total loss 0.12780721485614777
loss_r_feature 0.8205422759056091
main criterion 8.318889740621671e-05
------------iteration 1900----------
total loss 0.12100698798894882
loss_r_feature 0.7426500916481018
main criterion 7.810188253642991e-05
------------iteration 2000----------
total loss 0.11712942272424698
loss_r_feature 0.6770355701446533
main criterion 8.506060112267733e-05
------------iteration 2100----------
total loss 0.6899566650390625
loss_r_feature 5.979271411895752
main criterion 0.004278487991541624
------------iteration 2200----------
total loss 0.6401119828224182
loss_r_feature 4.88201379776001
main criterion 0.0007964232354424894
------------iteration 2300----------
total loss 0.545928955078125
loss_r_feature 4.534447193145752
main criterion 0.00044483193778432906
------------iteration 2400----------
total loss 0.4548201858997345
loss_r_feature 3.3459818363189697
main criterion 0.0009900310542434454
------------iteration 2500----------
total loss 0.39967912435531616
loss_r_feature 2.7983551025390625
main criterion 0.00020949677855242044
------------iteration 2600----------
total loss 0.36241841316223145
loss_r_feature 2.4141488075256348
main criterion 0.0002522705472074449
------------iteration 2700----------
total loss 0.30099692940711975
loss_r_feature 1.8441171646118164
main criterion 0.00010000041947932914
------------iteration 2800----------
total loss 0.23745816946029663
loss_r_feature 1.1227381229400635
main criterion 0.00016068057448137552
------------iteration 2900----------
total loss 0.20851962268352509
loss_r_feature 0.929985523223877
main criterion 0.00019769991922657937
------------iteration 3000----------
total loss 0.18464618921279907
loss_r_feature 0.5527834892272949
main criterion 0.00022073123545851558
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_20', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=20, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 20 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.846013069152832
loss_r_feature 5.535894393920898
main criterion 0.16908863186836243
------------iteration 200----------
total loss 0.5983245372772217
loss_r_feature 4.192372798919678
main criterion 0.02653418853878975
------------iteration 300----------
total loss 0.44753897190093994
loss_r_feature 2.7681312561035156
main criterion 0.0020708288066089153
------------iteration 400----------
total loss 0.46724313497543335
loss_r_feature 2.303378105163574
main criterion 0.07230734825134277
------------iteration 500----------
total loss 0.4126031696796417
loss_r_feature 2.3830137252807617
main criterion 0.0011959956027567387
------------iteration 600----------
total loss 0.35816383361816406
loss_r_feature 1.8750791549682617
main criterion 0.0028095822781324387
------------iteration 700----------
total loss 0.3155960440635681
loss_r_feature 1.5921518802642822
main criterion 0.0004277313710190356
------------iteration 800----------
total loss 0.24351981282234192
loss_r_feature 1.035330057144165
main criterion 0.0037094545550644398
------------iteration 900----------
total loss 0.2441742718219757
loss_r_feature 1.0402050018310547
main criterion 0.0007581053650937974
------------iteration 1000----------
total loss 0.2249596118927002
loss_r_feature 1.3189139366149902
main criterion 0.00011033512419089675
------------iteration 1100----------
total loss 0.19132481515407562
loss_r_feature 0.7810494899749756
main criterion 0.00013580983795691282
------------iteration 1200----------
total loss 0.19691036641597748
loss_r_feature 1.2392537593841553
main criterion 0.00012552707630675286
------------iteration 1300----------
total loss 0.16774822771549225
loss_r_feature 0.8234569430351257
main criterion 5.8026707847602665e-05
------------iteration 1400----------
total loss 0.13664011657238007
loss_r_feature 0.45182541012763977
main criterion 9.334228525403887e-05
------------iteration 1500----------
total loss 0.1652407944202423
loss_r_feature 1.2339192628860474
main criterion 0.0001113902180804871
------------iteration 1600----------
total loss 0.10983660817146301
loss_r_feature 0.35670608282089233
main criterion 6.75301271257922e-05
------------iteration 1700----------
total loss 0.10031946748495102
loss_r_feature 0.3259105086326599
main criterion 4.508921119850129e-05
------------iteration 1800----------
total loss 0.08856186270713806
loss_r_feature 0.21610738337039948
main criterion 3.850767097901553e-05
------------iteration 1900----------
total loss 0.08352002501487732
loss_r_feature 0.18267415463924408
main criterion 4.55087392765563e-05
------------iteration 2000----------
total loss 0.08301468193531036
loss_r_feature 0.18673354387283325
main criterion 4.490080027608201e-05
------------iteration 2100----------
total loss 0.41052061319351196
loss_r_feature 2.507024049758911
main criterion 0.00025998230557888746
------------iteration 2200----------
total loss 0.3867416977882385
loss_r_feature 1.6405842304229736
main criterion 0.00010516319161979482
------------iteration 2300----------
total loss 0.40858033299446106
loss_r_feature 1.8390352725982666
main criterion 0.0011350223794579506
------------iteration 2400----------
total loss 0.34538206458091736
loss_r_feature 1.8791471719741821
main criterion 0.00021311326418071985
------------iteration 2500----------
total loss 0.31002458930015564
loss_r_feature 1.4547818899154663
main criterion 0.000261352164670825
------------iteration 2600----------
total loss 0.2380450963973999
loss_r_feature 0.7913732528686523
main criterion 0.00014805563841946423
------------iteration 2700----------
total loss 0.23018872737884521
loss_r_feature 1.2053382396697998
main criterion 6.767454033251852e-05
------------iteration 2800----------
total loss 0.17319945991039276
loss_r_feature 0.6613644957542419
main criterion 0.00013577785284724087
------------iteration 2900----------
total loss 0.13055698573589325
loss_r_feature 0.2868584096431732
main criterion 0.0001253109221579507
------------iteration 3000----------
total loss 0.12438392639160156
loss_r_feature 0.2896767556667328
main criterion 0.00017514161299914122
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_21', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=21, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 21 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.997738778591156
loss_r_feature 8.11929702758789
main criterion 0.20765726268291473
------------iteration 200----------
total loss 0.7428969740867615
loss_r_feature 6.366053581237793
main criterion 0.07690922170877457
------------iteration 300----------
total loss 0.5958134531974792
loss_r_feature 4.9935503005981445
main criterion 0.04064544290304184
------------iteration 400----------
total loss 0.5272315740585327
loss_r_feature 4.50732421875
main criterion 0.014875693246722221
------------iteration 500----------
total loss 0.49270060658454895
loss_r_feature 4.4342265129089355
main criterion 0.0026024985127151012
------------iteration 600----------
total loss 0.4812532961368561
loss_r_feature 4.603634357452393
main criterion 0.0008783267694525421
------------iteration 700----------
total loss 0.4084981381893158
loss_r_feature 3.45776104927063
main criterion 0.0008681697654537857
------------iteration 800----------
total loss 0.39570313692092896
loss_r_feature 3.33646559715271
main criterion 0.001079154433682561
------------iteration 900----------
total loss 0.3794436752796173
loss_r_feature 3.564833402633667
main criterion 0.0028621782548725605
------------iteration 1000----------
total loss 0.35237792134284973
loss_r_feature 3.2103097438812256
main criterion 0.0001813683338696137
------------iteration 1100----------
total loss 0.31846192479133606
loss_r_feature 2.7913191318511963
main criterion 0.002617372665554285
------------iteration 1200----------
total loss 0.3635369837284088
loss_r_feature 4.024492263793945
main criterion 0.003215962555259466
------------iteration 1300----------
total loss 0.3005322813987732
loss_r_feature 3.150031328201294
main criterion 0.00019885892106685787
------------iteration 1400----------
total loss 0.22879289090633392
loss_r_feature 1.9574356079101562
main criterion 9.392412903252989e-05
------------iteration 1500----------
total loss 0.2091200351715088
loss_r_feature 1.8959683179855347
main criterion 0.00018428024486638606
------------iteration 1600----------
total loss 0.2124461829662323
loss_r_feature 2.1292061805725098
main criterion 0.00012060687004122883
------------iteration 1700----------
total loss 0.13295695185661316
loss_r_feature 0.7382935285568237
main criterion 7.338617433561012e-05
------------iteration 1800----------
total loss 0.12078133225440979
loss_r_feature 0.6348688006401062
main criterion 5.453101039165631e-05
------------iteration 1900----------
total loss 0.11189316213130951
loss_r_feature 0.5350421071052551
main criterion 8.495127985952422e-05
------------iteration 2000----------
total loss 0.10965096205472946
loss_r_feature 0.5057430863380432
main criterion 6.963154737604782e-05
------------iteration 2100----------
total loss 0.5852314233779907
loss_r_feature 3.556270122528076
main criterion 0.009207099676132202
------------iteration 2200----------
total loss 0.5825175642967224
loss_r_feature 3.5294971466064453
main criterion 0.00012231143773533404
------------iteration 2300----------
total loss 0.5447735786437988
loss_r_feature 3.397970199584961
main criterion 0.000832802732475102
------------iteration 2400----------
total loss 0.5404596924781799
loss_r_feature 3.814517021179199
main criterion 0.0002627643116284162
------------iteration 2500----------
total loss 0.4046700596809387
loss_r_feature 2.2966952323913574
main criterion 0.00013440883776638657
------------iteration 2600----------
total loss 0.33530890941619873
loss_r_feature 1.7955598831176758
main criterion 0.00016226113075390458
------------iteration 2700----------
total loss 0.3212595283985138
loss_r_feature 2.1163744926452637
main criterion 6.528593075927347e-05
------------iteration 2800----------
total loss 0.24357649683952332
loss_r_feature 1.516503095626831
main criterion 0.00015121678006835282
------------iteration 2900----------
total loss 0.17704850435256958
loss_r_feature 0.7280891537666321
main criterion 0.00014064888819120824
------------iteration 3000----------
total loss 0.16472971439361572
loss_r_feature 0.6370944380760193
main criterion 0.0001375911379000172
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_22', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=22, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 22 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7846786975860596
loss_r_feature 3.2228729724884033
main criterion 0.2536223232746124
------------iteration 200----------
total loss 0.5154067277908325
loss_r_feature 2.5045127868652344
main criterion 0.014316949062049389
------------iteration 300----------
total loss 0.5076899528503418
loss_r_feature 1.52333402633667
main criterion 0.11241503059864044
------------iteration 400----------
total loss 0.3946230709552765
loss_r_feature 1.9353669881820679
main criterion 0.0016350041842088103
------------iteration 500----------
total loss 0.3597542345523834
loss_r_feature 1.398360013961792
main criterion 0.0008151947404257953
------------iteration 600----------
total loss 0.35871410369873047
loss_r_feature 1.7178008556365967
main criterion 0.006791020277887583
------------iteration 700----------
total loss 0.3528052568435669
loss_r_feature 2.034475326538086
main criterion 0.00040906580397859216
------------iteration 800----------
total loss 0.30667948722839355
loss_r_feature 1.3420568704605103
main criterion 0.0005094046355225146
------------iteration 900----------
total loss 0.2501106262207031
loss_r_feature 0.9688800573348999
main criterion 0.00013589509762823582
------------iteration 1000----------
total loss 0.24243175983428955
loss_r_feature 1.0188623666763306
main criterion 7.454031583620235e-05
------------iteration 1100----------
total loss 0.238343745470047
loss_r_feature 1.1905088424682617
main criterion 0.0019860018510371447
------------iteration 1200----------
total loss 0.28065624833106995
loss_r_feature 2.250993490219116
main criterion 7.805772474966943e-05
------------iteration 1300----------
total loss 0.17638638615608215
loss_r_feature 0.6411635279655457
main criterion 5.822796811116859e-05
------------iteration 1400----------
total loss 0.16920515894889832
loss_r_feature 0.7755246758460999
main criterion 8.245436038123444e-05
------------iteration 1500----------
total loss 0.13955241441726685
loss_r_feature 0.5039871335029602
main criterion 5.7568617194192484e-05
------------iteration 1600----------
total loss 0.13536857068538666
loss_r_feature 0.712440550327301
main criterion 8.413226896664128e-05
------------iteration 1700----------
total loss 0.10543505102396011
loss_r_feature 0.34728431701660156
main criterion 4.469576379051432e-05
------------iteration 1800----------
total loss 0.09490127116441727
loss_r_feature 0.30911916494369507
main criterion 5.914574285270646e-05
------------iteration 1900----------
total loss 0.08959414809942245
loss_r_feature 0.29278290271759033
main criterion 7.2146525781136e-05
------------iteration 2000----------
total loss 0.08563705533742905
loss_r_feature 0.23184193670749664
main criterion 3.826114334515296e-05
------------iteration 2100----------
total loss 0.5006487965583801
loss_r_feature 2.4381673336029053
main criterion 0.0003130143159069121
------------iteration 2200----------
total loss 0.4576607942581177
loss_r_feature 1.5079751014709473
main criterion 0.00013521172513719648
------------iteration 2300----------
total loss 0.4467024803161621
loss_r_feature 1.8865394592285156
main criterion 0.0001283916790271178
------------iteration 2400----------
total loss 0.400644451379776
loss_r_feature 1.2756012678146362
main criterion 0.00024541286984458566
------------iteration 2500----------
total loss 0.388028085231781
loss_r_feature 1.9537639617919922
main criterion 0.00017141326679848135
------------iteration 2600----------
total loss 0.32174891233444214
loss_r_feature 1.7041678428649902
main criterion 0.00016668862372171134
------------iteration 2700----------
total loss 0.25176694989204407
loss_r_feature 1.1329381465911865
main criterion 6.481652235379443e-05
------------iteration 2800----------
total loss 0.18911559879779816
loss_r_feature 0.789769172668457
main criterion 0.00011552038631634787
------------iteration 2900----------
total loss 0.14679518342018127
loss_r_feature 0.548579216003418
main criterion 0.00014151231152936816
------------iteration 3000----------
total loss 0.12183966487646103
loss_r_feature 0.20406648516654968
main criterion 0.00010875428415602073
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_23', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=23, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 23 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.5970980525016785
loss_r_feature 1.4002208709716797
main criterion 0.15808212757110596
------------iteration 200----------
total loss 0.4670386016368866
loss_r_feature 0.6713206171989441
main criterion 0.09739629179239273
------------iteration 300----------
total loss 0.35715991258621216
loss_r_feature 0.5370149612426758
main criterion 0.00177563086617738
------------iteration 400----------
total loss 0.4560057520866394
loss_r_feature 0.7888059616088867
main criterion 0.13332408666610718
------------iteration 500----------
total loss 0.29535233974456787
loss_r_feature 0.4881950914859772
main criterion 0.00035378552274778485
------------iteration 600----------
total loss 0.3495488166809082
loss_r_feature 1.0886151790618896
main criterion 0.025762764737010002
------------iteration 700----------
total loss 0.24624541401863098
loss_r_feature 0.6519014239311218
main criterion 0.0009169974364340305
------------iteration 800----------
total loss 0.24528926610946655
loss_r_feature 0.48509055376052856
main criterion 0.0023461696691811085
------------iteration 900----------
total loss 0.21768659353256226
loss_r_feature 0.4537523090839386
main criterion 0.000327932444633916
------------iteration 1000----------
total loss 0.1952110081911087
loss_r_feature 0.6368935704231262
main criterion 9.848105401033536e-05
------------iteration 1100----------
total loss 0.16386915743350983
loss_r_feature 0.32970908284187317
main criterion 0.0008707166998647153
------------iteration 1200----------
total loss 0.19439095258712769
loss_r_feature 1.3082979917526245
main criterion 0.00016448261158075184
------------iteration 1300----------
total loss 0.1315406858921051
loss_r_feature 0.4051347076892853
main criterion 4.0181668737204745e-05
------------iteration 1400----------
total loss 0.11119856685400009
loss_r_feature 0.359838604927063
main criterion 7.303139864234254e-05
------------iteration 1500----------
total loss 0.10369054973125458
loss_r_feature 0.4054948389530182
main criterion 5.1389426516834646e-05
------------iteration 1600----------
total loss 0.10121630877256393
loss_r_feature 0.6553962230682373
main criterion 0.00024944794131442904
------------iteration 1700----------
total loss 0.06788881123065948
loss_r_feature 0.19506987929344177
main criterion 4.2508108890615404e-05
------------iteration 1800----------
total loss 0.05849457159638405
loss_r_feature 0.15739303827285767
main criterion 2.2840822566649877e-05
------------iteration 1900----------
total loss 0.053674738854169846
loss_r_feature 0.14546948671340942
main criterion 2.3137017706176266e-05
------------iteration 2000----------
total loss 0.050745293498039246
loss_r_feature 0.10201845318078995
main criterion 1.70889834407717e-05
------------iteration 2100----------
total loss 0.42438921332359314
loss_r_feature 0.8266345262527466
main criterion 0.0005556588293984532
------------iteration 2200----------
total loss 0.4227921962738037
loss_r_feature 0.5946391224861145
main criterion 0.05959893390536308
------------iteration 2300----------
total loss 0.3436928987503052
loss_r_feature 0.9639197587966919
main criterion 0.0002953662187792361
------------iteration 2400----------
total loss 0.3255600035190582
loss_r_feature 1.0282384157180786
main criterion 0.0010208910098299384
------------iteration 2500----------
total loss 0.2924594581127167
loss_r_feature 1.0029633045196533
main criterion 0.00038475144538097084
------------iteration 2600----------
total loss 0.1968582570552826
loss_r_feature 0.41979190707206726
main criterion 0.00010321484296582639
------------iteration 2700----------
total loss 0.15317822992801666
loss_r_feature 0.355589359998703
main criterion 5.5186188546940684e-05
------------iteration 2800----------
total loss 0.1364138126373291
loss_r_feature 0.6411684155464172
main criterion 7.611083856318146e-05
------------iteration 2900----------
total loss 0.08252256363630295
loss_r_feature 0.14466018974781036
main criterion 5.5608030379517004e-05
------------iteration 3000----------
total loss 0.07324789464473724
loss_r_feature 0.10410325229167938
main criterion 7.101103255990893e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_24', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=24, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 24 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.6098169088363647
loss_r_feature 16.50366973876953
main criterion 0.4182685613632202
------------iteration 200----------
total loss 0.9535642266273499
loss_r_feature 12.369671821594238
main criterion 0.0016999237705022097
------------iteration 300----------
total loss 0.8155528903007507
loss_r_feature 9.958288192749023
main criterion 0.014760908670723438
------------iteration 400----------
total loss 0.8211323022842407
loss_r_feature 8.76333999633789
main criterion 0.0928230956196785
------------iteration 500----------
total loss 0.7198173403739929
loss_r_feature 8.764674186706543
main criterion 0.0075377500616014
------------iteration 600----------
total loss 0.7453110814094543
loss_r_feature 8.870841979980469
main criterion 0.03980289027094841
------------iteration 700----------
total loss 0.6079620122909546
loss_r_feature 7.322929382324219
main criterion 0.0012982867192476988
------------iteration 800----------
total loss 0.5245310664176941
loss_r_feature 6.12058687210083
main criterion 0.0019631546456366777
------------iteration 900----------
total loss 0.46013176441192627
loss_r_feature 5.349545001983643
main criterion 0.000110087581560947
------------iteration 1000----------
total loss 0.46264758706092834
loss_r_feature 5.297224998474121
main criterion 0.015421374700963497
------------iteration 1100----------
total loss 0.38366568088531494
loss_r_feature 4.334451675415039
main criterion 0.0003480113227851689
------------iteration 1200----------
total loss 0.3838156759738922
loss_r_feature 4.636721611022949
main criterion 0.00034684292040765285
------------iteration 1300----------
total loss 0.33395060896873474
loss_r_feature 3.832512378692627
main criterion 0.00029407505644485354
------------iteration 1400----------
total loss 0.3121589124202728
loss_r_feature 3.650531768798828
main criterion 0.00013358809519559145
------------iteration 1500----------
total loss 0.25055986642837524
loss_r_feature 2.6149466037750244
main criterion 0.00022025921498425305
------------iteration 1600----------
total loss 0.19975116848945618
loss_r_feature 1.7921593189239502
main criterion 0.00021339008526410908
------------iteration 1700----------
total loss 0.18697664141654968
loss_r_feature 1.6647415161132812
main criterion 0.00013799930457025766
------------iteration 1800----------
total loss 0.1656220704317093
loss_r_feature 1.3378305435180664
main criterion 0.00015554371930193156
------------iteration 1900----------
total loss 0.15332189202308655
loss_r_feature 1.1477723121643066
main criterion 0.000179068956640549
------------iteration 2000----------
total loss 0.14892132580280304
loss_r_feature 1.0705275535583496
main criterion 0.00015139121387619525
------------iteration 2100----------
total loss 0.7766717672348022
loss_r_feature 7.904848098754883
main criterion 0.0007956781191751361
------------iteration 2200----------
total loss 0.7328894138336182
loss_r_feature 7.521005630493164
main criterion 0.00016217181109823287
------------iteration 2300----------
total loss 0.6767788529396057
loss_r_feature 6.639461994171143
main criterion 0.0004228315665386617
------------iteration 2400----------
total loss 0.6090773344039917
loss_r_feature 5.806302070617676
main criterion 0.000404444697778672
------------iteration 2500----------
total loss 0.5743420720100403
loss_r_feature 5.736069202423096
main criterion 0.00031066624796949327
------------iteration 2600----------
total loss 0.4503081440925598
loss_r_feature 4.00588321685791
main criterion 0.00020198163110762835
------------iteration 2700----------
total loss 0.3712902069091797
loss_r_feature 3.1056485176086426
main criterion 0.00011228617222514004
------------iteration 2800----------
total loss 0.3160945773124695
loss_r_feature 2.663666009902954
main criterion 0.00021430676861200482
------------iteration 2900----------
total loss 0.22949708998203278
loss_r_feature 1.334119439125061
main criterion 0.00020341359777376056
------------iteration 3000----------
total loss 0.20981641113758087
loss_r_feature 1.0444865226745605
main criterion 0.00030528445495292544
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_25', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=25, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 25 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.9905007481575012
loss_r_feature 12.338136672973633
main criterion 0.00403000321239233
------------iteration 200----------
total loss 0.8263933062553406
loss_r_feature 8.107008934020996
main criterion 0.05106710270047188
------------iteration 300----------
total loss 0.6746633648872375
loss_r_feature 6.443746089935303
main criterion 0.009955765679478645
------------iteration 400----------
total loss 0.706943154335022
loss_r_feature 7.137810707092285
main criterion 0.006549743004143238
------------iteration 500----------
total loss 0.6453610062599182
loss_r_feature 5.958521842956543
main criterion 0.00035457834019325674
------------iteration 600----------
total loss 0.743303656578064
loss_r_feature 8.087593078613281
main criterion 0.006849207915365696
------------iteration 700----------
total loss 0.5573008060455322
loss_r_feature 4.853088855743408
main criterion 0.0005600798758678138
------------iteration 800----------
total loss 0.5578517317771912
loss_r_feature 4.777793884277344
main criterion 0.008568353950977325
------------iteration 900----------
total loss 0.4634505808353424
loss_r_feature 3.4775664806365967
main criterion 0.00013226606824900955
------------iteration 1000----------
total loss 0.48684796690940857
loss_r_feature 4.181380748748779
main criterion 0.0004121165839023888
------------iteration 1100----------
total loss 0.45907706022262573
loss_r_feature 3.8996667861938477
main criterion 0.0004559741064440459
------------iteration 1200----------
total loss 0.4377102851867676
loss_r_feature 3.8465259075164795
main criterion 0.0002878590312320739
------------iteration 1300----------
total loss 0.3649957478046417
loss_r_feature 2.6968610286712646
main criterion 0.0013511580182239413
------------iteration 1400----------
total loss 0.3796576261520386
loss_r_feature 3.3457322120666504
main criterion 0.0002215273561887443
------------iteration 1500----------
total loss 0.4144026041030884
loss_r_feature 4.357781887054443
main criterion 0.00025727227330207825
------------iteration 1600----------
total loss 0.30705511569976807
loss_r_feature 2.5204105377197266
main criterion 0.000204789568670094
------------iteration 1700----------
total loss 0.23379169404506683
loss_r_feature 1.295238971710205
main criterion 0.0002770128194242716
------------iteration 1800----------
total loss 0.21362575888633728
loss_r_feature 1.0779963731765747
main criterion 0.00018737779464572668
------------iteration 1900----------
total loss 0.204900860786438
loss_r_feature 1.0054208040237427
main criterion 0.0001429362309863791
------------iteration 2000----------
total loss 0.20051896572113037
loss_r_feature 0.9359551668167114
main criterion 0.00018735580670181662
------------iteration 2100----------
total loss 0.7662585377693176
loss_r_feature 5.7829694747924805
main criterion 0.0005964908050373197
------------iteration 2200----------
total loss 0.7966777682304382
loss_r_feature 5.101912498474121
main criterion 0.0003789431939367205
------------iteration 2300----------
total loss 0.769813060760498
loss_r_feature 5.066180229187012
main criterion 0.0004118919023312628
------------iteration 2400----------
total loss 0.7166740298271179
loss_r_feature 4.318110942840576
main criterion 0.0008411927265115082
------------iteration 2500----------
total loss 0.625670313835144
loss_r_feature 3.44576358795166
main criterion 0.0004314593970775604
------------iteration 2600----------
total loss 0.5483935475349426
loss_r_feature 2.9846792221069336
main criterion 0.0004611323238350451
------------iteration 2700----------
total loss 0.4850827753543854
loss_r_feature 2.8329977989196777
main criterion 0.0001731919328449294
------------iteration 2800----------
total loss 0.39652740955352783
loss_r_feature 2.0523855686187744
main criterion 0.00027611354016698897
------------iteration 2900----------
total loss 0.3265600800514221
loss_r_feature 1.340309977531433
main criterion 0.00024930553627200425
------------iteration 3000----------
total loss 0.28658023476600647
loss_r_feature 0.696510910987854
main criterion 0.0002934955700766295
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_26', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=26, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 26 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1375499963760376
loss_r_feature 9.071243286132812
main criterion 0.27909526228904724
------------iteration 200----------
total loss 0.6204257607460022
loss_r_feature 4.663574695587158
main criterion 0.001582806697115302
------------iteration 300----------
total loss 0.5069622993469238
loss_r_feature 3.3659210205078125
main criterion 0.00290359603241086
------------iteration 400----------
total loss 0.5195954442024231
loss_r_feature 3.6260433197021484
main criterion 0.008847523480653763
------------iteration 500----------
total loss 0.4617089331150055
loss_r_feature 3.215670108795166
main criterion 0.00018641406495589763
------------iteration 600----------
total loss 0.4793015718460083
loss_r_feature 3.377397060394287
main criterion 0.004031268879771233
------------iteration 700----------
total loss 0.4495967924594879
loss_r_feature 3.13429594039917
main criterion 0.001973280683159828
------------iteration 800----------
total loss 0.4352032542228699
loss_r_feature 3.1780009269714355
main criterion 0.0013431659899652004
------------iteration 900----------
total loss 0.3465658724308014
loss_r_feature 1.647586703300476
main criterion 0.00019550796423573047
------------iteration 1000----------
total loss 0.369617223739624
loss_r_feature 2.5024499893188477
main criterion 0.00012162145139882341
------------iteration 1100----------
total loss 0.3293478190898895
loss_r_feature 1.952669382095337
main criterion 0.00024974593543447554
------------iteration 1200----------
total loss 0.3506484627723694
loss_r_feature 2.750033378601074
main criterion 0.0002078036341117695
------------iteration 1300----------
total loss 0.26872190833091736
loss_r_feature 1.433744192123413
main criterion 0.00010825680510606617
------------iteration 1400----------
total loss 0.26860520243644714
loss_r_feature 1.8157349824905396
main criterion 0.00037930882535874844
------------iteration 1500----------
total loss 0.23120428621768951
loss_r_feature 1.4008368253707886
main criterion 0.00029195024399086833
------------iteration 1600----------
total loss 0.19714044034481049
loss_r_feature 1.052609920501709
main criterion 0.0001462981745135039
------------iteration 1700----------
total loss 0.17904840409755707
loss_r_feature 0.9328221678733826
main criterion 0.00010188433952862397
------------iteration 1800----------
total loss 0.1535569131374359
loss_r_feature 0.6000558137893677
main criterion 6.780559488106519e-05
------------iteration 1900----------
total loss 0.14129458367824554
loss_r_feature 0.4421478509902954
main criterion 9.682368545327336e-05
------------iteration 2000----------
total loss 0.13931934535503387
loss_r_feature 0.41883039474487305
main criterion 6.473686516983435e-05
------------iteration 2100----------
total loss 0.6176686882972717
loss_r_feature 3.5725605487823486
main criterion 0.0008116764365695417
------------iteration 2200----------
total loss 0.5830525755882263
loss_r_feature 2.6848111152648926
main criterion 0.00013572578609455377
------------iteration 2300----------
total loss 0.6056397557258606
loss_r_feature 3.3291103839874268
main criterion 0.0002858492953237146
------------iteration 2400----------
total loss 0.5439688563346863
loss_r_feature 2.6465296745300293
main criterion 0.0004618508100975305
------------iteration 2500----------
total loss 0.4699830114841461
loss_r_feature 2.0641117095947266
main criterion 0.00025027457741089165
------------iteration 2600----------
total loss 0.3956010937690735
loss_r_feature 1.6134167909622192
main criterion 0.0003110626130364835
------------iteration 2700----------
total loss 0.33962827920913696
loss_r_feature 1.605616569519043
main criterion 0.00012208735279273242
------------iteration 2800----------
total loss 0.276837557554245
loss_r_feature 1.288405179977417
main criterion 0.00022654265922028571
------------iteration 2900----------
total loss 0.21340245008468628
loss_r_feature 0.6807618737220764
main criterion 0.0001480562350479886
------------iteration 3000----------
total loss 0.19046227633953094
loss_r_feature 0.36881181597709656
main criterion 0.00018086403724737465
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_27', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=27, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 27 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.3166286945343018
loss_r_feature 34.54972839355469
main criterion 0.21779067814350128
------------iteration 200----------
total loss 1.7411128282546997
loss_r_feature 28.430461883544922
main criterion 0.003401279915124178
------------iteration 300----------
total loss 1.3488417863845825
loss_r_feature 21.634597778320312
main criterion 0.0026601976715028286
------------iteration 400----------
total loss 1.339072823524475
loss_r_feature 21.371305465698242
main criterion 0.006388920359313488
------------iteration 500----------
total loss 1.3130714893341064
loss_r_feature 21.021713256835938
main criterion 0.0030385146383196115
------------iteration 600----------
total loss 1.1000196933746338
loss_r_feature 17.2111873626709
main criterion 0.013516079634428024
------------iteration 700----------
total loss 1.0015568733215332
loss_r_feature 15.609694480895996
main criterion 0.0012540192110463977
------------iteration 800----------
total loss 0.819677472114563
loss_r_feature 12.538843154907227
main criterion 0.0042308541014790535
------------iteration 900----------
total loss 0.7732486724853516
loss_r_feature 10.512951850891113
main criterion 0.07648622244596481
------------iteration 1000----------
total loss 0.6398188471794128
loss_r_feature 9.604846954345703
main criterion 0.001665696850977838
------------iteration 1100----------
total loss 0.5048772096633911
loss_r_feature 7.161484718322754
main criterion 0.0010206204606220126
------------iteration 1200----------
total loss 0.46104538440704346
loss_r_feature 6.545792579650879
main criterion 0.004454758018255234
------------iteration 1300----------
total loss 0.35552313923835754
loss_r_feature 4.719420433044434
main criterion 0.0003079109010286629
------------iteration 1400----------
total loss 0.3486911356449127
loss_r_feature 4.624531269073486
main criterion 0.0002824698167387396
------------iteration 1500----------
total loss 0.3269041180610657
loss_r_feature 4.337155342102051
main criterion 0.00032142194686457515
------------iteration 1600----------
total loss 0.28178927302360535
loss_r_feature 3.5170602798461914
main criterion 0.00037127305404283106
------------iteration 1700----------
total loss 0.26322272419929504
loss_r_feature 3.220669746398926
main criterion 0.000268673145910725
------------iteration 1800----------
total loss 0.2197546660900116
loss_r_feature 2.3971545696258545
main criterion 0.00016973793390206993
------------iteration 1900----------
total loss 0.2171434760093689
loss_r_feature 2.3663361072540283
main criterion 0.0002590558142401278
------------iteration 2000----------
total loss 0.20533742010593414
loss_r_feature 2.1384546756744385
main criterion 0.00017693292465992272
------------iteration 2100----------
total loss 1.0147708654403687
loss_r_feature 12.887831687927246
main criterion 0.004240820650011301
------------iteration 2200----------
total loss 0.8941018581390381
loss_r_feature 11.553962707519531
main criterion 0.00038588704774156213
------------iteration 2300----------
total loss 0.7313912510871887
loss_r_feature 9.25428295135498
main criterion 0.00032644366729073226
------------iteration 2400----------
total loss 0.7999208569526672
loss_r_feature 10.565003395080566
main criterion 0.0012025695759803057
------------iteration 2500----------
total loss 0.6478731632232666
loss_r_feature 7.7835774421691895
main criterion 0.0006328505696728826
------------iteration 2600----------
total loss 0.5962587594985962
loss_r_feature 7.3336501121521
main criterion 0.0007225256995297968
------------iteration 2700----------
total loss 0.39522650837898254
loss_r_feature 3.7882161140441895
main criterion 0.00022024137433618307
------------iteration 2800----------
total loss 0.374300092458725
loss_r_feature 3.6780622005462646
main criterion 0.00036645244108513
------------iteration 2900----------
total loss 0.27924302220344543
loss_r_feature 1.990844964981079
main criterion 0.00032226642360910773
------------iteration 3000----------
total loss 0.2630564570426941
loss_r_feature 1.7205554246902466
main criterion 0.0003947559744119644
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_28', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=28, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 28 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.7129781246185303
loss_r_feature 24.63728904724121
main criterion 0.11579403281211853
------------iteration 200----------
total loss 1.546764612197876
loss_r_feature 23.429834365844727
main criterion 0.002825430128723383
------------iteration 300----------
total loss 1.123500108718872
loss_r_feature 16.31536865234375
main criterion 0.006086526904255152
------------iteration 400----------
total loss 1.0523914098739624
loss_r_feature 14.817865371704102
main criterion 0.020833799615502357
------------iteration 500----------
total loss 1.0369715690612793
loss_r_feature 14.838361740112305
main criterion 0.004909679293632507
------------iteration 600----------
total loss 1.1664737462997437
loss_r_feature 15.21420955657959
main criterion 0.11929666250944138
------------iteration 700----------
total loss 0.7615201473236084
loss_r_feature 10.381040573120117
main criterion 0.0018021324649453163
------------iteration 800----------
total loss 0.6962580680847168
loss_r_feature 9.197844505310059
main criterion 0.01731177233159542
------------iteration 900----------
total loss 0.7277469038963318
loss_r_feature 9.939521789550781
main criterion 0.0009383740834891796
------------iteration 1000----------
total loss 0.5175701975822449
loss_r_feature 6.754962921142578
main criterion 0.0009799282997846603
------------iteration 1100----------
total loss 0.5220454931259155
loss_r_feature 6.057008743286133
main criterion 0.03975585103034973
------------iteration 1200----------
total loss 0.39177122712135315
loss_r_feature 4.778144836425781
main criterion 0.0006848004995845258
------------iteration 1300----------
total loss 0.34031668305397034
loss_r_feature 4.009130001068115
main criterion 0.0004702477890532464
------------iteration 1400----------
total loss 0.349357932806015
loss_r_feature 4.350246429443359
main criterion 0.0002488286991138011
------------iteration 1500----------
total loss 0.3080446720123291
loss_r_feature 3.7018675804138184
main criterion 0.0007360043236985803
------------iteration 1600----------
total loss 0.2398805022239685
loss_r_feature 2.493553400039673
main criterion 0.00021566450595855713
------------iteration 1700----------
total loss 0.19759057462215424
loss_r_feature 1.7557895183563232
main criterion 0.00025548075791448355
------------iteration 1800----------
total loss 0.16502654552459717
loss_r_feature 1.1900380849838257
main criterion 0.00014634184481110424
------------iteration 1900----------
total loss 0.15182454884052277
loss_r_feature 0.9735630750656128
main criterion 0.00015866549802012742
------------iteration 2000----------
total loss 0.1470315307378769
loss_r_feature 0.8862513303756714
main criterion 0.00017987577302847058
------------iteration 2100----------
total loss 0.8937061429023743
loss_r_feature 10.501737594604492
main criterion 0.004314471036195755
------------iteration 2200----------
total loss 0.7610607147216797
loss_r_feature 8.548009872436523
main criterion 0.0006025515031069517
------------iteration 2300----------
total loss 0.7465842366218567
loss_r_feature 7.706902503967285
main criterion 0.004644530359655619
------------iteration 2400----------
total loss 0.6228875517845154
loss_r_feature 6.247763156890869
main criterion 0.001477041863836348
------------iteration 2500----------
total loss 0.6009965538978577
loss_r_feature 6.129982948303223
main criterion 0.0004556340863928199
------------iteration 2600----------
total loss 0.4766468107700348
loss_r_feature 4.353720188140869
main criterion 0.0002860181266441941
------------iteration 2700----------
total loss 0.3614022433757782
loss_r_feature 2.6338579654693604
main criterion 0.00017831777222454548
------------iteration 2800----------
total loss 0.2941223680973053
loss_r_feature 1.7833012342453003
main criterion 0.00027469018823467195
------------iteration 2900----------
total loss 0.24337244033813477
loss_r_feature 1.109425663948059
main criterion 0.00021847461175639182
------------iteration 3000----------
total loss 0.2246399223804474
loss_r_feature 0.8234838247299194
main criterion 0.00033067300682887435
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_29', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=29, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 29 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.152186155319214
loss_r_feature 32.641719818115234
main criterion 0.12182678282260895
------------iteration 200----------
total loss 1.8044071197509766
loss_r_feature 28.106382369995117
main criterion 0.010649114847183228
------------iteration 300----------
total loss 1.5104625225067139
loss_r_feature 22.451557159423828
main criterion 0.056299902498722076
------------iteration 400----------
total loss 1.5914124250411987
loss_r_feature 21.824382781982422
main criterion 0.17678989470005035
------------iteration 500----------
total loss 1.364488124847412
loss_r_feature 20.885345458984375
main criterion 0.006712412461638451
------------iteration 600----------
total loss 1.3612887859344482
loss_r_feature 20.78567886352539
main criterion 0.009443845599889755
------------iteration 700----------
total loss 0.9652283191680908
loss_r_feature 13.789687156677246
main criterion 0.0022484008222818375
------------iteration 800----------
total loss 1.00892972946167
loss_r_feature 15.065340995788574
main criterion 0.011575164273381233
------------iteration 900----------
total loss 0.7636561393737793
loss_r_feature 10.565851211547852
main criterion 0.0017395680770277977
------------iteration 1000----------
total loss 0.6783624291419983
loss_r_feature 8.871158599853516
main criterion 0.030037159100174904
------------iteration 1100----------
total loss 0.6471862196922302
loss_r_feature 9.045463562011719
main criterion 0.003267258871346712
------------iteration 1200----------
total loss 0.5333691835403442
loss_r_feature 7.296407222747803
main criterion 0.0009545166976749897
------------iteration 1300----------
total loss 0.43111327290534973
loss_r_feature 5.554618835449219
main criterion 0.0010637367377057672
------------iteration 1400----------
total loss 0.4147007167339325
loss_r_feature 5.431272506713867
main criterion 0.0026311292313039303
------------iteration 1500----------
total loss 0.3483547270298004
loss_r_feature 4.405501365661621
main criterion 0.0002736223686952144
------------iteration 1600----------
total loss 0.30726611614227295
loss_r_feature 3.7711243629455566
main criterion 0.0005803893436677754
------------iteration 1700----------
total loss 0.27225565910339355
loss_r_feature 3.2418203353881836
main criterion 0.00034841662272810936
------------iteration 1800----------
total loss 0.25649699568748474
loss_r_feature 3.0428590774536133
main criterion 0.0004984989063814282
------------iteration 1900----------
total loss 0.25061461329460144
loss_r_feature 2.995544672012329
main criterion 0.0004055829194840044
------------iteration 2000----------
total loss 0.2336302250623703
loss_r_feature 2.670491933822632
main criterion 0.00030864053405821323
------------iteration 2100----------
total loss 0.932947039604187
loss_r_feature 8.762348175048828
main criterion 0.01297363918274641
------------iteration 2200----------
total loss 0.7611178159713745
loss_r_feature 7.20045280456543
main criterion 0.0004406770458444953
------------iteration 2300----------
total loss 0.779888391494751
loss_r_feature 7.509095668792725
main criterion 0.00041223078733310103
------------iteration 2400----------
total loss 0.7904819846153259
loss_r_feature 7.814530849456787
main criterion 0.0007083340897224844
------------iteration 2500----------
total loss 0.6824132204055786
loss_r_feature 6.504943370819092
main criterion 0.0004598009109031409
------------iteration 2600----------
total loss 0.5627055764198303
loss_r_feature 4.828106880187988
main criterion 0.0006371646304614842
------------iteration 2700----------
total loss 0.45589181780815125
loss_r_feature 3.6334900856018066
main criterion 0.0003277525247540325
------------iteration 2800----------
total loss 0.3367559611797333
loss_r_feature 1.9609735012054443
main criterion 0.0003784969449043274
------------iteration 2900----------
total loss 0.27988114953041077
loss_r_feature 1.3130583763122559
main criterion 0.0003051072417292744
------------iteration 3000----------
total loss 0.25364330410957336
loss_r_feature 0.9044248461723328
main criterion 0.00040548507240600884
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_30', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=30, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 30 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0748326778411865
loss_r_feature 9.721955299377441
main criterion 0.18607142567634583
------------iteration 200----------
total loss 0.7570748329162598
loss_r_feature 7.238091468811035
main criterion 0.001890302635729313
------------iteration 300----------
total loss 0.665588915348053
loss_r_feature 5.545592308044434
main criterion 0.04433155432343483
------------iteration 400----------
total loss 0.5519829988479614
loss_r_feature 4.741596698760986
main criterion 0.010767022147774696
------------iteration 500----------
total loss 0.612837016582489
loss_r_feature 5.293138027191162
main criterion 0.0048824516125023365
------------iteration 600----------
total loss 0.543813943862915
loss_r_feature 4.650833606719971
main criterion 0.00858898926526308
------------iteration 700----------
total loss 0.4458335340023041
loss_r_feature 3.4392385482788086
main criterion 0.0010553225874900818
------------iteration 800----------
total loss 0.5545597076416016
loss_r_feature 3.808346748352051
main criterion 0.12068339437246323
------------iteration 900----------
total loss 0.3162132203578949
loss_r_feature 2.142178773880005
main criterion 0.0005631943931803107
------------iteration 1000----------
total loss 0.30892232060432434
loss_r_feature 2.1536519527435303
main criterion 0.0003401385620236397
------------iteration 1100----------
total loss 0.3189476430416107
loss_r_feature 2.420903205871582
main criterion 0.0015776953659951687
------------iteration 1200----------
total loss 0.2766728401184082
loss_r_feature 2.208280324935913
main criterion 0.00012518977746367455
------------iteration 1300----------
total loss 0.23646952211856842
loss_r_feature 1.7626700401306152
main criterion 0.0007876710151322186
------------iteration 1400----------
total loss 0.22906680405139923
loss_r_feature 1.9125198125839233
main criterion 0.0003168562543578446
------------iteration 1500----------
total loss 0.18993712961673737
loss_r_feature 1.493778944015503
main criterion 9.532588592264801e-05
------------iteration 1600----------
total loss 0.17730042338371277
loss_r_feature 1.4782637357711792
main criterion 0.00019417399016674608
------------iteration 1700----------
total loss 0.1516295075416565
loss_r_feature 1.1868064403533936
main criterion 0.00012127839727327228
------------iteration 1800----------
total loss 0.1377926617860794
loss_r_feature 1.0817042589187622
main criterion 0.0001310911902692169
------------iteration 1900----------
total loss 0.12737853825092316
loss_r_feature 0.961367130279541
main criterion 0.00011729068501153961
------------iteration 2000----------
total loss 0.1193394660949707
loss_r_feature 0.8180444836616516
main criterion 0.00011560793063836172
------------iteration 2100----------
total loss 0.6997385025024414
loss_r_feature 3.165696859359741
main criterion 0.0005693259299732745
------------iteration 2200----------
total loss 0.5098395943641663
loss_r_feature 2.388197183609009
main criterion 0.0002149516949430108
------------iteration 2300----------
total loss 0.5303651094436646
loss_r_feature 2.5885801315307617
main criterion 0.00035370796103961766
------------iteration 2400----------
total loss 0.4892018735408783
loss_r_feature 2.4820265769958496
main criterion 0.0011701697949320078
------------iteration 2500----------
total loss 0.42710497975349426
loss_r_feature 1.9893361330032349
main criterion 0.000382806669222191
------------iteration 2600----------
total loss 0.33849036693573
loss_r_feature 1.4017839431762695
main criterion 0.0002618848520796746
------------iteration 2700----------
total loss 0.296983003616333
loss_r_feature 1.5211845636367798
main criterion 0.00016476871678605676
------------iteration 2800----------
total loss 0.24287377297878265
loss_r_feature 1.346610188484192
main criterion 0.00016870451509021223
------------iteration 2900----------
total loss 0.16693338751792908
loss_r_feature 0.43861329555511475
main criterion 0.00022712651116307825
------------iteration 3000----------
total loss 0.15742623805999756
loss_r_feature 0.40467625856399536
main criterion 0.00023293710546568036
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_31', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=31, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 31 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0888924598693848
loss_r_feature 13.203533172607422
main criterion 0.02009303867816925
------------iteration 200----------
total loss 0.8336352705955505
loss_r_feature 8.843372344970703
main criterion 0.001064034877344966
------------iteration 300----------
total loss 0.720956563949585
loss_r_feature 6.749239444732666
main criterion 0.036709461361169815
------------iteration 400----------
total loss 0.673640251159668
loss_r_feature 6.375213623046875
main criterion 0.029407599940896034
------------iteration 500----------
total loss 0.6013175845146179
loss_r_feature 5.972506999969482
main criterion 0.001149082905612886
------------iteration 600----------
total loss 0.6833264827728271
loss_r_feature 7.108475685119629
main criterion 0.010484429076313972
------------iteration 700----------
total loss 0.5798537135124207
loss_r_feature 5.171105861663818
main criterion 0.0364452600479126
------------iteration 800----------
total loss 0.5018706321716309
loss_r_feature 4.629147052764893
main criterion 0.002512912731617689
------------iteration 900----------
total loss 0.4714805483818054
loss_r_feature 4.3992695808410645
main criterion 0.0005389017169363797
------------iteration 1000----------
total loss 0.457332044839859
loss_r_feature 4.411810874938965
main criterion 0.0008381856023333967
------------iteration 1100----------
total loss 0.41640356183052063
loss_r_feature 3.9236531257629395
main criterion 0.000988043611869216
------------iteration 1200----------
total loss 0.4296315610408783
loss_r_feature 4.593693733215332
main criterion 0.0009726696880534291
------------iteration 1300----------
total loss 0.3197540044784546
loss_r_feature 2.7245421409606934
main criterion 0.00010907019895967096
------------iteration 1400----------
total loss 0.3152822256088257
loss_r_feature 2.9233436584472656
main criterion 0.00017442161333747208
------------iteration 1500----------
total loss 0.2722748816013336
loss_r_feature 2.3900504112243652
main criterion 0.0002539958222769201
------------iteration 1600----------
total loss 0.2475942075252533
loss_r_feature 2.152451753616333
main criterion 0.0003828973858617246
------------iteration 1700----------
total loss 0.19266648590564728
loss_r_feature 1.2801986932754517
main criterion 0.0001528811699245125
------------iteration 1800----------
total loss 0.18143750727176666
loss_r_feature 1.2188185453414917
main criterion 0.000132565779495053
------------iteration 1900----------
total loss 0.17469850182533264
loss_r_feature 1.1735261678695679
main criterion 0.0002634988341014832
------------iteration 2000----------
total loss 0.16592445969581604
loss_r_feature 1.0172829627990723
main criterion 0.0001641714188735932
------------iteration 2100----------
total loss 0.7439595460891724
loss_r_feature 5.382668495178223
main criterion 0.0005760329077020288
------------iteration 2200----------
total loss 0.7063189744949341
loss_r_feature 4.901393890380859
main criterion 0.00030910727218724787
------------iteration 2300----------
total loss 0.6555144786834717
loss_r_feature 4.220025539398193
main criterion 0.0003480923769529909
------------iteration 2400----------
total loss 0.6748219132423401
loss_r_feature 5.104874610900879
main criterion 0.002013270277529955
------------iteration 2500----------
total loss 0.6278680562973022
loss_r_feature 5.051827907562256
main criterion 0.0006155932787805796
------------iteration 2600----------
total loss 0.46142661571502686
loss_r_feature 2.7740118503570557
main criterion 0.00033449282636865973
------------iteration 2700----------
total loss 0.3997255861759186
loss_r_feature 2.500426769256592
main criterion 0.00019153737230226398
------------iteration 2800----------
total loss 0.3358783721923828
loss_r_feature 2.1510303020477295
main criterion 0.0002561286964919418
------------iteration 2900----------
total loss 0.26430580019950867
loss_r_feature 1.3451638221740723
main criterion 0.0003639236674644053
------------iteration 3000----------
total loss 0.2297597974538803
loss_r_feature 0.8173859715461731
main criterion 0.000331317656673491
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_32', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=32, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 32 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.9084460139274597
loss_r_feature 8.85383415222168
main criterion 0.05430929362773895
------------iteration 200----------
total loss 0.7925355434417725
loss_r_feature 6.617932319641113
main criterion 0.03915920481085777
------------iteration 300----------
total loss 0.6679006814956665
loss_r_feature 5.541386127471924
main criterion 0.003482434432953596
------------iteration 400----------
total loss 0.656516969203949
loss_r_feature 5.518376350402832
main criterion 0.003593053435906768
------------iteration 500----------
total loss 0.5835047364234924
loss_r_feature 4.458683967590332
main criterion 0.003561649238690734
------------iteration 600----------
total loss 0.6150949001312256
loss_r_feature 5.065508842468262
main criterion 0.011838583275675774
------------iteration 700----------
total loss 0.6090325117111206
loss_r_feature 5.461002349853516
main criterion 0.0025178270880132914
------------iteration 800----------
total loss 0.5505685210227966
loss_r_feature 4.509501934051514
main criterion 0.000975947710685432
------------iteration 900----------
total loss 0.4839896559715271
loss_r_feature 3.474501132965088
main criterion 0.0005269069224596024
------------iteration 1000----------
total loss 0.46754491329193115
loss_r_feature 3.5651981830596924
main criterion 0.00031913520069792867
------------iteration 1100----------
total loss 0.43005892634391785
loss_r_feature 2.9877052307128906
main criterion 0.004629720468074083
------------iteration 1200----------
total loss 0.43118005990982056
loss_r_feature 3.6039912700653076
main criterion 0.0005495698424056172
------------iteration 1300----------
total loss 0.3922393321990967
loss_r_feature 3.219871997833252
main criterion 0.0011198981665074825
------------iteration 1400----------
total loss 0.3377889394760132
loss_r_feature 2.5781071186065674
main criterion 0.00019523788068909198
------------iteration 1500----------
total loss 0.2841695547103882
loss_r_feature 1.9010748863220215
main criterion 0.0002359463833272457
------------iteration 1600----------
total loss 0.2720162570476532
loss_r_feature 2.0194125175476074
main criterion 0.0003248694119974971
------------iteration 1700----------
total loss 0.23002250492572784
loss_r_feature 1.4809478521347046
main criterion 0.00023882316600065678
------------iteration 1800----------
total loss 0.21485064923763275
loss_r_feature 1.3889217376708984
main criterion 0.00016886729281395674
------------iteration 1900----------
total loss 0.19589921832084656
loss_r_feature 1.1281325817108154
main criterion 0.00027301660156808794
------------iteration 2000----------
total loss 0.18874230980873108
loss_r_feature 1.0083612203598022
main criterion 0.00021105221821926534
------------iteration 2100----------
total loss 0.7943339347839355
loss_r_feature 4.445599555969238
main criterion 0.0009796583326533437
------------iteration 2200----------
total loss 0.7920857667922974
loss_r_feature 3.7996137142181396
main criterion 0.00043913739500567317
------------iteration 2300----------
total loss 0.7848813533782959
loss_r_feature 4.028028964996338
main criterion 0.0005902488483116031
------------iteration 2400----------
total loss 0.7552775144577026
loss_r_feature 4.4086503982543945
main criterion 0.0009425627649761736
------------iteration 2500----------
total loss 0.6571121215820312
loss_r_feature 3.642568349838257
main criterion 0.0005251287366263568
------------iteration 2600----------
total loss 0.5048781037330627
loss_r_feature 1.8975036144256592
main criterion 0.0003734944621101022
------------iteration 2700----------
total loss 0.4929826557636261
loss_r_feature 2.8909645080566406
main criterion 0.0002659034507814795
------------iteration 2800----------
total loss 0.36476272344589233
loss_r_feature 1.5042030811309814
main criterion 0.0002826590498443693
------------iteration 2900----------
total loss 0.31854888796806335
loss_r_feature 1.3479770421981812
main criterion 0.0002900224644690752
------------iteration 3000----------
total loss 0.28761160373687744
loss_r_feature 0.9103803634643555
main criterion 0.0003192549629602581
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_33', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=33, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 33 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.5821611285209656
loss_r_feature 3.454315423965454
main criterion 0.007243859115988016
------------iteration 200----------
total loss 0.5606545805931091
loss_r_feature 2.2690980434417725
main criterion 0.0587443970143795
------------iteration 300----------
total loss 0.43419092893600464
loss_r_feature 1.8323569297790527
main criterion 0.001890254206955433
------------iteration 400----------
total loss 0.4421674609184265
loss_r_feature 1.801445722579956
main criterion 0.012649571523070335
------------iteration 500----------
total loss 0.37853604555130005
loss_r_feature 1.4053643941879272
main criterion 0.0025227766018360853
------------iteration 600----------
total loss 0.40085721015930176
loss_r_feature 1.928338885307312
main criterion 0.0020652462262660265
------------iteration 700----------
total loss 0.34588783979415894
loss_r_feature 1.5684431791305542
main criterion 0.00039176084101200104
------------iteration 800----------
total loss 0.36381372809410095
loss_r_feature 1.6837716102600098
main criterion 0.006434283219277859
------------iteration 900----------
total loss 0.29545876383781433
loss_r_feature 1.1488173007965088
main criterion 0.00025465223006904125
------------iteration 1000----------
total loss 0.2895115613937378
loss_r_feature 1.2547576427459717
main criterion 0.0007034506998024881
------------iteration 1100----------
total loss 0.254137247800827
loss_r_feature 1.074520468711853
main criterion 0.0005683206836692989
------------iteration 1200----------
total loss 0.26695379614830017
loss_r_feature 1.7414600849151611
main criterion 0.0004402084741741419
------------iteration 1300----------
total loss 0.23526272177696228
loss_r_feature 1.4133304357528687
main criterion 0.00010898777691181749
------------iteration 1400----------
total loss 0.20392456650733948
loss_r_feature 1.2337758541107178
main criterion 0.00023896011407487094
------------iteration 1500----------
total loss 0.16819539666175842
loss_r_feature 0.8734267950057983
main criterion 0.0002668486849870533
------------iteration 1600----------
total loss 0.14419381320476532
loss_r_feature 0.7395336627960205
main criterion 0.0002076426026178524
------------iteration 1700----------
total loss 0.1219477578997612
loss_r_feature 0.563302755355835
main criterion 0.0001088579956558533
------------iteration 1800----------
total loss 0.10481416434049606
loss_r_feature 0.4212527275085449
main criterion 6.613436562474817e-05
------------iteration 1900----------
total loss 0.09755896031856537
loss_r_feature 0.379571795463562
main criterion 9.519710147287697e-05
------------iteration 2000----------
total loss 0.09226461499929428
loss_r_feature 0.2931075096130371
main criterion 6.670745642622933e-05
------------iteration 2100----------
total loss 0.6151196360588074
loss_r_feature 1.5023000240325928
main criterion 0.0008006489952094853
------------iteration 2200----------
total loss 0.5511425733566284
loss_r_feature 1.6595463752746582
main criterion 0.000609019654802978
------------iteration 2300----------
total loss 0.5035915970802307
loss_r_feature 1.1136054992675781
main criterion 0.0006755290669389069
------------iteration 2400----------
total loss 0.4626002609729767
loss_r_feature 1.2398123741149902
main criterion 0.0005234956042841077
------------iteration 2500----------
total loss 0.44007980823516846
loss_r_feature 1.4684797525405884
main criterion 0.0004510654543992132
------------iteration 2600----------
total loss 0.34462833404541016
loss_r_feature 1.4310091733932495
main criterion 0.00033535505644977093
------------iteration 2700----------
total loss 0.2759250998497009
loss_r_feature 1.1225559711456299
main criterion 0.00025008025113493204
------------iteration 2800----------
total loss 0.19575345516204834
loss_r_feature 0.5496517419815063
main criterion 0.00014318029570858926
------------iteration 2900----------
total loss 0.1675146222114563
loss_r_feature 0.6871564388275146
main criterion 0.00014381266373675317
------------iteration 3000----------
total loss 0.1390199214220047
loss_r_feature 0.2808670103549957
main criterion 0.00014472843031398952
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_34', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=34, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 34 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.9137197732925415
loss_r_feature 9.556788444519043
main criterion 0.0456838496029377
------------iteration 200----------
total loss 0.7465929388999939
loss_r_feature 7.234369277954102
main criterion 0.0019098568009212613
------------iteration 300----------
total loss 0.6200370788574219
loss_r_feature 5.515683174133301
main criterion 0.0014068371383473277
------------iteration 400----------
total loss 0.5993490219116211
loss_r_feature 4.987786293029785
main criterion 0.01561481598764658
------------iteration 500----------
total loss 0.5380250215530396
loss_r_feature 4.346556186676025
main criterion 0.00048733415314927697
------------iteration 600----------
total loss 0.5369367003440857
loss_r_feature 4.667593479156494
main criterion 0.0019342952873557806
------------iteration 700----------
total loss 0.4813128709793091
loss_r_feature 3.893366813659668
main criterion 0.0008321060449816287
------------iteration 800----------
total loss 0.5321316123008728
loss_r_feature 4.1068010330200195
main criterion 0.04992121830582619
------------iteration 900----------
total loss 0.43545177578926086
loss_r_feature 3.4819183349609375
main criterion 0.0030922871083021164
------------iteration 1000----------
total loss 0.40654686093330383
loss_r_feature 3.037562131881714
main criterion 0.00033139315200969577
------------iteration 1100----------
total loss 0.37166860699653625
loss_r_feature 2.7350711822509766
main criterion 0.0003605195670388639
------------iteration 1200----------
total loss 0.38765549659729004
loss_r_feature 3.4920918941497803
main criterion 0.0007222898420877755
------------iteration 1300----------
total loss 0.3140644431114197
loss_r_feature 2.3598365783691406
main criterion 0.00024048176419455558
------------iteration 1400----------
total loss 0.29328784346580505
loss_r_feature 2.2756898403167725
main criterion 0.000428214407293126
------------iteration 1500----------
total loss 0.27680617570877075
loss_r_feature 2.229142665863037
main criterion 0.00027288583805784583
------------iteration 1600----------
total loss 0.23499317467212677
loss_r_feature 1.6851799488067627
main criterion 0.0004961344529874623
------------iteration 1700----------
total loss 0.19700193405151367
loss_r_feature 1.1742184162139893
main criterion 0.0002676768635865301
------------iteration 1800----------
total loss 0.18545089662075043
loss_r_feature 1.1203135251998901
main criterion 0.00017091944755520672
------------iteration 1900----------
total loss 0.17107367515563965
loss_r_feature 0.9225016236305237
main criterion 0.00026823312509804964
------------iteration 2000----------
total loss 0.1633688360452652
loss_r_feature 0.7861547470092773
main criterion 0.0002729250700213015
------------iteration 2100----------
total loss 0.7806613445281982
loss_r_feature 4.729128360748291
main criterion 0.0007137142238207161
------------iteration 2200----------
total loss 0.6803944706916809
loss_r_feature 3.708026885986328
main criterion 0.0003912424435839057
------------iteration 2300----------
total loss 0.6860702037811279
loss_r_feature 3.867616653442383
main criterion 0.00027445875457488
------------iteration 2400----------
total loss 0.6707279086112976
loss_r_feature 4.246480941772461
main criterion 0.0005360388313420117
------------iteration 2500----------
total loss 0.5711376070976257
loss_r_feature 3.4189658164978027
main criterion 0.000493425817694515
------------iteration 2600----------
total loss 0.4588683843612671
loss_r_feature 2.0713415145874023
main criterion 0.0006040880689397454
------------iteration 2700----------
total loss 0.413882315158844
loss_r_feature 2.3640542030334473
main criterion 0.00022593149333260953
------------iteration 2800----------
total loss 0.30764511227607727
loss_r_feature 1.2057452201843262
main criterion 0.0002139590069418773
------------iteration 2900----------
total loss 0.2593717575073242
loss_r_feature 0.896217942237854
main criterion 0.00024721899535506964
------------iteration 3000----------
total loss 0.2353667914867401
loss_r_feature 0.5766329169273376
main criterion 0.0003565585648175329
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_35', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=35, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 35 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8153156638145447
loss_r_feature 7.620540618896484
main criterion 0.02107281982898712
------------iteration 200----------
total loss 0.789899468421936
loss_r_feature 4.771730422973633
main criterion 0.131495401263237
------------iteration 300----------
total loss 0.5934670567512512
loss_r_feature 4.3864288330078125
main criterion 0.009701710194349289
------------iteration 400----------
total loss 0.6172610521316528
loss_r_feature 4.1501336097717285
main criterion 0.045899782329797745
------------iteration 500----------
total loss 0.48673391342163086
loss_r_feature 2.9051384925842285
main criterion 0.0005079885595478117
------------iteration 600----------
total loss 0.5294674634933472
loss_r_feature 3.77567720413208
main criterion 0.003198839258402586
------------iteration 700----------
total loss 0.4663311243057251
loss_r_feature 2.9981837272644043
main criterion 0.0006600022315979004
------------iteration 800----------
total loss 0.6216506361961365
loss_r_feature 4.051425933837891
main criterion 0.11418945342302322
------------iteration 900----------
total loss 0.41609594225883484
loss_r_feature 2.5897793769836426
main criterion 0.000978813972324133
------------iteration 1000----------
total loss 0.3705552816390991
loss_r_feature 1.9508776664733887
main criterion 0.0003455898549873382
------------iteration 1100----------
total loss 0.3717208206653595
loss_r_feature 2.4930403232574463
main criterion 0.0006504816701635718
------------iteration 1200----------
total loss 0.34353107213974
loss_r_feature 2.2832939624786377
main criterion 0.00041667887126095593
------------iteration 1300----------
total loss 0.3174612522125244
loss_r_feature 2.1686506271362305
main criterion 0.00017370130808558315
------------iteration 1400----------
total loss 0.26708972454071045
loss_r_feature 1.5848129987716675
main criterion 0.00031264242716133595
------------iteration 1500----------
total loss 0.2523246109485626
loss_r_feature 1.6747725009918213
main criterion 0.0003727923322003335
------------iteration 1600----------
total loss 0.21374423801898956
loss_r_feature 1.2444034814834595
main criterion 0.00032636767718940973
------------iteration 1700----------
total loss 0.18211056292057037
loss_r_feature 0.8987923860549927
main criterion 0.0002664193161763251
------------iteration 1800----------
total loss 0.16083325445652008
loss_r_feature 0.6765978336334229
main criterion 0.00019605288980528712
------------iteration 1900----------
total loss 0.16274821758270264
loss_r_feature 0.8184191584587097
main criterion 0.0002592688542790711
------------iteration 2000----------
total loss 0.15206383168697357
loss_r_feature 0.6258656978607178
main criterion 0.0001934759202413261
------------iteration 2100----------
total loss 0.727628767490387
loss_r_feature 2.856220006942749
main criterion 0.0008849167497828603
------------iteration 2200----------
total loss 0.6779778599739075
loss_r_feature 2.6211671829223633
main criterion 0.0007133233593776822
------------iteration 2300----------
total loss 0.6290227174758911
loss_r_feature 2.5860116481781006
main criterion 0.0006309318705461919
------------iteration 2400----------
total loss 0.6333805918693542
loss_r_feature 2.7692408561706543
main criterion 0.0013430399121716619
------------iteration 2500----------
total loss 0.5740200281143188
loss_r_feature 3.052814245223999
main criterion 0.0006508366204798222
------------iteration 2600----------
total loss 0.4546840786933899
loss_r_feature 1.7884578704833984
main criterion 0.0003610133717302233
------------iteration 2700----------
total loss 0.37499165534973145
loss_r_feature 1.4738481044769287
main criterion 0.00020073332416359335
------------iteration 2800----------
total loss 0.33592984080314636
loss_r_feature 1.7588741779327393
main criterion 0.0003053370164707303
------------iteration 2900----------
total loss 0.25312110781669617
loss_r_feature 0.8443990349769592
main criterion 0.00026342764613218606
------------iteration 3000----------
total loss 0.2257341742515564
loss_r_feature 0.47143447399139404
main criterion 0.00022045856167096645
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_36', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=36, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 36 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.5881726145744324
loss_r_feature 2.825413942337036
main criterion 0.04735102131962776
------------iteration 200----------
total loss 0.4846848249435425
loss_r_feature 1.7034059762954712
main criterion 0.016683349385857582
------------iteration 300----------
total loss 0.4768928289413452
loss_r_feature 1.6430926322937012
main criterion 0.02500937134027481
------------iteration 400----------
total loss 0.45506566762924194
loss_r_feature 1.64620041847229
main criterion 0.028451934456825256
------------iteration 500----------
total loss 0.4474884271621704
loss_r_feature 1.3881301879882812
main criterion 0.062254201620817184
------------iteration 600----------
total loss 0.39902740716934204
loss_r_feature 1.3835697174072266
main criterion 0.03371903672814369
------------iteration 700----------
total loss 0.39680996537208557
loss_r_feature 1.1384927034378052
main criterion 0.04933127760887146
------------iteration 800----------
total loss 0.33186087012290955
loss_r_feature 1.2181364297866821
main criterion 0.006553732790052891
------------iteration 900----------
total loss 0.3055109679698944
loss_r_feature 0.8696808815002441
main criterion 0.00023551855701953173
------------iteration 1000----------
total loss 0.2736736536026001
loss_r_feature 0.784738302230835
main criterion 0.00019593953038565814
------------iteration 1100----------
total loss 0.2525472939014435
loss_r_feature 0.7715255618095398
main criterion 0.0005184457404538989
------------iteration 1200----------
total loss 0.2597413659095764
loss_r_feature 1.4981470108032227
main criterion 0.00047289367648772895
------------iteration 1300----------
total loss 0.22103355824947357
loss_r_feature 1.1878993511199951
main criterion 0.00031745232990942895
------------iteration 1400----------
total loss 0.1879897117614746
loss_r_feature 0.8221341371536255
main criterion 0.0030925299506634474
------------iteration 1500----------
total loss 0.17966020107269287
loss_r_feature 1.0773262977600098
main criterion 0.00022272218484431505
------------iteration 1600----------
total loss 0.13386324048042297
loss_r_feature 0.5002312660217285
main criterion 0.00018586392980068922
------------iteration 1700----------
total loss 0.11456624418497086
loss_r_feature 0.37341657280921936
main criterion 9.779757237993181e-05
------------iteration 1800----------
total loss 0.10077185928821564
loss_r_feature 0.2925755977630615
main criterion 7.380866736639291e-05
------------iteration 1900----------
total loss 0.09704549610614777
loss_r_feature 0.31260740756988525
main criterion 0.00014988168550189584
------------iteration 2000----------
total loss 0.09095921367406845
loss_r_feature 0.20896025002002716
main criterion 8.459272066829726e-05
------------iteration 2100----------
total loss 0.6151045560836792
loss_r_feature 1.7694196701049805
main criterion 0.0014498146483674645
------------iteration 2200----------
total loss 0.5620642900466919
loss_r_feature 1.4706487655639648
main criterion 0.00045807514106854796
------------iteration 2300----------
total loss 0.4868409335613251
loss_r_feature 1.2926745414733887
main criterion 0.0006595574668608606
------------iteration 2400----------
total loss 0.45438042283058167
loss_r_feature 0.922752857208252
main criterion 0.0008661248721182346
------------iteration 2500----------
total loss 0.42967212200164795
loss_r_feature 1.39809250831604
main criterion 0.0005966004682704806
------------iteration 2600----------
total loss 0.3453557789325714
loss_r_feature 1.4870942831039429
main criterion 0.0004923057276755571
------------iteration 2700----------
total loss 0.29835525155067444
loss_r_feature 1.523879885673523
main criterion 0.00018049293430522084
------------iteration 2800----------
total loss 0.20554395020008087
loss_r_feature 0.721958339214325
main criterion 0.00018805016588885337
------------iteration 2900----------
total loss 0.14891637861728668
loss_r_feature 0.2980319857597351
main criterion 0.00015550869284197688
------------iteration 3000----------
total loss 0.13798023760318756
loss_r_feature 0.24697473645210266
main criterion 0.00015470560174435377
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_37', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=37, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 37 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.3116806745529175
loss_r_feature 8.841010093688965
main criterion 0.4634419083595276
------------iteration 200----------
total loss 0.7905919551849365
loss_r_feature 6.2897772789001465
main criterion 0.07528315484523773
------------iteration 300----------
total loss 0.6804543137550354
loss_r_feature 5.99302864074707
main criterion 0.007134991232305765
------------iteration 400----------
total loss 0.7659604549407959
loss_r_feature 5.637025833129883
main criterion 0.13171537220478058
------------iteration 500----------
total loss 0.5276530385017395
loss_r_feature 3.8305602073669434
main criterion 0.0011859494261443615
------------iteration 600----------
total loss 0.5791589617729187
loss_r_feature 5.016367435455322
main criterion 0.012558137066662312
------------iteration 700----------
total loss 0.4904966354370117
loss_r_feature 3.4993367195129395
main criterion 0.005393884144723415
------------iteration 800----------
total loss 0.5564607381820679
loss_r_feature 4.8140716552734375
main criterion 0.020068136975169182
------------iteration 900----------
total loss 0.43643614649772644
loss_r_feature 3.139171600341797
main criterion 0.0004082060477230698
------------iteration 1000----------
total loss 0.4369999170303345
loss_r_feature 3.352764844894409
main criterion 0.007493586745113134
------------iteration 1100----------
total loss 0.38896164298057556
loss_r_feature 2.6605355739593506
main criterion 0.0049178446643054485
------------iteration 1200----------
total loss 0.43374761939048767
loss_r_feature 3.964817523956299
main criterion 0.00747836334630847
------------iteration 1300----------
total loss 0.3969954252243042
loss_r_feature 3.4610133171081543
main criterion 0.015187290497124195
------------iteration 1400----------
total loss 0.2861141562461853
loss_r_feature 1.9293583631515503
main criterion 0.0001830717083066702
------------iteration 1500----------
total loss 0.2568323016166687
loss_r_feature 1.7136571407318115
main criterion 0.00037487581721507013
------------iteration 1600----------
total loss 0.23491840064525604
loss_r_feature 1.5771888494491577
main criterion 0.0003188599366694689
------------iteration 1700----------
total loss 0.18710444867610931
loss_r_feature 0.8857614994049072
main criterion 0.00025004168855957687
------------iteration 1800----------
total loss 0.17045991122722626
loss_r_feature 0.7342329621315002
main criterion 0.00020444548863451928
------------iteration 1900----------
total loss 0.17229123413562775
loss_r_feature 0.8652381896972656
main criterion 0.00032096169888973236
------------iteration 2000----------
total loss 0.1599024534225464
loss_r_feature 0.6373162269592285
main criterion 0.00023453522589989007
------------iteration 2100----------
total loss 0.7388429641723633
loss_r_feature 3.488173246383667
main criterion 0.015380613505840302
------------iteration 2200----------
total loss 0.7156651020050049
loss_r_feature 3.7684569358825684
main criterion 0.0005848450236953795
------------iteration 2300----------
total loss 0.7193167209625244
loss_r_feature 3.2703676223754883
main criterion 0.0009032203815877438
------------iteration 2400----------
total loss 0.7142113447189331
loss_r_feature 3.759134292602539
main criterion 0.0020313593558967113
------------iteration 2500----------
total loss 0.6060635447502136
loss_r_feature 3.355189800262451
main criterion 0.0007147900760173798
------------iteration 2600----------
total loss 0.4755842089653015
loss_r_feature 2.047020673751831
main criterion 0.0004608647432178259
------------iteration 2700----------
total loss 0.40391895174980164
loss_r_feature 1.8283677101135254
main criterion 0.00026560743572190404
------------iteration 2800----------
total loss 0.3539808690547943
loss_r_feature 1.9375958442687988
main criterion 0.0003023500321432948
------------iteration 2900----------
total loss 0.25478395819664
loss_r_feature 0.6870185136795044
main criterion 0.0003342029231134802
------------iteration 3000----------
total loss 0.2419055849313736
loss_r_feature 0.6024217009544373
main criterion 0.0003441977023612708
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_38', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=38, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 38 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8369995355606079
loss_r_feature 7.959007740020752
main criterion 0.008625089190900326
------------iteration 200----------
total loss 0.7087924480438232
loss_r_feature 4.483307361602783
main criterion 0.0592602901160717
------------iteration 300----------
total loss 0.5741029381752014
loss_r_feature 3.838930130004883
main criterion 0.007402758579701185
------------iteration 400----------
total loss 0.5868106484413147
loss_r_feature 3.746237277984619
main criterion 0.03534912317991257
------------iteration 500----------
total loss 0.5062979459762573
loss_r_feature 2.969043016433716
main criterion 0.0003073045227210969
------------iteration 600----------
total loss 0.47917601466178894
loss_r_feature 2.7721004486083984
main criterion 0.001258205738849938
------------iteration 700----------
total loss 0.5056515336036682
loss_r_feature 2.987753391265869
main criterion 0.019725682213902473
------------iteration 800----------
total loss 0.460995078086853
loss_r_feature 2.9412670135498047
main criterion 0.004370906390249729
------------iteration 900----------
total loss 0.405635267496109
loss_r_feature 2.1207375526428223
main criterion 0.000933590461499989
------------iteration 1000----------
total loss 0.3596862554550171
loss_r_feature 1.797014594078064
main criterion 0.000278598687145859
------------iteration 1100----------
total loss 0.35552844405174255
loss_r_feature 1.9921889305114746
main criterion 0.0038274626713246107
------------iteration 1200----------
total loss 0.343195378780365
loss_r_feature 2.3267805576324463
main criterion 0.0017205900512635708
------------iteration 1300----------
total loss 0.3302077353000641
loss_r_feature 2.4813036918640137
main criterion 0.00046390676288865507
------------iteration 1400----------
total loss 0.2804226875305176
loss_r_feature 1.8818914890289307
main criterion 0.00045101295108906925
------------iteration 1500----------
total loss 0.26260435581207275
loss_r_feature 1.9562125205993652
main criterion 0.0004419356700964272
------------iteration 1600----------
total loss 0.2047373354434967
loss_r_feature 1.1521353721618652
main criterion 0.0004626846348401159
------------iteration 1700----------
total loss 0.17456693947315216
loss_r_feature 0.8499391078948975
main criterion 0.00048287727986462414
------------iteration 1800----------
total loss 0.1628790944814682
loss_r_feature 0.8253961205482483
main criterion 0.0002874107740353793
------------iteration 1900----------
total loss 0.15345899760723114
loss_r_feature 0.7483507394790649
main criterion 0.00029567498131655157
------------iteration 2000----------
total loss 0.1495664119720459
loss_r_feature 0.6927120089530945
main criterion 0.0002518681576475501
------------iteration 2100----------
total loss 0.7081561088562012
loss_r_feature 2.8528847694396973
main criterion 0.0008024112903513014
------------iteration 2200----------
total loss 0.692233681678772
loss_r_feature 2.186185121536255
main criterion 0.0005790539435110986
------------iteration 2300----------
total loss 0.6343384385108948
loss_r_feature 1.9353694915771484
main criterion 0.0008765281527303159
------------iteration 2400----------
total loss 0.6800588369369507
loss_r_feature 3.0559725761413574
main criterion 0.0014056514482945204
------------iteration 2500----------
total loss 0.5555799603462219
loss_r_feature 2.354569435119629
main criterion 0.0006614369340240955
------------iteration 2600----------
total loss 0.4727846682071686
loss_r_feature 1.9083712100982666
main criterion 0.00039629681850783527
------------iteration 2700----------
total loss 0.4043751358985901
loss_r_feature 2.0033154487609863
main criterion 0.0002575979451648891
------------iteration 2800----------
total loss 0.2969573736190796
loss_r_feature 1.0377442836761475
main criterion 0.00033117839484475553
------------iteration 2900----------
total loss 0.23467308282852173
loss_r_feature 0.597188413143158
main criterion 0.00023358322505373508
------------iteration 3000----------
total loss 0.22036296129226685
loss_r_feature 0.49444812536239624
main criterion 0.00022962261573411524
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_39', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=39, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 39 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8932343125343323
loss_r_feature 3.783963918685913
main criterion 0.2803400158882141
------------iteration 200----------
total loss 0.5600088238716125
loss_r_feature 1.9425764083862305
main criterion 0.07620684057474136
------------iteration 300----------
total loss 0.44297510385513306
loss_r_feature 1.6208736896514893
main criterion 0.008510326966643333
------------iteration 400----------
total loss 0.4299951195716858
loss_r_feature 1.611416220664978
main criterion 0.024227164685726166
------------iteration 500----------
total loss 0.39681142568588257
loss_r_feature 1.2085838317871094
main criterion 0.024721220135688782
------------iteration 600----------
total loss 0.3689892888069153
loss_r_feature 1.222091794013977
main criterion 0.00745755061507225
------------iteration 700----------
total loss 0.34140828251838684
loss_r_feature 0.9239749908447266
main criterion 0.0007735500694252551
------------iteration 800----------
total loss 0.4254065752029419
loss_r_feature 1.6602355241775513
main criterion 0.07864616811275482
------------iteration 900----------
total loss 0.2708759307861328
loss_r_feature 0.6825206279754639
main criterion 0.0027306017000228167
------------iteration 1000----------
total loss 0.2540084421634674
loss_r_feature 0.6264739036560059
main criterion 0.0008030857425183058
------------iteration 1100----------
total loss 0.2500869333744049
loss_r_feature 0.9488486051559448
main criterion 0.003719337284564972
------------iteration 1200----------
total loss 0.25786033272743225
loss_r_feature 1.468659520149231
main criterion 0.00048662169137969613
------------iteration 1300----------
total loss 0.20339414477348328
loss_r_feature 0.8726986646652222
main criterion 0.0007635786896571517
------------iteration 1400----------
total loss 0.1717410683631897
loss_r_feature 0.6728594899177551
main criterion 0.00032308007939718664
------------iteration 1500----------
total loss 0.16160491108894348
loss_r_feature 0.6692429780960083
main criterion 0.008777054026722908
------------iteration 1600----------
total loss 0.13606515526771545
loss_r_feature 0.6424330472946167
main criterion 0.00022855456336401403
------------iteration 1700----------
total loss 0.11066244542598724
loss_r_feature 0.3929435610771179
main criterion 0.00015690184955019504
------------iteration 1800----------
total loss 0.09966627508401871
loss_r_feature 0.359095960855484
main criterion 7.800626190146431e-05
------------iteration 1900----------
total loss 0.08977784216403961
loss_r_feature 0.2562871277332306
main criterion 0.00013994702021591365
------------iteration 2000----------
total loss 0.08569213002920151
loss_r_feature 0.1930202692747116
main criterion 9.862661681836471e-05
------------iteration 2100----------
total loss 0.525824785232544
loss_r_feature 0.9248104095458984
main criterion 0.030336055904626846
------------iteration 2200----------
total loss 0.4977858066558838
loss_r_feature 0.914264440536499
main criterion 0.0005578220007009804
------------iteration 2300----------
total loss 0.4865407943725586
loss_r_feature 1.0119655132293701
main criterion 0.000906548579223454
------------iteration 2400----------
total loss 0.4516638219356537
loss_r_feature 0.9290728569030762
main criterion 0.0009560852195136249
------------iteration 2500----------
total loss 0.38980358839035034
loss_r_feature 0.8214950561523438
main criterion 0.00033825659193098545
------------iteration 2600----------
total loss 0.3113851249217987
loss_r_feature 0.7714290618896484
main criterion 0.00031176782795228064
------------iteration 2700----------
total loss 0.2535874545574188
loss_r_feature 0.8993127346038818
main criterion 0.00017319827747996897
------------iteration 2800----------
total loss 0.19071584939956665
loss_r_feature 0.6099147200584412
main criterion 0.00017842308443505317
------------iteration 2900----------
total loss 0.14168860018253326
loss_r_feature 0.34762993454933167
main criterion 0.00021496966655831784
------------iteration 3000----------
total loss 0.1252204328775406
loss_r_feature 0.19368278980255127
main criterion 0.00012957726721651852
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_40', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=40, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 40 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8996235132217407
loss_r_feature 7.862961769104004
main criterion 0.10635960847139359
------------iteration 200----------
total loss 0.7587380409240723
loss_r_feature 6.601278305053711
main criterion 0.007467274088412523
------------iteration 300----------
total loss 0.6169595718383789
loss_r_feature 4.958922386169434
main criterion 0.0032253279350697994
------------iteration 400----------
total loss 0.6157768964767456
loss_r_feature 4.939342021942139
main criterion 0.009625520557165146
------------iteration 500----------
total loss 0.5428083539009094
loss_r_feature 3.8984971046447754
main criterion 0.0004674191295634955
------------iteration 600----------
total loss 0.8394747376441956
loss_r_feature 4.553841590881348
main criterion 0.2877618670463562
------------iteration 700----------
total loss 0.5096445083618164
loss_r_feature 3.9038758277893066
main criterion 0.010882427915930748
------------iteration 800----------
total loss 0.5050932168960571
loss_r_feature 3.600120782852173
main criterion 0.033628251403570175
------------iteration 900----------
total loss 0.4380823075771332
loss_r_feature 2.8192806243896484
main criterion 0.021098483353853226
------------iteration 1000----------
total loss 0.390339732170105
loss_r_feature 2.45119571685791
main criterion 0.0002663859340827912
------------iteration 1100----------
total loss 0.3748849630355835
loss_r_feature 2.6537249088287354
main criterion 0.0006380706327036023
------------iteration 1200----------
total loss 0.3778231143951416
loss_r_feature 3.0850558280944824
main criterion 0.0006978709134273231
------------iteration 1300----------
total loss 0.31833577156066895
loss_r_feature 2.2651987075805664
main criterion 0.0003260825469624251
------------iteration 1400----------
total loss 0.28787896037101746
loss_r_feature 1.9936484098434448
main criterion 0.00027128594228997827
------------iteration 1500----------
total loss 0.2579686641693115
loss_r_feature 1.761034607887268
main criterion 0.0006779133691452444
------------iteration 1600----------
total loss 0.246623232960701
loss_r_feature 1.8425896167755127
main criterion 0.00036395995994098485
------------iteration 1700----------
total loss 0.18868644535541534
loss_r_feature 0.939437747001648
main criterion 0.0003141830093227327
------------iteration 1800----------
total loss 0.16563895344734192
loss_r_feature 0.6593872308731079
main criterion 0.00025239645037800074
------------iteration 1900----------
total loss 0.17354342341423035
loss_r_feature 0.9099729061126709
main criterion 0.0004061859508510679
------------iteration 2000----------
total loss 0.1579034924507141
loss_r_feature 0.6184737682342529
main criterion 0.00023386313114315271
------------iteration 2100----------
total loss 0.7272207140922546
loss_r_feature 3.2323198318481445
main criterion 0.0006996159791015089
------------iteration 2200----------
total loss 0.71084064245224
loss_r_feature 2.9223086833953857
main criterion 0.0006022344459779561
------------iteration 2300----------
total loss 0.6717504858970642
loss_r_feature 2.7185022830963135
main criterion 0.0006620521889999509
------------iteration 2400----------
total loss 0.6543980240821838
loss_r_feature 3.138982057571411
main criterion 0.004347675014287233
------------iteration 2500----------
total loss 0.620808482170105
loss_r_feature 3.624882698059082
main criterion 0.0014874667394906282
------------iteration 2600----------
total loss 0.4593406319618225
loss_r_feature 1.8814493417739868
main criterion 0.0004501304938457906
------------iteration 2700----------
total loss 0.42901718616485596
loss_r_feature 2.439602851867676
main criterion 0.0003264390106778592
------------iteration 2800----------
total loss 0.3272973597049713
loss_r_feature 1.5049161911010742
main criterion 0.00034779388806782663
------------iteration 2900----------
total loss 0.24026422202587128
loss_r_feature 0.5189613103866577
main criterion 0.00022804748732596636
------------iteration 3000----------
total loss 0.22875794768333435
loss_r_feature 0.45771661400794983
main criterion 0.00035776934237219393
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_41', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=41, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 41 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8157272338867188
loss_r_feature 6.585501670837402
main criterion 0.06050948426127434
------------iteration 200----------
total loss 0.6931889653205872
loss_r_feature 4.793402194976807
main criterion 0.012921400368213654
------------iteration 300----------
total loss 0.6572811007499695
loss_r_feature 4.323992729187012
main criterion 0.03332880884408951
------------iteration 400----------
total loss 0.6503772735595703
loss_r_feature 4.327846527099609
main criterion 0.04761212691664696
------------iteration 500----------
total loss 0.5399904251098633
loss_r_feature 3.4786014556884766
main criterion 0.0005415157065726817
------------iteration 600----------
total loss 0.554535448551178
loss_r_feature 3.690748691558838
main criterion 0.012779923155903816
------------iteration 700----------
total loss 0.4881388545036316
loss_r_feature 2.9110512733459473
main criterion 0.0033128459472209215
------------iteration 800----------
total loss 0.470162570476532
loss_r_feature 2.931894302368164
main criterion 0.0053902603685855865
------------iteration 900----------
total loss 0.41981399059295654
loss_r_feature 2.233356475830078
main criterion 0.000886418973095715
------------iteration 1000----------
total loss 0.3827683627605438
loss_r_feature 1.994699478149414
main criterion 0.0003930578532163054
------------iteration 1100----------
total loss 0.3788342773914337
loss_r_feature 2.2815232276916504
main criterion 0.00266653741709888
------------iteration 1200----------
total loss 0.368429958820343
loss_r_feature 2.579190492630005
main criterion 0.0003244432737119496
------------iteration 1300----------
total loss 0.3362513482570648
loss_r_feature 2.35573148727417
main criterion 0.0005682454211637378
------------iteration 1400----------
total loss 0.2826862931251526
loss_r_feature 1.6594843864440918
main criterion 0.0020001991651952267
------------iteration 1500----------
total loss 0.2693873345851898
loss_r_feature 1.8744149208068848
main criterion 0.00020597332331817597
------------iteration 1600----------
total loss 0.239043191075325
loss_r_feature 1.5978262424468994
main criterion 0.0009789831237867475
------------iteration 1700----------
total loss 0.19098016619682312
loss_r_feature 0.9512061476707458
main criterion 0.000341659935656935
------------iteration 1800----------
total loss 0.16970305144786835
loss_r_feature 0.7360677719116211
main criterion 0.00028251897310838103
------------iteration 1900----------
total loss 0.1719234585762024
loss_r_feature 0.8932000398635864
main criterion 0.00024393617059104145
------------iteration 2000----------
total loss 0.16122956573963165
loss_r_feature 0.6980413198471069
main criterion 0.00028773941448889673
------------iteration 2100----------
total loss 0.7244692444801331
loss_r_feature 2.478835344314575
main criterion 0.0012393852230161428
------------iteration 2200----------
total loss 0.7710774540901184
loss_r_feature 3.087806463241577
main criterion 0.003689108183607459
------------iteration 2300----------
total loss 0.7242262363433838
loss_r_feature 2.757981777191162
main criterion 0.0009084101766347885
------------iteration 2400----------
total loss 0.6742166876792908
loss_r_feature 2.490396738052368
main criterion 0.0012669479474425316
------------iteration 2500----------
total loss 0.5949554443359375
loss_r_feature 2.3073832988739014
main criterion 0.0019021633779630065
------------iteration 2600----------
total loss 0.5212196707725525
loss_r_feature 2.1993982791900635
main criterion 0.0011073636123910546
------------iteration 2700----------
total loss 0.45428740978240967
loss_r_feature 2.310911178588867
main criterion 0.0005490632611326873
------------iteration 2800----------
total loss 0.32790547609329224
loss_r_feature 1.1302227973937988
main criterion 0.00031256399233825505
------------iteration 2900----------
total loss 0.2565614581108093
loss_r_feature 0.5444470047950745
main criterion 0.0002702073543332517
------------iteration 3000----------
total loss 0.24435870349407196
loss_r_feature 0.4948427081108093
main criterion 0.00032070238376036286
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_42', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=42, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 42 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.49474167823791504
loss_r_feature 2.2033073902130127
main criterion 0.007653668522834778
------------iteration 200----------
total loss 0.46073397994041443
loss_r_feature 1.60687255859375
main criterion 0.008391190320253372
------------iteration 300----------
total loss 0.47213655710220337
loss_r_feature 1.7109503746032715
main criterion 0.008528699167072773
------------iteration 400----------
total loss 0.42958131432533264
loss_r_feature 1.5382283926010132
main criterion 0.004386913031339645
------------iteration 500----------
total loss 0.4019668698310852
loss_r_feature 1.613562822341919
main criterion 0.00048488107859157026
------------iteration 600----------
total loss 0.42061179876327515
loss_r_feature 1.420676827430725
main criterion 0.022816253826022148
------------iteration 700----------
total loss 0.35417798161506653
loss_r_feature 1.2066372632980347
main criterion 0.005550661124289036
------------iteration 800----------
total loss 0.35375598073005676
loss_r_feature 1.5373164415359497
main criterion 0.002595167141407728
------------iteration 900----------
total loss 0.2925419509410858
loss_r_feature 0.8066654801368713
main criterion 0.0008443370461463928
------------iteration 1000----------
total loss 0.29081663489341736
loss_r_feature 1.0397146940231323
main criterion 0.0008223601616919041
------------iteration 1100----------
total loss 0.27227339148521423
loss_r_feature 1.0502256155014038
main criterion 0.003184900851920247
------------iteration 1200----------
total loss 0.25172024965286255
loss_r_feature 1.1696618795394897
main criterion 0.000823510461486876
------------iteration 1300----------
total loss 0.2098272293806076
loss_r_feature 0.7644665837287903
main criterion 0.0003391293284948915
------------iteration 1400----------
total loss 0.18856821954250336
loss_r_feature 0.6806331872940063
main criterion 0.00036429837928153574
------------iteration 1500----------
total loss 0.16047775745391846
loss_r_feature 0.5270503759384155
main criterion 0.000772742263507098
------------iteration 1600----------
total loss 0.1395118236541748
loss_r_feature 0.4630637764930725
main criterion 0.0003019381547346711
------------iteration 1700----------
total loss 0.11662597954273224
loss_r_feature 0.291599303483963
main criterion 0.0001573339250171557
------------iteration 1800----------
total loss 0.10540232807397842
loss_r_feature 0.27726197242736816
main criterion 0.00012688085553236306
------------iteration 1900----------
total loss 0.10066857933998108
loss_r_feature 0.28563642501831055
main criterion 9.658227645559236e-05
------------iteration 2000----------
total loss 0.09537456929683685
loss_r_feature 0.1982307732105255
main criterion 0.00010393166303401813
------------iteration 2100----------
total loss 0.6393008232116699
loss_r_feature 1.2612419128417969
main criterion 0.001823985017836094
------------iteration 2200----------
total loss 0.5901418924331665
loss_r_feature 0.9366672039031982
main criterion 0.00062406255165115
------------iteration 2300----------
total loss 0.48739317059516907
loss_r_feature 0.6422759294509888
main criterion 0.0008592151571065187
------------iteration 2400----------
total loss 0.49920666217803955
loss_r_feature 0.9843314290046692
main criterion 0.0014988044276833534
------------iteration 2500----------
total loss 0.41814160346984863
loss_r_feature 1.0388256311416626
main criterion 0.0006827142788097262
------------iteration 2600----------
total loss 0.35032859444618225
loss_r_feature 1.0214343070983887
main criterion 0.0006129854591563344
------------iteration 2700----------
total loss 0.2962385416030884
loss_r_feature 1.0533173084259033
main criterion 0.00018155576253775507
------------iteration 2800----------
total loss 0.2070545256137848
loss_r_feature 0.44837504625320435
main criterion 0.00020645854237955064
------------iteration 2900----------
total loss 0.17488643527030945
loss_r_feature 0.6227906346321106
main criterion 0.00019373752002138644
------------iteration 3000----------
total loss 0.14742131531238556
loss_r_feature 0.25960013270378113
main criterion 0.00018202395585831255
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_43', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=43, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 43 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8393124938011169
loss_r_feature 7.168273448944092
main criterion 0.079317107796669
------------iteration 200----------
total loss 0.6778709292411804
loss_r_feature 5.409235954284668
main criterion 0.0007881024503149092
------------iteration 300----------
total loss 0.6985821723937988
loss_r_feature 5.365533828735352
main criterion 0.04620455577969551
------------iteration 400----------
total loss 0.7375689744949341
loss_r_feature 6.29859733581543
main criterion 0.06430138647556305
------------iteration 500----------
total loss 0.5880686640739441
loss_r_feature 4.183725833892822
main criterion 0.009770013391971588
------------iteration 600----------
total loss 0.5187860131263733
loss_r_feature 3.555673360824585
main criterion 0.001745565328747034
------------iteration 700----------
total loss 0.5471203923225403
loss_r_feature 4.281826019287109
main criterion 0.0027471608482301235
------------iteration 800----------
total loss 0.49718108773231506
loss_r_feature 3.54287052154541
main criterion 0.0021801639813929796
------------iteration 900----------
total loss 0.47684985399246216
loss_r_feature 3.2422690391540527
main criterion 0.0011047214502468705
------------iteration 1000----------
total loss 0.4142194390296936
loss_r_feature 2.5448110103607178
main criterion 0.0009584604413248599
------------iteration 1100----------
total loss 0.4053957462310791
loss_r_feature 2.616018056869507
main criterion 0.0007602819241583347
------------iteration 1200----------
total loss 0.42404013872146606
loss_r_feature 3.575788736343384
main criterion 0.0006539571331813931
------------iteration 1300----------
total loss 0.3930002748966217
loss_r_feature 3.208315372467041
main criterion 0.0002509250189177692
------------iteration 1400----------
total loss 0.3567880690097809
loss_r_feature 2.9212846755981445
main criterion 0.0011203299509361386
------------iteration 1500----------
total loss 0.265048623085022
loss_r_feature 1.5295051336288452
main criterion 0.0004222260322421789
------------iteration 1600----------
total loss 0.25673630833625793
loss_r_feature 1.7182368040084839
main criterion 0.00047236340469680727
------------iteration 1700----------
total loss 0.21075381338596344
loss_r_feature 1.088409662246704
main criterion 0.00031668765586800873
------------iteration 1800----------
total loss 0.19085532426834106
loss_r_feature 0.8913865089416504
main criterion 0.00033894056105054915
------------iteration 1900----------
total loss 0.18720760941505432
loss_r_feature 0.9360805749893188
main criterion 0.00036038996768184006
------------iteration 2000----------
total loss 0.19019851088523865
loss_r_feature 1.015165090560913
main criterion 0.0002776587789412588
------------iteration 2100----------
total loss 0.7054754495620728
loss_r_feature 3.288254737854004
main criterion 0.0034642990212887526
------------iteration 2200----------
total loss 0.7950685620307922
loss_r_feature 4.8180623054504395
main criterion 0.0008810067665763199
------------iteration 2300----------
total loss 0.7428272366523743
loss_r_feature 3.5857889652252197
main criterion 0.006180333439260721
------------iteration 2400----------
total loss 0.6851155161857605
loss_r_feature 3.359654426574707
main criterion 0.0023776863235980272
------------iteration 2500----------
total loss 0.5852687358856201
loss_r_feature 2.526357650756836
main criterion 0.0007001250050961971
------------iteration 2600----------
total loss 0.4802473783493042
loss_r_feature 1.6537457704544067
main criterion 0.0006404234445653856
------------iteration 2700----------
total loss 0.5262590050697327
loss_r_feature 4.0396833419799805
main criterion 0.0005026294966228306
------------iteration 2800----------
total loss 0.3324851989746094
loss_r_feature 1.357640027999878
main criterion 0.0002731065615080297
------------iteration 2900----------
total loss 0.2665562033653259
loss_r_feature 0.8199456334114075
main criterion 0.0002420388045720756
------------iteration 3000----------
total loss 0.24998611211776733
loss_r_feature 0.6975117921829224
main criterion 0.00030109097133390605
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_44', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=44, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 44 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7326592206954956
loss_r_feature 6.376476287841797
main criterion 0.010091994889080524
------------iteration 200----------
total loss 0.6840633749961853
loss_r_feature 4.1200971603393555
main criterion 0.03317796066403389
------------iteration 300----------
total loss 0.6576521396636963
loss_r_feature 4.292120456695557
main criterion 0.02256166934967041
------------iteration 400----------
total loss 0.6862810254096985
loss_r_feature 5.308249473571777
main criterion 0.01429890189319849
------------iteration 500----------
total loss 0.5793054103851318
loss_r_feature 3.5575995445251465
main criterion 0.0010330242803320289
------------iteration 600----------
total loss 0.6154157519340515
loss_r_feature 4.076427459716797
main criterion 0.016616055741906166
------------iteration 700----------
total loss 0.6451340913772583
loss_r_feature 5.007424831390381
main criterion 0.01893886737525463
------------iteration 800----------
total loss 0.5629953742027283
loss_r_feature 3.9490532875061035
main criterion 0.00735802436247468
------------iteration 900----------
total loss 0.5134562849998474
loss_r_feature 3.3602147102355957
main criterion 0.0015762454131618142
------------iteration 1000----------
total loss 0.44640350341796875
loss_r_feature 2.4751486778259277
main criterion 0.0011633638059720397
------------iteration 1100----------
total loss 0.4318063259124756
loss_r_feature 2.5773537158966064
main criterion 0.0007286889594979584
------------iteration 1200----------
total loss 0.4531632363796234
loss_r_feature 3.3981025218963623
main criterion 0.0006964299245737493
------------iteration 1300----------
total loss 0.38377049565315247
loss_r_feature 2.5959224700927734
main criterion 0.0003779614344239235
------------iteration 1400----------
total loss 0.3510741889476776
loss_r_feature 2.4177958965301514
main criterion 0.00038161457632668316
------------iteration 1500----------
total loss 0.3030409514904022
loss_r_feature 1.9310818910598755
main criterion 0.00042805602424778044
------------iteration 1600----------
total loss 0.28732433915138245
loss_r_feature 2.0281078815460205
main criterion 0.0008165556937456131
------------iteration 1700----------
total loss 0.24831995368003845
loss_r_feature 1.5988268852233887
main criterion 0.00027221531490795314
------------iteration 1800----------
total loss 0.22190146148204803
loss_r_feature 1.3251631259918213
main criterion 0.000258297921391204
------------iteration 1900----------
total loss 0.21248219907283783
loss_r_feature 1.2668423652648926
main criterion 0.0004297368577681482
------------iteration 2000----------
total loss 0.20632404088974
loss_r_feature 1.1687480211257935
main criterion 0.00022611873282585293
------------iteration 2100----------
total loss 0.7752758860588074
loss_r_feature 2.9021191596984863
main criterion 0.0018067386699840426
------------iteration 2200----------
total loss 0.9007397294044495
loss_r_feature 3.8448429107666016
main criterion 0.0008990092319436371
------------iteration 2300----------
total loss 0.8860253095626831
loss_r_feature 4.1923136711120605
main criterion 0.0012821670388802886
------------iteration 2400----------
total loss 0.8595978021621704
loss_r_feature 3.6780965328216553
main criterion 0.027165472507476807
------------iteration 2500----------
total loss 0.7326328158378601
loss_r_feature 3.2104527950286865
main criterion 0.001250128960236907
------------iteration 2600----------
total loss 0.6193294525146484
loss_r_feature 2.4636740684509277
main criterion 0.0008778306073509157
------------iteration 2700----------
total loss 0.4940915107727051
loss_r_feature 1.4997316598892212
main criterion 0.00028343030135147274
------------iteration 2800----------
total loss 0.4393036663532257
loss_r_feature 1.8274030685424805
main criterion 0.0005294588627293706
------------iteration 2900----------
total loss 0.35254645347595215
loss_r_feature 1.0291035175323486
main criterion 0.0002844060363713652
------------iteration 3000----------
total loss 0.32183730602264404
loss_r_feature 0.6246525645256042
main criterion 0.00028956931782886386
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_45', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=45, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 45 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.6024624109268188
loss_r_feature 3.3109352588653564
main criterion 0.02261294610798359
------------iteration 200----------
total loss 0.5219506621360779
loss_r_feature 1.8076366186141968
main criterion 0.0046427748166024685
------------iteration 300----------
total loss 0.4793305993080139
loss_r_feature 1.9628154039382935
main criterion 0.0013435555156320333
------------iteration 400----------
total loss 0.48147377371788025
loss_r_feature 1.9616831541061401
main criterion 0.001041194424033165
------------iteration 500----------
total loss 0.4659005403518677
loss_r_feature 1.6017042398452759
main criterion 0.0007533177267760038
------------iteration 600----------
total loss 0.4559030532836914
loss_r_feature 1.9357585906982422
main criterion 0.009217320010066032
------------iteration 700----------
total loss 0.42159876227378845
loss_r_feature 1.6697872877120972
main criterion 0.001209012232720852
------------iteration 800----------
total loss 0.41029611229896545
loss_r_feature 1.7060332298278809
main criterion 0.0008090448682196438
------------iteration 900----------
total loss 0.3855956792831421
loss_r_feature 1.471822738647461
main criterion 0.001521604717709124
------------iteration 1000----------
total loss 0.34462207555770874
loss_r_feature 1.1251081228256226
main criterion 0.00047987443394958973
------------iteration 1100----------
total loss 0.3261353671550751
loss_r_feature 1.3073025941848755
main criterion 0.0009348258608952165
------------iteration 1200----------
total loss 0.31193891167640686
loss_r_feature 1.4483020305633545
main criterion 0.00032380720949731767
------------iteration 1300----------
total loss 0.2799423933029175
loss_r_feature 1.3096905946731567
main criterion 0.0003848323249258101
------------iteration 1400----------
total loss 0.25800397992134094
loss_r_feature 1.3712756633758545
main criterion 0.0005441255052573979
------------iteration 1500----------
total loss 0.25073787569999695
loss_r_feature 1.6393957138061523
main criterion 0.0005413117469288409
------------iteration 1600----------
total loss 0.202437624335289
loss_r_feature 1.089851975440979
main criterion 0.00026396496105007827
------------iteration 1700----------
total loss 0.1706683337688446
loss_r_feature 0.7844960689544678
main criterion 0.0001277418341487646
------------iteration 1800----------
total loss 0.1468229740858078
loss_r_feature 0.5315356254577637
main criterion 0.00010525099060032517
------------iteration 1900----------
total loss 0.14066113531589508
loss_r_feature 0.5190288424491882
main criterion 0.00012152919953223318
------------iteration 2000----------
total loss 0.13619990646839142
loss_r_feature 0.44927799701690674
main criterion 0.00012452073860913515
------------iteration 2100----------
total loss 0.6413164734840393
loss_r_feature 1.8228172063827515
main criterion 0.0009402192663401365
------------iteration 2200----------
total loss 0.7024804353713989
loss_r_feature 2.110887050628662
main criterion 0.0010694835800677538
------------iteration 2300----------
total loss 0.6434069275856018
loss_r_feature 1.314171314239502
main criterion 0.0006096630240790546
------------iteration 2400----------
total loss 0.5940024256706238
loss_r_feature 1.6477704048156738
main criterion 0.001504797488451004
------------iteration 2500----------
total loss 0.5454796552658081
loss_r_feature 1.8270823955535889
main criterion 0.0008309428812935948
------------iteration 2600----------
total loss 0.47397246956825256
loss_r_feature 1.7184529304504395
main criterion 0.0017550908960402012
------------iteration 2700----------
total loss 0.3765745759010315
loss_r_feature 1.1898475885391235
main criterion 0.0004731589287985116
------------iteration 2800----------
total loss 0.2892622649669647
loss_r_feature 0.7966821789741516
main criterion 0.0002814840408973396
------------iteration 2900----------
total loss 0.23191018402576447
loss_r_feature 0.5075811743736267
main criterion 0.0001898130722111091
------------iteration 3000----------
total loss 0.2166324108839035
loss_r_feature 0.4004044830799103
main criterion 0.0002220018650405109
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_46', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=46, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 46 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.932453453540802
loss_r_feature 10.10567855834961
main criterion 0.02461639791727066
------------iteration 200----------
total loss 0.7637627720832825
loss_r_feature 7.540766716003418
main criterion 0.004178076051175594
------------iteration 300----------
total loss 0.8775800466537476
loss_r_feature 6.969020366668701
main criterion 0.17181438207626343
------------iteration 400----------
total loss 0.6694362759590149
loss_r_feature 6.429991722106934
main criterion 0.01614690199494362
------------iteration 500----------
total loss 0.6128836274147034
loss_r_feature 5.670148849487305
main criterion 0.0034719035029411316
------------iteration 600----------
total loss 0.6210540533065796
loss_r_feature 5.940816879272461
main criterion 0.01182805746793747
------------iteration 700----------
total loss 0.5126216411590576
loss_r_feature 4.4860053062438965
main criterion 0.0019018755992874503
------------iteration 800----------
total loss 0.5517405867576599
loss_r_feature 5.580417633056641
main criterion 0.004478562623262405
------------iteration 900----------
total loss 0.42421215772628784
loss_r_feature 3.5147175788879395
main criterion 0.0009860483696684241
------------iteration 1000----------
total loss 0.3972586393356323
loss_r_feature 3.317601203918457
main criterion 0.0005283256177790463
------------iteration 1100----------
total loss 0.4174187183380127
loss_r_feature 3.816676139831543
main criterion 0.0006513464031741023
------------iteration 1200----------
total loss 0.34013405442237854
loss_r_feature 2.9583024978637695
main criterion 0.001572799519635737
------------iteration 1300----------
total loss 0.31309670209884644
loss_r_feature 2.7421984672546387
main criterion 0.0004058497434016317
------------iteration 1400----------
total loss 0.2974490523338318
loss_r_feature 2.730785846710205
main criterion 0.0007313285022974014
------------iteration 1500----------
total loss 0.2770387828350067
loss_r_feature 2.6494011878967285
main criterion 0.0006134542636573315
------------iteration 1600----------
total loss 0.24690450727939606
loss_r_feature 2.316175937652588
main criterion 0.0008867781143635511
------------iteration 1700----------
total loss 0.22099387645721436
loss_r_feature 2.043639659881592
main criterion 0.0005439468659460545
------------iteration 1800----------
total loss 0.19926010072231293
loss_r_feature 1.7838753461837769
main criterion 0.00037017432623542845
------------iteration 1900----------
total loss 0.19634470343589783
loss_r_feature 1.8113301992416382
main criterion 0.00038872784352861345
------------iteration 2000----------
total loss 0.18471071124076843
loss_r_feature 1.5928822755813599
main criterion 0.0004224822041578591
------------iteration 2100----------
total loss 0.6938012838363647
loss_r_feature 3.951693058013916
main criterion 0.0019396611023694277
------------iteration 2200----------
total loss 0.6559590101242065
loss_r_feature 3.3068904876708984
main criterion 0.0008708789246156812
------------iteration 2300----------
total loss 0.677281379699707
loss_r_feature 3.79168963432312
main criterion 0.0008361845393665135
------------iteration 2400----------
total loss 0.6322211623191833
loss_r_feature 3.6851301193237305
main criterion 0.0022917469032108784
------------iteration 2500----------
total loss 0.5866305232048035
loss_r_feature 3.685718536376953
main criterion 0.0013043975923210382
------------iteration 2600----------
total loss 0.4463265836238861
loss_r_feature 2.0997109413146973
main criterion 0.0005778225022368133
------------iteration 2700----------
total loss 0.38209104537963867
loss_r_feature 1.866776704788208
main criterion 0.0004036878526676446
------------iteration 2800----------
total loss 0.30354180932044983
loss_r_feature 1.2682247161865234
main criterion 0.00037142401561141014
------------iteration 2900----------
total loss 0.2584258019924164
loss_r_feature 1.0434914827346802
main criterion 0.00035392740392126143
------------iteration 3000----------
total loss 0.2325209379196167
loss_r_feature 0.7001993656158447
main criterion 0.00029966310830786824
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_47', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=47, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 47 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.005665898323059
loss_r_feature 9.736772537231445
main criterion 0.09928471595048904
------------iteration 200----------
total loss 0.9653005003929138
loss_r_feature 7.037392616271973
main criterion 0.12426580488681793
------------iteration 300----------
total loss 0.751013994216919
loss_r_feature 5.690196990966797
main criterion 0.009947545826435089
------------iteration 400----------
total loss 1.0246119499206543
loss_r_feature 8.14307975769043
main criterion 0.16909253597259521
------------iteration 500----------
total loss 0.6626061797142029
loss_r_feature 4.41082763671875
main criterion 0.0036989247892051935
------------iteration 600----------
total loss 0.7140739560127258
loss_r_feature 5.265329360961914
main criterion 0.01308806985616684
------------iteration 700----------
total loss 0.7665833830833435
loss_r_feature 6.869316577911377
main criterion 0.01273447833955288
------------iteration 800----------
total loss 0.6571080088615417
loss_r_feature 5.032284736633301
main criterion 0.002728036604821682
------------iteration 900----------
total loss 0.6253404021263123
loss_r_feature 4.822015285491943
main criterion 0.0008919379906728864
------------iteration 1000----------
total loss 0.5891636610031128
loss_r_feature 4.413619518280029
main criterion 0.002054415177553892
------------iteration 1100----------
total loss 0.5236011147499084
loss_r_feature 3.3834004402160645
main criterion 0.004276761319488287
------------iteration 1200----------
total loss 0.477735698223114
loss_r_feature 2.9810662269592285
main criterion 0.0011371491709724069
------------iteration 1300----------
total loss 0.4222870469093323
loss_r_feature 2.373936176300049
main criterion 0.001767731853760779
------------iteration 1400----------
total loss 0.4144838750362396
loss_r_feature 2.685853958129883
main criterion 0.0005375262699089944
------------iteration 1500----------
total loss 0.3700107932090759
loss_r_feature 2.2412874698638916
main criterion 0.0007415515719912946
------------iteration 1600----------
total loss 0.35051220655441284
loss_r_feature 2.2349467277526855
main criterion 0.0007565186242572963
------------iteration 1700----------
total loss 0.2982804477214813
loss_r_feature 1.5167346000671387
main criterion 0.0004285028553567827
------------iteration 1800----------
total loss 0.2794293761253357
loss_r_feature 1.353426218032837
main criterion 0.0005973898805677891
------------iteration 1900----------
total loss 0.2620866298675537
loss_r_feature 1.1163403987884521
main criterion 0.0005997080588713288
------------iteration 2000----------
total loss 0.264339417219162
loss_r_feature 1.1805551052093506
main criterion 0.0005141147994436324
------------iteration 2100----------
total loss 0.9194592833518982
loss_r_feature 4.630954742431641
main criterion 0.002442236291244626
------------iteration 2200----------
total loss 0.9949990510940552
loss_r_feature 4.025792121887207
main criterion 0.000997441355139017
------------iteration 2300----------
total loss 1.040329933166504
loss_r_feature 5.608354568481445
main criterion 0.002813198836520314
------------iteration 2400----------
total loss 1.070611596107483
loss_r_feature 6.397042274475098
main criterion 0.01758968085050583
------------iteration 2500----------
total loss 0.9085164070129395
loss_r_feature 5.235690116882324
main criterion 0.0014299286995083094
------------iteration 2600----------
total loss 0.7424933910369873
loss_r_feature 3.327235698699951
main criterion 0.001306683523580432
------------iteration 2700----------
total loss 0.618240475654602
loss_r_feature 2.3340835571289062
main criterion 0.0007420041365548968
------------iteration 2800----------
total loss 0.5592352747917175
loss_r_feature 2.5630016326904297
main criterion 0.0009549527894705534
------------iteration 2900----------
total loss 0.4425901770591736
loss_r_feature 1.2012768983840942
main criterion 0.0005299549084156752
------------iteration 3000----------
total loss 0.4245004653930664
loss_r_feature 1.0335655212402344
main criterion 0.0006793448701500893
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_48', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=48, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 48 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7846311926841736
loss_r_feature 7.006544589996338
main criterion 0.00844254344701767
------------iteration 200----------
total loss 0.7390075325965881
loss_r_feature 4.967838287353516
main criterion 0.004634502809494734
------------iteration 300----------
total loss 0.7154179811477661
loss_r_feature 4.844042778015137
main criterion 0.0017439075745642185
------------iteration 400----------
total loss 0.7508246302604675
loss_r_feature 5.361635208129883
main criterion 0.03430774435400963
------------iteration 500----------
total loss 0.619511067867279
loss_r_feature 3.5384817123413086
main criterion 0.002756276400759816
------------iteration 600----------
total loss 0.6468397378921509
loss_r_feature 4.078824520111084
main criterion 0.014184967614710331
------------iteration 700----------
total loss 0.6838561296463013
loss_r_feature 5.261587619781494
main criterion 0.003880399977788329
------------iteration 800----------
total loss 0.6223321557044983
loss_r_feature 4.021805763244629
main criterion 0.017612017691135406
------------iteration 900----------
total loss 0.5419995784759521
loss_r_feature 3.069464921951294
main criterion 0.0005744580994360149
------------iteration 1000----------
total loss 0.5469990372657776
loss_r_feature 3.6462483406066895
main criterion 0.0011925341095775366
------------iteration 1100----------
total loss 0.5502063035964966
loss_r_feature 4.019958019256592
main criterion 0.00888832937926054
------------iteration 1200----------
total loss 0.4488389194011688
loss_r_feature 2.6755547523498535
main criterion 0.0014045477146282792
------------iteration 1300----------
total loss 0.4895441234111786
loss_r_feature 3.9991159439086914
main criterion 0.0003639454080257565
------------iteration 1400----------
total loss 0.3669700026512146
loss_r_feature 2.050515651702881
main criterion 0.0006832132930867374
------------iteration 1500----------
total loss 0.3901226818561554
loss_r_feature 2.9798765182495117
main criterion 0.0006262647802941501
------------iteration 1600----------
total loss 0.3121468126773834
loss_r_feature 1.8280292749404907
main criterion 0.0009525218629278243
------------iteration 1700----------
total loss 0.2740684449672699
loss_r_feature 1.4430922269821167
main criterion 0.0007837109733372927
------------iteration 1800----------
total loss 0.2506527602672577
loss_r_feature 1.2284061908721924
main criterion 0.00047998822992667556
------------iteration 1900----------
total loss 0.24721942842006683
loss_r_feature 1.2829182147979736
main criterion 0.0005609571817331016
------------iteration 2000----------
total loss 0.2522295117378235
loss_r_feature 1.4058973789215088
main criterion 0.0005441057146526873
------------iteration 2100----------
total loss 0.9433857798576355
loss_r_feature 3.548910617828369
main criterion 0.010220509022474289
------------iteration 2200----------
total loss 0.9848964810371399
loss_r_feature 3.1015849113464355
main criterion 0.0024244640953838825
------------iteration 2300----------
total loss 1.0295952558517456
loss_r_feature 4.210434913635254
main criterion 0.0025307161267846823
------------iteration 2400----------
total loss 0.9977852702140808
loss_r_feature 4.487954616546631
main criterion 0.007303657475858927
------------iteration 2500----------
total loss 0.8704774379730225
loss_r_feature 3.9023921489715576
main criterion 0.0019500848138704896
------------iteration 2600----------
total loss 0.7134549021720886
loss_r_feature 2.0170881748199463
main criterion 0.0017414333997294307
------------iteration 2700----------
total loss 0.6074134707450867
loss_r_feature 1.7998307943344116
main criterion 0.001074093277566135
------------iteration 2800----------
total loss 0.5304388999938965
loss_r_feature 1.8365846872329712
main criterion 0.0005438783555291593
------------iteration 2900----------
total loss 0.4494462311267853
loss_r_feature 1.2289389371871948
main criterion 0.0006951257237233222
------------iteration 3000----------
total loss 0.4520564675331116
loss_r_feature 1.4956027269363403
main criterion 0.000691463123075664
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_49', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=49, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 49 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.5220895409584045
loss_r_feature 2.27004075050354
main criterion 0.004300677217543125
------------iteration 200----------
total loss 0.5744977593421936
loss_r_feature 1.854321002960205
main criterion 0.03692132234573364
------------iteration 300----------
total loss 0.5141187906265259
loss_r_feature 1.836904764175415
main criterion 0.011194869875907898
------------iteration 400----------
total loss 0.5187071561813354
loss_r_feature 2.189893960952759
main criterion 0.014255157671868801
------------iteration 500----------
total loss 0.4660152494907379
loss_r_feature 1.7868000268936157
main criterion 0.0007198983803391457
------------iteration 600----------
total loss 0.47512632608413696
loss_r_feature 1.8468283414840698
main criterion 0.002650747774168849
------------iteration 700----------
total loss 0.47290802001953125
loss_r_feature 1.5764644145965576
main criterion 0.0353362038731575
------------iteration 800----------
total loss 0.4235880374908447
loss_r_feature 1.5706660747528076
main criterion 0.006218586582690477
------------iteration 900----------
total loss 0.3804261088371277
loss_r_feature 1.3468549251556396
main criterion 0.0007443353533744812
------------iteration 1000----------
total loss 0.3522273898124695
loss_r_feature 1.2067019939422607
main criterion 0.0007730553043074906
------------iteration 1100----------
total loss 0.3365269601345062
loss_r_feature 1.294788122177124
main criterion 0.0007608362357132137
------------iteration 1200----------
total loss 0.32996225357055664
loss_r_feature 1.7194360494613647
main criterion 0.0008824183605611324
------------iteration 1300----------
total loss 0.2965165972709656
loss_r_feature 1.5107131004333496
main criterion 0.0010530409635975957
------------iteration 1400----------
total loss 0.2562706768512726
loss_r_feature 1.1990745067596436
main criterion 0.00043721345718950033
------------iteration 1500----------
total loss 0.2197093665599823
loss_r_feature 0.9650647640228271
main criterion 0.00030102240270935
------------iteration 1600----------
total loss 0.19865760207176208
loss_r_feature 0.9549174308776855
main criterion 0.0005029707099311054
------------iteration 1700----------
total loss 0.16941308975219727
loss_r_feature 0.685802161693573
main criterion 0.00033929923665709794
------------iteration 1800----------
total loss 0.15123221278190613
loss_r_feature 0.5499195456504822
main criterion 0.00018218236800748855
------------iteration 1900----------
total loss 0.14182235300540924
loss_r_feature 0.4724644124507904
main criterion 0.00023671930830460042
------------iteration 2000----------
total loss 0.13791239261627197
loss_r_feature 0.41616305708885193
main criterion 0.00014422221283894032
------------iteration 2100----------
total loss 0.6702680587768555
loss_r_feature 1.7129745483398438
main criterion 0.001351568498648703
------------iteration 2200----------
total loss 0.7373275756835938
loss_r_feature 1.64985990524292
main criterion 0.0017626872286200523
------------iteration 2300----------
total loss 0.7196457982063293
loss_r_feature 1.4070080518722534
main criterion 0.0056434376165270805
------------iteration 2400----------
total loss 0.6613604426383972
loss_r_feature 1.635223150253296
main criterion 0.0017255919519811869
------------iteration 2500----------
total loss 0.6094279289245605
loss_r_feature 2.0726451873779297
main criterion 0.0025381387677043676
------------iteration 2600----------
total loss 0.48681631684303284
loss_r_feature 1.2792632579803467
main criterion 0.0005272205453366041
------------iteration 2700----------
total loss 0.41825157403945923
loss_r_feature 1.4448212385177612
main criterion 0.0003648728015832603
------------iteration 2800----------
total loss 0.3184511959552765
loss_r_feature 0.8490583896636963
main criterion 0.00031031997059471905
------------iteration 2900----------
total loss 0.2626100182533264
loss_r_feature 0.6449480056762695
main criterion 0.0003000148572027683
------------iteration 3000----------
total loss 0.2425425499677658
loss_r_feature 0.4432601034641266
main criterion 0.00029898155480623245
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_50', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=50, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 50 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.421857237815857
loss_r_feature 12.903467178344727
main criterion 0.31204715371131897
------------iteration 200----------
total loss 1.1351909637451172
loss_r_feature 9.51689624786377
main criterion 0.09491675347089767
------------iteration 300----------
total loss 1.7366389036178589
loss_r_feature 15.606895446777344
main criterion 0.38430941104888916
------------iteration 400----------
total loss 1.2893017530441284
loss_r_feature 12.822578430175781
main criterion 0.08218847215175629
------------iteration 500----------
total loss 0.9783671498298645
loss_r_feature 7.96577262878418
main criterion 0.016209382563829422
------------iteration 600----------
total loss 0.9629597067832947
loss_r_feature 7.4965643882751465
main criterion 0.03729838877916336
------------iteration 700----------
total loss 0.8983094096183777
loss_r_feature 7.048590183258057
main criterion 0.002963338978588581
------------iteration 800----------
total loss 1.005582571029663
loss_r_feature 8.407829284667969
main criterion 0.052218079566955566
------------iteration 900----------
total loss 0.8479682803153992
loss_r_feature 6.420530319213867
main criterion 0.004519368056207895
------------iteration 1000----------
total loss 0.7886300086975098
loss_r_feature 5.524625778198242
main criterion 0.006395853590220213
------------iteration 1100----------
total loss 0.7586652040481567
loss_r_feature 5.282607078552246
main criterion 0.01295750867575407
------------iteration 1200----------
total loss 0.6800869107246399
loss_r_feature 4.449578285217285
main criterion 0.0026546448934823275
------------iteration 1300----------
total loss 0.8145606517791748
loss_r_feature 7.540600776672363
main criterion 0.003256960539147258
------------iteration 1400----------
total loss 0.73421710729599
loss_r_feature 6.423683166503906
main criterion 0.0040138415060937405
------------iteration 1500----------
total loss 0.5916336178779602
loss_r_feature 4.036433219909668
main criterion 0.0026029651053249836
------------iteration 1600----------
total loss 0.50594562292099
loss_r_feature 2.7468159198760986
main criterion 0.002330827759578824
------------iteration 1700----------
total loss 0.47798189520835876
loss_r_feature 2.5207643508911133
main criterion 0.0021766226273030043
------------iteration 1800----------
total loss 0.4517129361629486
loss_r_feature 2.231414318084717
main criterion 0.0013388812076300383
------------iteration 1900----------
total loss 0.4817602038383484
loss_r_feature 2.9279520511627197
main criterion 0.0015542017063125968
------------iteration 2000----------
total loss 0.4541992247104645
loss_r_feature 2.404928207397461
main criterion 0.00105731759686023
------------iteration 2100----------
total loss 1.407494306564331
loss_r_feature 10.212047576904297
main criterion 0.00706253107637167
------------iteration 2200----------
total loss 1.4375653266906738
loss_r_feature 7.060673713684082
main criterion 0.021217133849859238
------------iteration 2300----------
total loss 1.5716288089752197
loss_r_feature 10.136974334716797
main criterion 0.004884312395006418
------------iteration 2400----------
total loss 1.4548518657684326
loss_r_feature 8.537416458129883
main criterion 0.017001667991280556
------------iteration 2500----------
total loss 1.242819905281067
loss_r_feature 5.589425563812256
main criterion 0.009969635866582394
------------iteration 2600----------
total loss 1.142377257347107
loss_r_feature 4.8404717445373535
main criterion 0.010409817099571228
------------iteration 2700----------
total loss 1.151013731956482
loss_r_feature 7.1541748046875
main criterion 0.001842912519350648
------------iteration 2800----------
total loss 0.8662344813346863
loss_r_feature 2.7569034099578857
main criterion 0.0021885670721530914
------------iteration 2900----------
total loss 0.8327180743217468
loss_r_feature 3.090351104736328
main criterion 0.0017787301912903786
------------iteration 3000----------
total loss 0.7754812836647034
loss_r_feature 2.1147549152374268
main criterion 0.0022303953301161528
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_51', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=51, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 51 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8814654350280762
loss_r_feature 7.162255764007568
main criterion 0.061832576990127563
------------iteration 200----------
total loss 0.9992854595184326
loss_r_feature 7.266261100769043
main criterion 0.07580963522195816
------------iteration 300----------
total loss 0.7912346720695496
loss_r_feature 4.336087226867676
main criterion 0.02175913192331791
------------iteration 400----------
total loss 0.8264390826225281
loss_r_feature 5.260543346405029
main criterion 0.007101430557668209
------------iteration 500----------
total loss 0.7743139863014221
loss_r_feature 4.4235734939575195
main criterion 0.004193400498479605
------------iteration 600----------
total loss 0.7352532744407654
loss_r_feature 3.8037145137786865
main criterion 0.004196829162538052
------------iteration 700----------
total loss 0.742291271686554
loss_r_feature 3.888561248779297
main criterion 0.017149459570646286
------------iteration 800----------
total loss 0.7171304225921631
loss_r_feature 3.9068026542663574
main criterion 0.01676064357161522
------------iteration 900----------
total loss 0.7436971068382263
loss_r_feature 3.5969481468200684
main criterion 0.07067850977182388
------------iteration 1000----------
total loss 0.6045437455177307
loss_r_feature 2.6168670654296875
main criterion 0.009455841034650803
------------iteration 1100----------
total loss 0.789296567440033
loss_r_feature 6.334781169891357
main criterion 0.029757747426629066
------------iteration 1200----------
total loss 0.5891304016113281
loss_r_feature 3.542287826538086
main criterion 0.003272253554314375
------------iteration 1300----------
total loss 0.5239733457565308
loss_r_feature 2.719116687774658
main criterion 0.0018519014120101929
------------iteration 1400----------
total loss 0.45737093687057495
loss_r_feature 2.050079345703125
main criterion 0.0019546132534742355
------------iteration 1500----------
total loss 0.4262181520462036
loss_r_feature 2.0058491230010986
main criterion 0.001905551296658814
------------iteration 1600----------
total loss 0.45812907814979553
loss_r_feature 3.0920040607452393
main criterion 0.0022174748592078686
------------iteration 1700----------
total loss 0.35977038741111755
loss_r_feature 1.5104234218597412
main criterion 0.001605197205208242
------------iteration 1800----------
total loss 0.33566269278526306
loss_r_feature 1.278610110282898
main criterion 0.0015735727502033114
------------iteration 1900----------
total loss 0.32682332396507263
loss_r_feature 1.2202610969543457
main criterion 0.001722718239761889
------------iteration 2000----------
total loss 0.3342631757259369
loss_r_feature 1.395075798034668
main criterion 0.0014224869664758444
------------iteration 2100----------
total loss 1.1661529541015625
loss_r_feature 5.315589904785156
main criterion 0.0071539441123604774
------------iteration 2200----------
total loss 1.206121563911438
loss_r_feature 3.3845276832580566
main criterion 0.00762404128909111
------------iteration 2300----------
total loss 1.2784852981567383
loss_r_feature 5.5206451416015625
main criterion 0.006515634246170521
------------iteration 2400----------
total loss 1.3989609479904175
loss_r_feature 8.51469898223877
main criterion 0.006562443915754557
------------iteration 2500----------
total loss 1.082071304321289
loss_r_feature 3.8524630069732666
main criterion 0.004739185329526663
------------iteration 2600----------
total loss 0.9694688320159912
loss_r_feature 3.068458080291748
main criterion 0.008595765568315983
------------iteration 2700----------
total loss 0.8641738295555115
loss_r_feature 3.071964979171753
main criterion 0.003222986590117216
------------iteration 2800----------
total loss 0.7707403898239136
loss_r_feature 2.920497417449951
main criterion 0.0025917794555425644
------------iteration 2900----------
total loss 0.6480563879013062
loss_r_feature 1.5095901489257812
main criterion 0.0017489783931523561
------------iteration 3000----------
total loss 0.6389537453651428
loss_r_feature 1.5120683908462524
main criterion 0.0028834466356784105
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50_SIN.pth.tar', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp2_layer_52', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=52, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,24,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
==> Resuming from checkpoint..
=> loading checkpoint './resnet50_SIN.pth.tar'
=> loaded checkpoint './resnet50_SIN.pth.tar' (epoch 60)
Deep inversion class generation
Confirming BN layer 52 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.671051025390625
loss_r_feature 2.8710551261901855
main criterion 0.08030620217323303
------------iteration 200----------
total loss 0.683147132396698
loss_r_feature 2.1051270961761475
main criterion 0.07206879556179047
------------iteration 300----------
total loss 0.6326659917831421
loss_r_feature 2.208847999572754
main criterion 0.050168294459581375
------------iteration 400----------
total loss 0.6284334063529968
loss_r_feature 2.1692702770233154
main criterion 0.08799616247415543
------------iteration 500----------
total loss 0.5296668410301208
loss_r_feature 1.8847942352294922
main criterion 0.004028514958918095
------------iteration 600----------
total loss 0.5138633847236633
loss_r_feature 2.0006494522094727
main criterion 0.0034206449054181576
------------iteration 700----------
total loss 0.4875430762767792
loss_r_feature 1.8066821098327637
main criterion 0.009404073469340801
------------iteration 800----------
total loss 0.4741782546043396
loss_r_feature 1.9901728630065918
main criterion 0.018497340381145477
------------iteration 900----------
total loss 0.4337671101093292
loss_r_feature 1.6984970569610596
main criterion 0.00395577447488904
------------iteration 1000----------
total loss 0.38006842136383057
loss_r_feature 1.287482738494873
main criterion 0.0013682125136256218
------------iteration 1100----------
total loss 0.3654840588569641
loss_r_feature 1.5945439338684082
main criterion 0.002422029385343194
------------iteration 1200----------
total loss 0.3338680863380432
loss_r_feature 1.4698612689971924
main criterion 0.0019418408628553152
------------iteration 1300----------
total loss 0.31201139092445374
loss_r_feature 1.581909418106079
main criterion 0.001448925118893385
------------iteration 1400----------
total loss 0.26441431045532227
loss_r_feature 1.2136890888214111
main criterion 0.0006674479227513075
------------iteration 1500----------
total loss 0.24692142009735107
loss_r_feature 1.3375129699707031
main criterion 0.0022164215333759785
------------iteration 1600----------
total loss 0.2102862447500229
loss_r_feature 1.0577747821807861
main criterion 0.0009688526624813676
------------iteration 1700----------
total loss 0.18178506195545197
loss_r_feature 0.828279972076416
main criterion 0.0007474222802557051
------------iteration 1800----------
total loss 0.16275954246520996
loss_r_feature 0.6767377853393555
main criterion 0.0006699920631945133
------------iteration 1900----------
total loss 0.15520372986793518
loss_r_feature 0.6365517377853394
main criterion 0.0006085435743443668
------------iteration 2000----------
total loss 0.1512715369462967
loss_r_feature 0.5775295495986938
main criterion 0.0005321885691955686
------------iteration 2100----------
total loss 0.6990450620651245
loss_r_feature 1.6718347072601318
main criterion 0.006046448368579149
------------iteration 2200----------
total loss 0.7577692270278931
loss_r_feature 1.5231544971466064
main criterion 0.002765838522464037
------------iteration 2300----------
total loss 0.7146893739700317
loss_r_feature 1.5368479490280151
main criterion 0.0033966912887990475
------------iteration 2400----------
total loss 0.6679821610450745
loss_r_feature 1.6079106330871582
main criterion 0.004613145254552364
------------iteration 2500----------
total loss 0.5789564251899719
loss_r_feature 1.5113084316253662
main criterion 0.00538301095366478
------------iteration 2600----------
total loss 0.4896921217441559
loss_r_feature 1.3447774648666382
main criterion 0.0033488390035927296
------------iteration 2700----------
total loss 0.397346168756485
loss_r_feature 1.227793574333191
main criterion 0.0011912884656339884
------------iteration 2800----------
total loss 0.30747753381729126
loss_r_feature 0.8800077438354492
main criterion 0.0012043624883517623
------------iteration 2900----------
total loss 0.25622186064720154
loss_r_feature 0.7695537805557251
main criterion 0.0011653041001409292
------------iteration 3000----------
total loss 0.24041131138801575
loss_r_feature 0.6524640917778015
main criterion 0.0012129565002396703
