Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_1', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=1, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 1 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.79805850982666
loss_r_feature 35.618404388427734
main criterion 0.6031619310379028
------------iteration 200----------
total loss 2.563873529434204
loss_r_feature 38.28391647338867
main criterion 0.23201601207256317
------------iteration 300----------
total loss 1.7708178758621216
loss_r_feature 27.20319938659668
main criterion 0.06058313325047493
------------iteration 400----------
total loss 1.708665132522583
loss_r_feature 22.290576934814453
main criterion 0.2762199342250824
------------iteration 500----------
total loss 1.4946054220199585
loss_r_feature 23.528940200805664
main criterion 0.001324877724982798
------------iteration 600----------
total loss 1.3130908012390137
loss_r_feature 19.19114112854004
main criterion 0.06880350410938263
------------iteration 700----------
total loss 0.9090926647186279
loss_r_feature 13.220869064331055
main criterion 0.008549876511096954
------------iteration 800----------
total loss 0.6114327907562256
loss_r_feature 8.327523231506348
main criterion 0.004187746439129114
------------iteration 900----------
total loss 0.4391700327396393
loss_r_feature 5.497637748718262
main criterion 0.0010966708650812507
------------iteration 1000----------
total loss 0.3452521860599518
loss_r_feature 3.805307388305664
main criterion 0.0007045972160995007
------------iteration 1100----------
total loss 0.31750574707984924
loss_r_feature 3.250771999359131
main criterion 0.0005724232760258019
------------iteration 1200----------
total loss 0.28464579582214355
loss_r_feature 1.765426516532898
main criterion 0.049072425812482834
------------iteration 1300----------
total loss 0.21909785270690918
loss_r_feature 1.5380226373672485
main criterion 7.106531847966835e-05
------------iteration 1400----------
total loss 0.18103402853012085
loss_r_feature 0.859988808631897
main criterion 0.0001230737689184025
------------iteration 1500----------
total loss 0.15754912793636322
loss_r_feature 0.4632297456264496
main criterion 0.0001197822202811949
------------iteration 1600----------
total loss 0.17360249161720276
loss_r_feature 0.8282147645950317
main criterion 2.5279634428443387e-05
------------iteration 1700----------
total loss 0.1562826931476593
loss_r_feature 0.524935781955719
main criterion 3.421186193008907e-05
------------iteration 1800----------
total loss 0.14271073043346405
loss_r_feature 0.2628330886363983
main criterion 1.9835915736621246e-05
------------iteration 1900----------
total loss 0.14002525806427002
loss_r_feature 0.2177571952342987
main criterion 1.880877789517399e-05
------------iteration 2000----------
total loss 0.13968226313591003
loss_r_feature 0.20872317254543304
main criterion 1.5181775779637974e-05
------------iteration 2100----------
total loss 0.516250491142273
loss_r_feature 3.751746416091919
main criterion 0.00039934401866048574
------------iteration 2200----------
total loss 0.46697238087654114
loss_r_feature 3.2370429039001465
main criterion 0.00013378636504057795
------------iteration 2300----------
total loss 0.36996957659721375
loss_r_feature 2.040938377380371
main criterion 0.0001515790936537087
------------iteration 2400----------
total loss 0.35032323002815247
loss_r_feature 1.777652382850647
main criterion 0.000217961409362033
------------iteration 2500----------
total loss 0.3008224368095398
loss_r_feature 0.9668505787849426
main criterion 6.716244388371706e-05
------------iteration 2600----------
total loss 0.31833362579345703
loss_r_feature 1.4966533184051514
main criterion 6.309466698439792e-05
------------iteration 2700----------
total loss 0.27779871225357056
loss_r_feature 0.7491000890731812
main criterion 1.755743141984567e-05
------------iteration 2800----------
total loss 0.29196810722351074
loss_r_feature 1.0006568431854248
main criterion 5.7498778915032744e-05
------------iteration 2900----------
total loss 0.27174946665763855
loss_r_feature 0.6449337005615234
main criterion 4.1843166400212795e-05
------------iteration 3000----------
total loss 0.24921151995658875
loss_r_feature 0.22914431989192963
main criterion 4.167031147517264e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_2', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=2, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 2 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.7032347917556763
loss_r_feature 20.303321838378906
main criterion 0.2639058828353882
------------iteration 200----------
total loss 1.5480144023895264
loss_r_feature 20.698728561401367
main criterion 0.06420939415693283
------------iteration 300----------
total loss 1.260735273361206
loss_r_feature 17.33002281188965
main criterion 0.004670916590839624
------------iteration 400----------
total loss 1.0926411151885986
loss_r_feature 14.667960166931152
main criterion 0.00794305745512247
------------iteration 500----------
total loss 0.9653334021568298
loss_r_feature 12.91396713256836
main criterion 0.004352692048996687
------------iteration 600----------
total loss 0.7563377618789673
loss_r_feature 9.887078285217285
main criterion 0.007305932231247425
------------iteration 700----------
total loss 0.7924103140830994
loss_r_feature 8.32929515838623
main criterion 0.14092713594436646
------------iteration 800----------
total loss 0.5557931065559387
loss_r_feature 6.913710117340088
main criterion 0.0035131354816257954
------------iteration 900----------
total loss 0.5108099579811096
loss_r_feature 6.461905479431152
main criterion 0.0011894614435732365
------------iteration 1000----------
total loss 0.30491435527801514
loss_r_feature 3.3810555934906006
main criterion 0.0002533847000449896
------------iteration 1100----------
total loss 0.3183968961238861
loss_r_feature 3.536634922027588
main criterion 0.0005434196791611612
------------iteration 1200----------
total loss 0.2715144753456116
loss_r_feature 2.9147820472717285
main criterion 0.0002370307920500636
------------iteration 1300----------
total loss 0.20950642228126526
loss_r_feature 1.9147405624389648
main criterion 4.299183638067916e-05
------------iteration 1400----------
total loss 0.203905388712883
loss_r_feature 1.9188549518585205
main criterion 0.00013192501501180232
------------iteration 1500----------
total loss 0.19558633863925934
loss_r_feature 1.7843133211135864
main criterion 0.00011717392044374719
------------iteration 1600----------
total loss 0.19037187099456787
loss_r_feature 1.7424678802490234
main criterion 4.838987297262065e-05
------------iteration 1700----------
total loss 0.16043461859226227
loss_r_feature 1.18955659866333
main criterion 7.52651467337273e-05
------------iteration 1800----------
total loss 0.14782145619392395
loss_r_feature 0.9610310792922974
main criterion 5.0876446039183065e-05
------------iteration 1900----------
total loss 0.14307217299938202
loss_r_feature 0.8797547221183777
main criterion 5.360096838558093e-05
------------iteration 2000----------
total loss 0.1418011337518692
loss_r_feature 0.8571258187294006
main criterion 4.322496533859521e-05
------------iteration 2100----------
total loss 0.8487302660942078
loss_r_feature 7.722221374511719
main criterion 0.0037921902257949114
------------iteration 2200----------
total loss 0.45821499824523926
loss_r_feature 3.782212257385254
main criterion 0.0004471084685064852
------------iteration 2300----------
total loss 0.4784744381904602
loss_r_feature 3.3906219005584717
main criterion 0.030854366719722748
------------iteration 2400----------
total loss 0.44244104623794556
loss_r_feature 3.2228941917419434
main criterion 0.0004074868047609925
------------iteration 2500----------
total loss 0.2650315463542938
loss_r_feature 1.664428949356079
main criterion 0.00015011578216217458
------------iteration 2600----------
total loss 0.24127140641212463
loss_r_feature 1.2912390232086182
main criterion 0.00011737240856746212
------------iteration 2700----------
total loss 0.2353145182132721
loss_r_feature 1.3273372650146484
main criterion 5.049980973126367e-05
------------iteration 2800----------
total loss 0.216175839304924
loss_r_feature 1.1257305145263672
main criterion 9.503946057520807e-05
------------iteration 2900----------
total loss 0.21293865144252777
loss_r_feature 1.1001774072647095
main criterion 9.989672980736941e-05
------------iteration 3000----------
total loss 0.19739298522472382
loss_r_feature 0.8137789964675903
main criterion 0.00011713147250702605
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_3', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=3, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 3 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.8593761920928955
loss_r_feature 9.970072746276855
main criterion 0.94440096616745
------------iteration 200----------
total loss 1.1781389713287354
loss_r_feature 10.662327766418457
main criterion 0.19433455169200897
------------iteration 300----------
total loss 0.9094634056091309
loss_r_feature 9.137940406799316
main criterion 0.05268250033259392
------------iteration 400----------
total loss 0.803735077381134
loss_r_feature 7.23430061340332
main criterion 0.09871526807546616
------------iteration 500----------
total loss 0.7823711633682251
loss_r_feature 7.286188125610352
main criterion 0.09967230260372162
------------iteration 600----------
total loss 0.6666811108589172
loss_r_feature 6.9367876052856445
main criterion 0.0105602340772748
------------iteration 700----------
total loss 0.5498992800712585
loss_r_feature 5.693517208099365
main criterion 0.00135277328081429
------------iteration 800----------
total loss 0.39649444818496704
loss_r_feature 3.7080252170562744
main criterion 0.018545743077993393
------------iteration 900----------
total loss 0.3434908092021942
loss_r_feature 3.22365403175354
main criterion 0.00021602818742394447
------------iteration 1000----------
total loss 0.2792322635650635
loss_r_feature 2.3091869354248047
main criterion 0.00032946091960184276
------------iteration 1100----------
total loss 0.20269103348255157
loss_r_feature 1.4946800470352173
main criterion 0.00019473012071102858
------------iteration 1200----------
total loss 0.1930830031633377
loss_r_feature 1.2755343914031982
main criterion 0.00013234077778179199
------------iteration 1300----------
total loss 0.16094157099723816
loss_r_feature 1.1048846244812012
main criterion 0.0001651226484682411
------------iteration 1400----------
total loss 0.14503519237041473
loss_r_feature 0.9600904583930969
main criterion 0.00010455115989316255
------------iteration 1500----------
total loss 0.13664144277572632
loss_r_feature 0.9216857552528381
main criterion 0.00019909220281988382
------------iteration 1600----------
total loss 0.13129565119743347
loss_r_feature 0.8969074487686157
main criterion 3.44720137945842e-05
------------iteration 1700----------
total loss 0.12273520231246948
loss_r_feature 0.7358589768409729
main criterion 4.624779103323817e-05
------------iteration 1800----------
total loss 0.1165056824684143
loss_r_feature 0.6512803435325623
main criterion 2.691471490834374e-05
------------iteration 1900----------
total loss 0.11378087103366852
loss_r_feature 0.6080207824707031
main criterion 4.433174035511911e-05
------------iteration 2000----------
total loss 0.11342921853065491
loss_r_feature 0.6041246652603149
main criterion 3.2014839234761894e-05
------------iteration 2100----------
total loss 0.7276522517204285
loss_r_feature 3.452913761138916
main criterion 0.1140766367316246
------------iteration 2200----------
total loss 0.5433219075202942
loss_r_feature 2.8626937866210938
main criterion 0.03190883621573448
------------iteration 2300----------
total loss 0.330201655626297
loss_r_feature 1.6133325099945068
main criterion 0.00027150550158694386
------------iteration 2400----------
total loss 0.3016040623188019
loss_r_feature 1.473035216331482
main criterion 0.00125882588326931
------------iteration 2500----------
total loss 0.2743450105190277
loss_r_feature 1.4052664041519165
main criterion 0.00021917193953413516
------------iteration 2600----------
total loss 0.2151772677898407
loss_r_feature 1.4482429027557373
main criterion 0.00015027254994492978
------------iteration 2700----------
total loss 0.19844800233840942
loss_r_feature 1.2490025758743286
main criterion 5.374892134568654e-05
------------iteration 2800----------
total loss 0.178016796708107
loss_r_feature 1.0751434564590454
main criterion 0.00010715617827372625
------------iteration 2900----------
total loss 0.16581204533576965
loss_r_feature 0.7740236520767212
main criterion 0.0001035468521877192
------------iteration 3000----------
total loss 0.16249434649944305
loss_r_feature 0.7074686884880066
main criterion 0.00011132835788885131
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_4', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=4, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 4 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.9976720809936523
loss_r_feature 38.24671936035156
main criterion 0.675427258014679
------------iteration 200----------
total loss 2.304802894592285
loss_r_feature 36.38017654418945
main criterion 0.08550146967172623
------------iteration 300----------
total loss 2.3567111492156982
loss_r_feature 32.003700256347656
main criterion 0.3861762583255768
------------iteration 400----------
total loss 1.8507908582687378
loss_r_feature 28.798080444335938
main criterion 0.06490711122751236
------------iteration 500----------
total loss 1.5100469589233398
loss_r_feature 23.890172958374023
main criterion 0.003670924575999379
------------iteration 600----------
total loss 1.2683159112930298
loss_r_feature 19.60354232788086
main criterion 0.006240736693143845
------------iteration 700----------
total loss 1.1130144596099854
loss_r_feature 17.158309936523438
main criterion 0.0018193833529949188
------------iteration 800----------
total loss 0.7191751003265381
loss_r_feature 10.257535934448242
main criterion 0.003268525470048189
------------iteration 900----------
total loss 0.7520368695259094
loss_r_feature 10.77276611328125
main criterion 0.008593030273914337
------------iteration 1000----------
total loss 0.6337806582450867
loss_r_feature 8.861259460449219
main criterion 0.0007159843808040023
------------iteration 1100----------
total loss 0.3501927852630615
loss_r_feature 3.654801845550537
main criterion 0.0011495612561702728
------------iteration 1200----------
total loss 0.29557886719703674
loss_r_feature 2.59574031829834
main criterion 0.00020073815539944917
------------iteration 1300----------
total loss 0.2453269362449646
loss_r_feature 1.7323055267333984
main criterion 0.0001857403403846547
------------iteration 1400----------
total loss 0.21598652005195618
loss_r_feature 1.3471484184265137
main criterion 7.530090806540102e-05
------------iteration 1500----------
total loss 0.2010265588760376
loss_r_feature 1.1088347434997559
main criterion 5.089255500934087e-05
------------iteration 1600----------
total loss 0.20114077627658844
loss_r_feature 1.1609132289886475
main criterion 3.409273995202966e-05
------------iteration 1700----------
total loss 0.17871597409248352
loss_r_feature 0.7444996237754822
main criterion 1.5457091649295762e-05
------------iteration 1800----------
total loss 0.17009472846984863
loss_r_feature 0.5961424112319946
main criterion 1.8797700249706395e-05
------------iteration 1900----------
total loss 0.16522623598575592
loss_r_feature 0.5099905133247375
main criterion 1.778737896529492e-05
------------iteration 2000----------
total loss 0.16468900442123413
loss_r_feature 0.5018224716186523
main criterion 1.5076837371452712e-05
------------iteration 2100----------
total loss 0.5227983593940735
loss_r_feature 3.724626064300537
main criterion 0.005969169549643993
------------iteration 2200----------
total loss 0.5807971954345703
loss_r_feature 4.62338399887085
main criterion 0.0302127655595541
------------iteration 2300----------
total loss 0.41795089840888977
loss_r_feature 3.0006418228149414
main criterion 0.0002603442990221083
------------iteration 2400----------
total loss 0.3959812521934509
loss_r_feature 2.6912426948547363
main criterion 0.0002550529607106
------------iteration 2500----------
total loss 0.34646767377853394
loss_r_feature 1.9143240451812744
main criterion 7.170455501182005e-05
------------iteration 2600----------
total loss 0.31688228249549866
loss_r_feature 1.3678807020187378
main criterion 4.920836727251299e-05
------------iteration 2700----------
total loss 0.3156251609325409
loss_r_feature 1.4459521770477295
main criterion 2.703649442992173e-05
------------iteration 2800----------
total loss 0.302330881357193
loss_r_feature 1.3749864101409912
main criterion 7.331612141570076e-05
------------iteration 2900----------
total loss 0.2677358090877533
loss_r_feature 0.5835629105567932
main criterion 3.180787098244764e-05
------------iteration 3000----------
total loss 0.2518981993198395
loss_r_feature 0.2948230504989624
main criterion 4.583378176903352e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_5', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=5, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 5 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.9717453718185425
loss_r_feature 14.100204467773438
main criterion 0.8269214630126953
------------iteration 200----------
total loss 1.2255972623825073
loss_r_feature 14.974754333496094
main criterion 0.014184325933456421
------------iteration 300----------
total loss 1.1570004224777222
loss_r_feature 12.146875381469727
main criterion 0.1522810459136963
------------iteration 400----------
total loss 1.0280158519744873
loss_r_feature 12.3545503616333
main criterion 0.025025133043527603
------------iteration 500----------
total loss 1.0303750038146973
loss_r_feature 10.777986526489258
main criterion 0.1460341215133667
------------iteration 600----------
total loss 0.8990653157234192
loss_r_feature 10.363288879394531
main criterion 0.038480959832668304
------------iteration 700----------
total loss 0.6725488305091858
loss_r_feature 7.908255577087402
main criterion 0.0017915733624249697
------------iteration 800----------
total loss 0.5826302766799927
loss_r_feature 6.4120774269104
main criterion 0.009205345995724201
------------iteration 900----------
total loss 0.37398508191108704
loss_r_feature 3.7546281814575195
main criterion 0.0006157244206406176
------------iteration 1000----------
total loss 0.3440779149532318
loss_r_feature 3.562419891357422
main criterion 0.00034610266447998583
------------iteration 1100----------
total loss 0.2359258532524109
loss_r_feature 1.9794844388961792
main criterion 0.0008835147600620985
------------iteration 1200----------
total loss 0.2047940045595169
loss_r_feature 1.8209946155548096
main criterion 0.00025136503973044455
------------iteration 1300----------
total loss 0.19015368819236755
loss_r_feature 1.67923104763031
main criterion 8.103985601337627e-05
------------iteration 1400----------
total loss 0.163992777466774
loss_r_feature 1.3830655813217163
main criterion 7.839599857106805e-05
------------iteration 1500----------
total loss 0.15106599032878876
loss_r_feature 1.2374264001846313
main criterion 3.707706491695717e-05
------------iteration 1600----------
total loss 0.13980670273303986
loss_r_feature 1.0982577800750732
main criterion 4.061572326463647e-05
------------iteration 1700----------
total loss 0.12559102475643158
loss_r_feature 0.8457225561141968
main criterion 4.164522033534013e-05
------------iteration 1800----------
total loss 0.11797435581684113
loss_r_feature 0.721958577632904
main criterion 2.0824047169298865e-05
------------iteration 1900----------
total loss 0.11469259858131409
loss_r_feature 0.672614336013794
main criterion 3.6690154956886545e-05
------------iteration 2000----------
total loss 0.11461564153432846
loss_r_feature 0.6721634864807129
main criterion 2.9798231480526738e-05
------------iteration 2100----------
total loss 0.6006340980529785
loss_r_feature 3.9670968055725098
main criterion 0.0363442599773407
------------iteration 2200----------
total loss 0.5763579607009888
loss_r_feature 4.143518924713135
main criterion 0.0012659365311264992
------------iteration 2300----------
total loss 0.36060428619384766
loss_r_feature 2.7458572387695312
main criterion 0.0002915955556090921
------------iteration 2400----------
total loss 0.3862781226634979
loss_r_feature 3.270153045654297
main criterion 0.0008617670391686261
------------iteration 2500----------
total loss 0.2896302342414856
loss_r_feature 2.470808982849121
main criterion 0.00010882233618758619
------------iteration 2600----------
total loss 0.2633613049983978
loss_r_feature 2.1915721893310547
main criterion 0.00014166456821840256
------------iteration 2700----------
total loss 0.23927579820156097
loss_r_feature 1.945115327835083
main criterion 9.051049710251391e-05
------------iteration 2800----------
total loss 0.19464939832687378
loss_r_feature 1.1734716892242432
main criterion 0.00010148662840947509
------------iteration 2900----------
total loss 0.18425296247005463
loss_r_feature 0.9985746145248413
main criterion 9.330528700957075e-05
------------iteration 3000----------
total loss 0.18110935389995575
loss_r_feature 0.9610947370529175
main criterion 0.00011919637472601607
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_6', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=6, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 6 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0785913467407227
loss_r_feature 6.558650016784668
main criterion 0.3529420495033264
------------iteration 200----------
total loss 0.8076720237731934
loss_r_feature 6.838357925415039
main criterion 0.004443712532520294
------------iteration 300----------
total loss 0.746435821056366
loss_r_feature 5.560912132263184
main criterion 0.05309199169278145
------------iteration 400----------
total loss 0.6286923289299011
loss_r_feature 4.9501729011535645
main criterion 0.0008074225042946637
------------iteration 500----------
total loss 0.56244295835495
loss_r_feature 4.569032669067383
main criterion 0.0007231844938360155
------------iteration 600----------
total loss 0.495920866727829
loss_r_feature 3.826918840408325
main criterion 0.0034695810172706842
------------iteration 700----------
total loss 0.48828640580177307
loss_r_feature 3.8669939041137695
main criterion 0.0014633049722760916
------------iteration 800----------
total loss 0.8144824504852295
loss_r_feature 3.7894768714904785
main criterion 0.3539864420890808
------------iteration 900----------
total loss 0.37909945845603943
loss_r_feature 3.030071496963501
main criterion 0.0013583023101091385
------------iteration 1000----------
total loss 0.28098851442337036
loss_r_feature 2.268861770629883
main criterion 0.0006100577302277088
------------iteration 1100----------
total loss 0.2814588248729706
loss_r_feature 2.3122756481170654
main criterion 0.00018190068658441305
------------iteration 1200----------
total loss 0.21164192259311676
loss_r_feature 1.6626677513122559
main criterion 0.0013786627678200603
------------iteration 1300----------
total loss 0.14326904714107513
loss_r_feature 1.028570532798767
main criterion 0.00016680678527336568
------------iteration 1400----------
total loss 0.12149029970169067
loss_r_feature 0.8858859539031982
main criterion 6.574617873411626e-05
------------iteration 1500----------
total loss 0.10125451534986496
loss_r_feature 0.7443055510520935
main criterion 0.00011718482710421085
------------iteration 1600----------
total loss 0.08784327656030655
loss_r_feature 0.6429499983787537
main criterion 3.299858144600876e-05
------------iteration 1700----------
total loss 0.07844166457653046
loss_r_feature 0.5169055461883545
main criterion 4.463225195650011e-05
------------iteration 1800----------
total loss 0.07350612431764603
loss_r_feature 0.4653269648551941
main criterion 3.136712984996848e-05
------------iteration 1900----------
total loss 0.07029645144939423
loss_r_feature 0.4283519983291626
main criterion 4.44910183432512e-05
------------iteration 2000----------
total loss 0.06988027691841125
loss_r_feature 0.42544230818748474
main criterion 2.337266232643742e-05
------------iteration 2100----------
total loss 0.6921625137329102
loss_r_feature 3.2573139667510986
main criterion 0.04160379618406296
------------iteration 2200----------
total loss 0.6174993515014648
loss_r_feature 3.2545814514160156
main criterion 0.00042300927452743053
------------iteration 2300----------
total loss 0.4762687385082245
loss_r_feature 2.361485719680786
main criterion 0.0009095382411032915
------------iteration 2400----------
total loss 0.32828471064567566
loss_r_feature 1.917190670967102
main criterion 0.0007139437366276979
------------iteration 2500----------
total loss 0.2699941396713257
loss_r_feature 1.389567255973816
main criterion 0.0001943790994118899
------------iteration 2600----------
total loss 0.2182212769985199
loss_r_feature 1.388352870941162
main criterion 0.0004862216883338988
------------iteration 2700----------
total loss 0.1674657016992569
loss_r_feature 1.3923916816711426
main criterion 6.511089304694906e-05
------------iteration 2800----------
total loss 0.13531608879566193
loss_r_feature 0.948897123336792
main criterion 6.132343696663156e-05
------------iteration 2900----------
total loss 0.11017351597547531
loss_r_feature 0.5771016478538513
main criterion 0.00010847977682715282
------------iteration 3000----------
total loss 0.10566771030426025
loss_r_feature 0.5229933261871338
main criterion 7.279818237293512e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_7', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=7, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 7 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2403664588928223
loss_r_feature 3.500216484069824
main criterion 0.6704535484313965
------------iteration 200----------
total loss 0.7994834184646606
loss_r_feature 4.049738883972168
main criterion 0.13284674286842346
------------iteration 300----------
total loss 0.683283805847168
loss_r_feature 3.7704455852508545
main criterion 0.04981836676597595
------------iteration 400----------
total loss 0.5824812054634094
loss_r_feature 3.2769203186035156
main criterion 0.005924222059547901
------------iteration 500----------
total loss 0.6467117071151733
loss_r_feature 2.8943729400634766
main criterion 0.13146603107452393
------------iteration 600----------
total loss 0.47297757863998413
loss_r_feature 2.3917808532714844
main criterion 0.02060602605342865
------------iteration 700----------
total loss 0.3791269361972809
loss_r_feature 1.9736552238464355
main criterion 0.0010909748962149024
------------iteration 800----------
total loss 0.4022639989852905
loss_r_feature 1.8884336948394775
main criterion 0.04372120276093483
------------iteration 900----------
total loss 0.32464680075645447
loss_r_feature 1.8183400630950928
main criterion 0.0008147187763825059
------------iteration 1000----------
total loss 0.26714739203453064
loss_r_feature 1.405584692955017
main criterion 0.014053109101951122
------------iteration 1100----------
total loss 0.2122243344783783
loss_r_feature 1.1531779766082764
main criterion 0.00013786961790174246
------------iteration 1200----------
total loss 0.1679488867521286
loss_r_feature 0.8540871143341064
main criterion 6.098159428802319e-05
------------iteration 1300----------
total loss 0.1279391348361969
loss_r_feature 0.7026554346084595
main criterion 7.278777047758922e-05
------------iteration 1400----------
total loss 0.09534165263175964
loss_r_feature 0.5078104734420776
main criterion 0.00026109835016541183
------------iteration 1500----------
total loss 0.08358543366193771
loss_r_feature 0.4865642786026001
main criterion 0.00023556957603432238
------------iteration 1600----------
total loss 0.07231650501489639
loss_r_feature 0.49273139238357544
main criterion 2.890652831410989e-05
------------iteration 1700----------
total loss 0.05638926848769188
loss_r_feature 0.34384387731552124
main criterion 8.010341844055802e-05
------------iteration 1800----------
total loss 0.05256218835711479
loss_r_feature 0.33810269832611084
main criterion 2.0035038687638007e-05
------------iteration 1900----------
total loss 0.04964836686849594
loss_r_feature 0.30760473012924194
main criterion 3.286653009126894e-05
------------iteration 2000----------
total loss 0.04946662485599518
loss_r_feature 0.3082292675971985
main criterion 2.177486749133095e-05
------------iteration 2100----------
total loss 0.8481054306030273
loss_r_feature 1.7862226963043213
main criterion 0.21788986027240753
------------iteration 2200----------
total loss 0.6384767889976501
loss_r_feature 1.8978811502456665
main criterion 0.02922751195728779
------------iteration 2300----------
total loss 0.5646382570266724
loss_r_feature 1.6953883171081543
main criterion 0.00984802283346653
------------iteration 2400----------
total loss 0.29622554779052734
loss_r_feature 1.0647908449172974
main criterion 0.0010573288891464472
------------iteration 2500----------
total loss 0.2615053653717041
loss_r_feature 0.8987057209014893
main criterion 0.0010640242835506797
------------iteration 2600----------
total loss 0.18048584461212158
loss_r_feature 0.6681633591651917
main criterion 0.00042797665810212493
------------iteration 2700----------
total loss 0.1221725344657898
loss_r_feature 0.5665329694747925
main criterion 5.310816050041467e-05
------------iteration 2800----------
total loss 0.08597709983587265
loss_r_feature 0.46872901916503906
main criterion 6.874081736896187e-05
------------iteration 2900----------
total loss 0.0765099972486496
loss_r_feature 0.40070757269859314
main criterion 9.586875967215747e-05
------------iteration 3000----------
total loss 0.07494903355836868
loss_r_feature 0.397656112909317
main criterion 0.00010232128261122853
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_8', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=8, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 8 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.4599500894546509
loss_r_feature 7.010479927062988
main criterion 0.6792041659355164
------------iteration 200----------
total loss 0.9707863926887512
loss_r_feature 7.88680362701416
main criterion 0.09643839299678802
------------iteration 300----------
total loss 0.8290281891822815
loss_r_feature 6.772418022155762
main criterion 0.05538439005613327
------------iteration 400----------
total loss 0.8237335681915283
loss_r_feature 5.886229515075684
main criterion 0.1370256543159485
------------iteration 500----------
total loss 0.70133376121521
loss_r_feature 6.129491329193115
main criterion 0.004983923397958279
------------iteration 600----------
total loss 0.5610732436180115
loss_r_feature 4.629270076751709
main criterion 0.004580301232635975
------------iteration 700----------
total loss 0.48601728677749634
loss_r_feature 3.9691147804260254
main criterion 0.0005333603476174176
------------iteration 800----------
total loss 0.4669213891029358
loss_r_feature 3.810995578765869
main criterion 0.008491991087794304
------------iteration 900----------
total loss 0.37908935546875
loss_r_feature 2.9969499111175537
main criterion 0.0005745585076510906
------------iteration 1000----------
total loss 0.2734978199005127
loss_r_feature 1.9351388216018677
main criterion 0.00015372569032479078
------------iteration 1100----------
total loss 0.23187024891376495
loss_r_feature 1.8583331108093262
main criterion 0.00016822616453282535
------------iteration 1200----------
total loss 0.1808401644229889
loss_r_feature 1.468374490737915
main criterion 5.7888057199306786e-05
------------iteration 1300----------
total loss 0.1744537204504013
loss_r_feature 1.592911720275879
main criterion 6.045709233148955e-05
------------iteration 1400----------
total loss 0.1533765196800232
loss_r_feature 1.5454238653182983
main criterion 8.847526623867452e-05
------------iteration 1500----------
total loss 0.132499560713768
loss_r_feature 1.2142581939697266
main criterion 0.00018533796537667513
------------iteration 1600----------
total loss 0.10575857013463974
loss_r_feature 0.8214638233184814
main criterion 5.065674122306518e-05
------------iteration 1700----------
total loss 0.09893933683633804
loss_r_feature 0.7573471069335938
main criterion 4.512478335527703e-05
------------iteration 1800----------
total loss 0.08668903261423111
loss_r_feature 0.5603209733963013
main criterion 2.5609115255065262e-05
------------iteration 1900----------
total loss 0.08128495514392853
loss_r_feature 0.4764682352542877
main criterion 4.298720887163654e-05
------------iteration 2000----------
total loss 0.08074363321065903
loss_r_feature 0.4693002998828888
main criterion 4.773880209540948e-05
------------iteration 2100----------
total loss 0.9465412497520447
loss_r_feature 3.4724416732788086
main criterion 0.26087838411331177
------------iteration 2200----------
total loss 0.5540066361427307
loss_r_feature 2.4612324237823486
main criterion 0.0004031965509057045
------------iteration 2300----------
total loss 0.5058236718177795
loss_r_feature 3.0414962768554688
main criterion 0.001995659898966551
------------iteration 2400----------
total loss 0.36955663561820984
loss_r_feature 2.2479567527770996
main criterion 0.0013846466317772865
------------iteration 2500----------
total loss 0.2922394871711731
loss_r_feature 2.4302151203155518
main criterion 0.00012056171544827521
------------iteration 2600----------
total loss 0.25749748945236206
loss_r_feature 2.259305238723755
main criterion 0.00010691850184230134
------------iteration 2700----------
total loss 0.16886427998542786
loss_r_feature 1.1479101181030273
main criterion 7.22368058632128e-05
------------iteration 2800----------
total loss 0.17152591049671173
loss_r_feature 1.4912545680999756
main criterion 9.778034291230142e-05
------------iteration 2900----------
total loss 0.12992706894874573
loss_r_feature 0.7829987406730652
main criterion 0.00010666174785001203
------------iteration 3000----------
total loss 0.12588390707969666
loss_r_feature 0.7361276149749756
main criterion 0.00011387184349587187
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_9', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=9, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 9 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7570769786834717
loss_r_feature 2.3911197185516357
main criterion 0.2315124124288559
------------iteration 200----------
total loss 0.8314254283905029
loss_r_feature 2.157386541366577
main criterion 0.26805809140205383
------------iteration 300----------
total loss 0.7004649043083191
loss_r_feature 1.6382756233215332
main criterion 0.2048260122537613
------------iteration 400----------
total loss 0.5927433967590332
loss_r_feature 1.3939064741134644
main criterion 0.13471053540706635
------------iteration 500----------
total loss 0.4692526161670685
loss_r_feature 1.603411316871643
main criterion 0.0010674083605408669
------------iteration 600----------
total loss 0.3830464780330658
loss_r_feature 1.0594806671142578
main criterion 0.0007020891061984003
------------iteration 700----------
total loss 0.3374095857143402
loss_r_feature 0.8901235461235046
main criterion 0.0003226347907911986
------------iteration 800----------
total loss 0.31142130494117737
loss_r_feature 0.7947653532028198
main criterion 0.0073290737345814705
------------iteration 900----------
total loss 0.2758054733276367
loss_r_feature 0.7252264618873596
main criterion 0.00028653527260757983
------------iteration 1000----------
total loss 0.22779659926891327
loss_r_feature 0.5567848682403564
main criterion 0.00012879488349426538
------------iteration 1100----------
total loss 0.18894562125205994
loss_r_feature 0.48432254791259766
main criterion 0.0049239289946854115
------------iteration 1200----------
total loss 0.15942060947418213
loss_r_feature 0.5827751159667969
main criterion 5.0439655751688406e-05
------------iteration 1300----------
total loss 0.13799314200878143
loss_r_feature 0.6269755363464355
main criterion 0.0028918751049786806
------------iteration 1400----------
total loss 0.11477876454591751
loss_r_feature 0.4553520083427429
main criterion 3.595298039726913e-05
------------iteration 1500----------
total loss 0.08255451172590256
loss_r_feature 0.32273566722869873
main criterion 0.0004992164904251695
------------iteration 1600----------
total loss 0.06474187225103378
loss_r_feature 0.25795814394950867
main criterion 2.404454062343575e-05
------------iteration 1700----------
total loss 0.057774968445301056
loss_r_feature 0.2609977722167969
main criterion 2.2714102669851854e-05
------------iteration 1800----------
total loss 0.047020383179187775
loss_r_feature 0.16072452068328857
main criterion 1.945001167769078e-05
------------iteration 1900----------
total loss 0.04338698834180832
loss_r_feature 0.12725068628787994
main criterion 2.7695243261405267e-05
------------iteration 2000----------
total loss 0.04291069507598877
loss_r_feature 0.12475576996803284
main criterion 2.4959010261227377e-05
------------iteration 2100----------
total loss 0.8455910086631775
loss_r_feature 1.9910321235656738
main criterion 0.025074081495404243
------------iteration 2200----------
total loss 0.5873671174049377
loss_r_feature 0.8686836957931519
main criterion 0.017937419936060905
------------iteration 2300----------
total loss 0.45679327845573425
loss_r_feature 0.8514362573623657
main criterion 0.0005500364350154996
------------iteration 2400----------
total loss 0.35683485865592957
loss_r_feature 0.732525110244751
main criterion 0.0010742347221821547
------------iteration 2500----------
total loss 0.2812473177909851
loss_r_feature 0.5650222897529602
main criterion 0.0004162078257650137
------------iteration 2600----------
total loss 0.20693179965019226
loss_r_feature 1.1514604091644287
main criterion 0.00013441582268569618
------------iteration 2700----------
total loss 0.14407294988632202
loss_r_feature 0.4654844105243683
main criterion 5.230564420344308e-05
------------iteration 2800----------
total loss 0.109070785343647
loss_r_feature 0.7307470440864563
main criterion 0.000135831069201231
------------iteration 2900----------
total loss 0.07052524387836456
loss_r_feature 0.25909221172332764
main criterion 5.9570007579168305e-05
------------iteration 3000----------
total loss 0.06611792743206024
loss_r_feature 0.22851744294166565
main criterion 9.500373562332243e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_10', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=10, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 10 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7119606733322144
loss_r_feature 0.49322509765625
main criterion 0.2905086576938629
------------iteration 200----------
total loss 0.5145503282546997
loss_r_feature 0.6087231636047363
main criterion 0.01121241133660078
------------iteration 300----------
total loss 0.4254281222820282
loss_r_feature 0.3157239556312561
main criterion 0.009580858051776886
------------iteration 400----------
total loss 0.38622429966926575
loss_r_feature 0.45665180683135986
main criterion 0.009860155172646046
------------iteration 500----------
total loss 0.34815454483032227
loss_r_feature 0.4655018448829651
main criterion 0.003275608643889427
------------iteration 600----------
total loss 0.3483123481273651
loss_r_feature 0.25827890634536743
main criterion 0.016776150092482567
------------iteration 700----------
total loss 0.3263494670391083
loss_r_feature 0.3296965956687927
main criterion 0.002064979402348399
------------iteration 800----------
total loss 0.2685461640357971
loss_r_feature 0.3015763759613037
main criterion 0.0007144781993702054
------------iteration 900----------
total loss 0.249503493309021
loss_r_feature 0.22466278076171875
main criterion 0.00026228069327771664
------------iteration 1000----------
total loss 0.2315150946378708
loss_r_feature 0.29244935512542725
main criterion 0.0037644680123776197
------------iteration 1100----------
total loss 0.17519445717334747
loss_r_feature 0.2762663960456848
main criterion 0.00045366992708295584
------------iteration 1200----------
total loss 0.1727704256772995
loss_r_feature 0.7008030414581299
main criterion 0.00014465166896115988
------------iteration 1300----------
total loss 0.13294704258441925
loss_r_feature 0.4797387719154358
main criterion 0.00010521946387598291
------------iteration 1400----------
total loss 0.10927421599626541
loss_r_feature 0.39271390438079834
main criterion 3.44774525729008e-05
------------iteration 1500----------
total loss 0.08753082156181335
loss_r_feature 0.2969803512096405
main criterion 0.000123524951050058
------------iteration 1600----------
total loss 0.06578236073255539
loss_r_feature 0.3196524381637573
main criterion 4.055522367707454e-05
------------iteration 1700----------
total loss 0.08043576776981354
loss_r_feature 0.16029778122901917
main criterion 0.03298531100153923
------------iteration 1800----------
total loss 0.03945114463567734
loss_r_feature 0.17486292123794556
main criterion 2.1831676349393092e-05
------------iteration 1900----------
total loss 0.03101184591650963
loss_r_feature 0.08758503198623657
main criterion 3.850201755994931e-05
------------iteration 2000----------
total loss 0.028896568343043327
loss_r_feature 0.060933202505111694
main criterion 3.1466945074498653e-05
------------iteration 2100----------
total loss 0.8558081388473511
loss_r_feature 0.4715427756309509
main criterion 0.13086435198783875
------------iteration 2200----------
total loss 0.5512890815734863
loss_r_feature 0.5773851871490479
main criterion 0.03607584536075592
------------iteration 2300----------
total loss 0.4662409722805023
loss_r_feature 0.5434534549713135
main criterion 0.023396456614136696
------------iteration 2400----------
total loss 0.34120768308639526
loss_r_feature 0.9160603284835815
main criterion 0.0013638176023960114
------------iteration 2500----------
total loss 0.25516095757484436
loss_r_feature 0.455389142036438
main criterion 0.00021044605819042772
------------iteration 2600----------
total loss 0.214448943734169
loss_r_feature 0.6892026662826538
main criterion 0.00013207874144427478
------------iteration 2700----------
total loss 0.15262331068515778
loss_r_feature 0.8679082989692688
main criterion 0.0003751603653654456
------------iteration 2800----------
total loss 0.08723711967468262
loss_r_feature 0.36156904697418213
main criterion 0.00010436453158035874
------------iteration 2900----------
total loss 0.04881388694047928
loss_r_feature 0.20142614841461182
main criterion 5.765717651229352e-05
------------iteration 3000----------
total loss 0.037092797458171844
loss_r_feature 0.09021618217229843
main criterion 7.679327245568857e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_11', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=11, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 11 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2257990837097168
loss_r_feature 9.426057815551758
main criterion 0.32028892636299133
------------iteration 200----------
total loss 1.0515333414077759
loss_r_feature 10.151981353759766
main criterion 0.06144542992115021
------------iteration 300----------
total loss 0.8234979510307312
loss_r_feature 7.601922988891602
main criterion 0.04216879978775978
------------iteration 400----------
total loss 1.023919701576233
loss_r_feature 7.080112457275391
main criterion 0.2900192439556122
------------iteration 500----------
total loss 0.7033603191375732
loss_r_feature 6.184716701507568
main criterion 0.06522387266159058
------------iteration 600----------
total loss 0.5607277154922485
loss_r_feature 5.138282299041748
main criterion 0.0027250293642282486
------------iteration 700----------
total loss 0.6016625165939331
loss_r_feature 4.190763473510742
main criterion 0.13372841477394104
------------iteration 800----------
total loss 0.47373059391975403
loss_r_feature 4.562105178833008
main criterion 0.0005336106987670064
------------iteration 900----------
total loss 0.3735877573490143
loss_r_feature 3.615177869796753
main criterion 0.00012010536738671362
------------iteration 1000----------
total loss 0.3929913341999054
loss_r_feature 4.13277530670166
main criterion 0.0011006065178662539
------------iteration 1100----------
total loss 0.3242896795272827
loss_r_feature 3.3043580055236816
main criterion 7.878042379161343e-05
------------iteration 1200----------
total loss 0.2929053008556366
loss_r_feature 3.000070095062256
main criterion 9.033866081153974e-05
------------iteration 1300----------
total loss 0.260977178812027
loss_r_feature 2.7197253704071045
main criterion 0.00011526391608640552
------------iteration 1400----------
total loss 0.23602992296218872
loss_r_feature 2.460216522216797
main criterion 6.589000258827582e-05
------------iteration 1500----------
total loss 0.209676131606102
loss_r_feature 2.2371318340301514
main criterion 9.111942927120253e-05
------------iteration 1600----------
total loss 0.18729329109191895
loss_r_feature 2.02372145652771
main criterion 0.00015030965732876211
------------iteration 1700----------
total loss 0.14225776493549347
loss_r_feature 1.2602367401123047
main criterion 6.85670311213471e-05
------------iteration 1800----------
total loss 0.1379317343235016
loss_r_feature 1.285743236541748
main criterion 6.0258051234995946e-05
------------iteration 1900----------
total loss 0.12635353207588196
loss_r_feature 1.106757402420044
main criterion 5.891842010896653e-05
------------iteration 2000----------
total loss 0.11737839132547379
loss_r_feature 0.9372550845146179
main criterion 3.7086341762915254e-05
------------iteration 2100----------
total loss 0.6256690621376038
loss_r_feature 3.6424362659454346
main criterion 0.0005773356533609331
------------iteration 2200----------
total loss 0.6408382058143616
loss_r_feature 4.5652289390563965
main criterion 0.0005207925569266081
------------iteration 2300----------
total loss 0.5934798121452332
loss_r_feature 4.499736785888672
main criterion 0.00044566765427589417
------------iteration 2400----------
total loss 0.5755888819694519
loss_r_feature 5.275496959686279
main criterion 0.0006469580112025142
------------iteration 2500----------
total loss 0.4391566514968872
loss_r_feature 3.4999263286590576
main criterion 7.24643177818507e-05
------------iteration 2600----------
total loss 0.3873676657676697
loss_r_feature 3.4109878540039062
main criterion 0.00011134975648019463
------------iteration 2700----------
total loss 0.29878923296928406
loss_r_feature 2.615755796432495
main criterion 5.8015801187139004e-05
------------iteration 2800----------
total loss 0.2361963391304016
loss_r_feature 2.2375550270080566
main criterion 0.0002291644486831501
------------iteration 2900----------
total loss 0.16711612045764923
loss_r_feature 1.2403582334518433
main criterion 9.89991458482109e-05
------------iteration 3000----------
total loss 0.15993690490722656
loss_r_feature 1.1957893371582031
main criterion 0.00012892928498331457
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_12', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=12, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 12 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.5282008647918701
loss_r_feature 5.3322930335998535
main criterion 0.8220523595809937
------------iteration 200----------
total loss 1.0797407627105713
loss_r_feature 3.8407278060913086
main criterion 0.4139856994152069
------------iteration 300----------
total loss 0.5831741690635681
loss_r_feature 2.9076156616210938
main criterion 0.025858987122774124
------------iteration 400----------
total loss 0.6612159013748169
loss_r_feature 4.700377464294434
main criterion 0.03055708110332489
------------iteration 500----------
total loss 0.5457611083984375
loss_r_feature 2.8153324127197266
main criterion 0.004047608934342861
------------iteration 600----------
total loss 0.49789223074913025
loss_r_feature 2.7434558868408203
main criterion 0.00030128471553325653
------------iteration 700----------
total loss 0.46687236428260803
loss_r_feature 2.4550790786743164
main criterion 0.00032214619568549097
------------iteration 800----------
total loss 0.40828651189804077
loss_r_feature 1.9007058143615723
main criterion 0.010031064040958881
------------iteration 900----------
total loss 0.4071353077888489
loss_r_feature 2.374267339706421
main criterion 0.0015787860611453652
------------iteration 1000----------
total loss 0.35577842593193054
loss_r_feature 1.8047982454299927
main criterion 7.118685607565567e-05
------------iteration 1100----------
total loss 0.33762726187705994
loss_r_feature 1.873093843460083
main criterion 0.00020976491214241832
------------iteration 1200----------
total loss 0.3177548348903656
loss_r_feature 1.9580358266830444
main criterion 6.0282935010036454e-05
------------iteration 1300----------
total loss 0.35569241642951965
loss_r_feature 3.234617233276367
main criterion 0.00010660995758371428
------------iteration 1400----------
total loss 0.26486656069755554
loss_r_feature 1.8489856719970703
main criterion 4.967081986251287e-05
------------iteration 1500----------
total loss 0.20915921032428741
loss_r_feature 1.1095057725906372
main criterion 4.8968558985507116e-05
------------iteration 1600----------
total loss 0.21128299832344055
loss_r_feature 1.6462724208831787
main criterion 0.00016873674758244306
------------iteration 1700----------
total loss 0.15275508165359497
loss_r_feature 0.8149505853652954
main criterion 5.6789554946590215e-05
------------iteration 1800----------
total loss 0.13629360496997833
loss_r_feature 0.733768105506897
main criterion 9.215284080710262e-05
------------iteration 1900----------
total loss 0.11867991834878922
loss_r_feature 0.520325243473053
main criterion 4.964684558217414e-05
------------iteration 2000----------
total loss 0.11575664579868317
loss_r_feature 0.49253010749816895
main criterion 4.21431141148787e-05
------------iteration 2100----------
total loss 0.742021381855011
loss_r_feature 2.464174747467041
main criterion 0.001412921235896647
------------iteration 2200----------
total loss 0.7234759330749512
loss_r_feature 2.943899631500244
main criterion 0.0002987725310958922
------------iteration 2300----------
total loss 0.7059326767921448
loss_r_feature 4.0375518798828125
main criterion 0.0010147563880309463
------------iteration 2400----------
total loss 0.5801154971122742
loss_r_feature 2.425346851348877
main criterion 0.00039105245377868414
------------iteration 2500----------
total loss 0.5199674367904663
loss_r_feature 2.1363158226013184
main criterion 0.0002512963255867362
------------iteration 2600----------
total loss 0.42472127079963684
loss_r_feature 1.7345890998840332
main criterion 0.0001427743845852092
------------iteration 2700----------
total loss 0.3295356333255768
loss_r_feature 1.3358798027038574
main criterion 9.358452371088788e-05
------------iteration 2800----------
total loss 0.26875782012939453
loss_r_feature 1.5356947183609009
main criterion 0.00013714622764382511
------------iteration 2900----------
total loss 0.19526025652885437
loss_r_feature 1.0206836462020874
main criterion 0.0001188366804854013
------------iteration 3000----------
total loss 0.1582416445016861
loss_r_feature 0.5245469808578491
main criterion 0.00022690060723107308
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_13', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=13, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 13 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0529793500900269
loss_r_feature 2.553436279296875
main criterion 0.48822030425071716
------------iteration 200----------
total loss 0.6494590044021606
loss_r_feature 2.0098557472229004
main criterion 0.07924415171146393
------------iteration 300----------
total loss 0.5152615308761597
loss_r_feature 1.539009928703308
main criterion 0.005670838989317417
------------iteration 400----------
total loss 0.49677905440330505
loss_r_feature 2.08319091796875
main criterion 0.016019433736801147
------------iteration 500----------
total loss 0.48344212770462036
loss_r_feature 1.5701556205749512
main criterion 0.015831371769309044
------------iteration 600----------
total loss 0.4444805681705475
loss_r_feature 1.6145470142364502
main criterion 0.0012534415582194924
------------iteration 700----------
total loss 0.41384974122047424
loss_r_feature 1.4580804109573364
main criterion 0.005513516720384359
------------iteration 800----------
total loss 0.3786008656024933
loss_r_feature 1.35508394241333
main criterion 0.0014372164150699973
------------iteration 900----------
total loss 0.3361836075782776
loss_r_feature 1.5505784749984741
main criterion 9.026572661241516e-05
------------iteration 1000----------
total loss 0.2860262989997864
loss_r_feature 0.8856654167175293
main criterion 0.00016878910537343472
------------iteration 1100----------
total loss 0.27745169401168823
loss_r_feature 1.378023624420166
main criterion 0.0003515432181302458
------------iteration 1200----------
total loss 0.29679232835769653
loss_r_feature 1.9709604978561401
main criterion 0.008030222728848457
------------iteration 1300----------
total loss 0.225058913230896
loss_r_feature 1.2154350280761719
main criterion 0.00017465358541812748
------------iteration 1400----------
total loss 0.18343080580234528
loss_r_feature 0.8037293553352356
main criterion 0.00016457430319860578
------------iteration 1500----------
total loss 0.20561078190803528
loss_r_feature 1.6413869857788086
main criterion 0.0015982011100277305
------------iteration 1600----------
total loss 0.17739543318748474
loss_r_feature 1.4787213802337646
main criterion 0.00013306371693033725
------------iteration 1700----------
total loss 0.10848749428987503
loss_r_feature 0.4216592013835907
main criterion 4.450068445294164e-05
------------iteration 1800----------
total loss 0.08988648653030396
loss_r_feature 0.28382864594459534
main criterion 3.3226086088689044e-05
------------iteration 1900----------
total loss 0.08502858132123947
loss_r_feature 0.30712947249412537
main criterion 5.774584860773757e-05
------------iteration 2000----------
total loss 0.07730776071548462
loss_r_feature 0.17690780758857727
main criterion 3.547647065715864e-05
------------iteration 2100----------
total loss 0.6909880042076111
loss_r_feature 1.4836413860321045
main criterion 0.004605742171406746
------------iteration 2200----------
total loss 0.59508216381073
loss_r_feature 1.5883504152297974
main criterion 0.0002578832791186869
------------iteration 2300----------
total loss 0.536603569984436
loss_r_feature 1.7361390590667725
main criterion 0.0005782408406957984
------------iteration 2400----------
total loss 0.4226297438144684
loss_r_feature 0.9944466352462769
main criterion 0.0002080942940665409
------------iteration 2500----------
total loss 0.4384206235408783
loss_r_feature 2.4103357791900635
main criterion 0.00019978008640464395
------------iteration 2600----------
total loss 0.36881157755851746
loss_r_feature 2.066500663757324
main criterion 0.00018801081751007587
------------iteration 2700----------
total loss 0.24069496989250183
loss_r_feature 0.6911453008651733
main criterion 6.426585605368018e-05
------------iteration 2800----------
total loss 0.19802844524383545
loss_r_feature 0.9338459968566895
main criterion 9.067163045983762e-05
------------iteration 2900----------
total loss 0.12298620492219925
loss_r_feature 0.2970810532569885
main criterion 9.779186075320467e-05
------------iteration 3000----------
total loss 0.10875331610441208
loss_r_feature 0.25148507952690125
main criterion 0.00016310396313201636
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_14', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=14, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 14 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.298063278198242
loss_r_feature 30.88089942932129
main criterion 0.318837970495224
------------iteration 200----------
total loss 2.2891898155212402
loss_r_feature 30.289155960083008
main criterion 0.3040679097175598
------------iteration 300----------
total loss 1.6291102170944214
loss_r_feature 23.88709259033203
main criterion 0.027389032766222954
------------iteration 400----------
total loss 1.7541272640228271
loss_r_feature 21.17605972290039
main criterion 0.31880059838294983
------------iteration 500----------
total loss 1.2094463109970093
loss_r_feature 17.64618492126465
main criterion 0.0008708885870873928
------------iteration 600----------
total loss 1.0369302034378052
loss_r_feature 15.060619354248047
main criterion 0.004408831708133221
------------iteration 700----------
total loss 1.110539436340332
loss_r_feature 16.03001594543457
main criterion 0.015141184441745281
------------iteration 800----------
total loss 0.9158665537834167
loss_r_feature 12.92294692993164
main criterion 0.018159091472625732
------------iteration 900----------
total loss 0.4999806582927704
loss_r_feature 6.605146408081055
main criterion 0.00011417589848861098
------------iteration 1000----------
total loss 0.426989883184433
loss_r_feature 5.325677394866943
main criterion 0.00029525082209147513
------------iteration 1100----------
total loss 0.34249305725097656
loss_r_feature 3.998119831085205
main criterion 0.0013098842464387417
------------iteration 1200----------
total loss 0.2856543958187103
loss_r_feature 3.1027615070343018
main criterion 0.00013631083129439503
------------iteration 1300----------
total loss 0.2711015045642853
loss_r_feature 3.076279640197754
main criterion 8.51706208777614e-05
------------iteration 1400----------
total loss 0.2573987543582916
loss_r_feature 2.8546500205993652
main criterion 4.71319945063442e-05
------------iteration 1500----------
total loss 0.24481485784053802
loss_r_feature 2.7259232997894287
main criterion 7.50155741116032e-05
------------iteration 1600----------
total loss 0.2561219334602356
loss_r_feature 3.0109753608703613
main criterion 4.182309930911288e-05
------------iteration 1700----------
total loss 0.21310581266880035
loss_r_feature 2.1798715591430664
main criterion 7.111774903023615e-05
------------iteration 1800----------
total loss 0.20509810745716095
loss_r_feature 2.0277137756347656
main criterion 6.955920980544761e-05
------------iteration 1900----------
total loss 0.19890619814395905
loss_r_feature 1.901877522468567
main criterion 7.665441808057949e-05
------------iteration 2000----------
total loss 0.19631466269493103
loss_r_feature 1.8488667011260986
main criterion 7.581042882520705e-05
------------iteration 2100----------
total loss 0.7942498326301575
loss_r_feature 8.677757263183594
main criterion 0.006477052345871925
------------iteration 2200----------
total loss 0.6601904034614563
loss_r_feature 7.290061950683594
main criterion 0.00024003836733754724
------------iteration 2300----------
total loss 0.5588541626930237
loss_r_feature 6.116049766540527
main criterion 0.0002131849469151348
------------iteration 2400----------
total loss 0.49625808000564575
loss_r_feature 5.001101016998291
main criterion 0.00037273942143656313
------------iteration 2500----------
total loss 0.4027003347873688
loss_r_feature 3.845913887023926
main criterion 0.00037031807005405426
------------iteration 2600----------
total loss 0.3376268148422241
loss_r_feature 2.7439794540405273
main criterion 0.00017903758271131665
------------iteration 2700----------
total loss 0.3189985752105713
loss_r_feature 2.5226407051086426
main criterion 0.00011278089368715882
------------iteration 2800----------
total loss 0.3099353015422821
loss_r_feature 2.6633872985839844
main criterion 0.00012924479960929602
------------iteration 2900----------
total loss 0.2594236135482788
loss_r_feature 1.8268277645111084
main criterion 0.0001173886121250689
------------iteration 3000----------
total loss 0.258010596036911
loss_r_feature 1.8255901336669922
main criterion 0.00016636107466183603
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_15', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=15, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 15 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.1325223445892334
loss_r_feature 32.34800720214844
main criterion 0.051378361880779266
------------iteration 200----------
total loss 1.816632866859436
loss_r_feature 23.402267456054688
main criterion 0.15698161721229553
------------iteration 300----------
total loss 1.2279999256134033
loss_r_feature 15.744264602661133
main criterion 0.02818673849105835
------------iteration 400----------
total loss 1.0556424856185913
loss_r_feature 13.197789192199707
main criterion 0.01769131049513817
------------iteration 500----------
total loss 1.044241189956665
loss_r_feature 13.338484764099121
main criterion 0.008177833631634712
------------iteration 600----------
total loss 0.9598488211631775
loss_r_feature 12.274870872497559
main criterion 0.001449013827368617
------------iteration 700----------
total loss 1.0023423433303833
loss_r_feature 11.0570068359375
main criterion 0.12491229921579361
------------iteration 800----------
total loss 0.7986512780189514
loss_r_feature 9.037980079650879
main criterion 0.07684449106454849
------------iteration 900----------
total loss 0.5475260019302368
loss_r_feature 6.3632097244262695
main criterion 0.0012603220529854298
------------iteration 1000----------
total loss 0.4731786847114563
loss_r_feature 5.337334156036377
main criterion 0.003184777218848467
------------iteration 1100----------
total loss 0.40942269563674927
loss_r_feature 4.644927024841309
main criterion 0.0006535400752909482
------------iteration 1200----------
total loss 0.3091411590576172
loss_r_feature 3.4819188117980957
main criterion 0.0010879442561417818
------------iteration 1300----------
total loss 0.26849082112312317
loss_r_feature 2.755622625350952
main criterion 0.00030022801365703344
------------iteration 1400----------
total loss 0.23214690387248993
loss_r_feature 2.3542399406433105
main criterion 0.0001331961975665763
------------iteration 1500----------
total loss 0.2002594769001007
loss_r_feature 1.8769639730453491
main criterion 0.00020607166516128927
------------iteration 1600----------
total loss 0.1994462013244629
loss_r_feature 1.9876072406768799
main criterion 0.00017604904132895172
------------iteration 1700----------
total loss 0.16548827290534973
loss_r_feature 1.3687541484832764
main criterion 0.0001113986290874891
------------iteration 1800----------
total loss 0.15438562631607056
loss_r_feature 1.1915745735168457
main criterion 0.00010603033297229558
------------iteration 1900----------
total loss 0.1475684642791748
loss_r_feature 1.0686558485031128
main criterion 0.00012072133540641516
------------iteration 2000----------
total loss 0.14559286832809448
loss_r_feature 1.0313619375228882
main criterion 0.00013976312766317278
------------iteration 2100----------
total loss 0.8776454925537109
loss_r_feature 6.421403884887695
main criterion 0.17225590348243713
------------iteration 2200----------
total loss 0.8409941792488098
loss_r_feature 7.1363677978515625
main criterion 0.0008170197834260762
------------iteration 2300----------
total loss 0.6905918121337891
loss_r_feature 5.819734573364258
main criterion 0.002564892638474703
------------iteration 2400----------
total loss 0.4612124562263489
loss_r_feature 3.725278854370117
main criterion 0.00048730362323112786
------------iteration 2500----------
total loss 0.41936609148979187
loss_r_feature 3.800261974334717
main criterion 0.00031371955992653966
------------iteration 2600----------
total loss 0.3381003439426422
loss_r_feature 2.481016159057617
main criterion 0.00018952178652398288
------------iteration 2700----------
total loss 0.27943769097328186
loss_r_feature 1.9177029132843018
main criterion 0.00012521896860562265
------------iteration 2800----------
total loss 0.23345305025577545
loss_r_feature 1.4451557397842407
main criterion 0.000233856204431504
------------iteration 2900----------
total loss 0.21877367794513702
loss_r_feature 1.3750426769256592
main criterion 0.0002289738622494042
------------iteration 3000----------
total loss 0.19594545662403107
loss_r_feature 0.9427883625030518
main criterion 0.00019898849132005125
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_16', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=16, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 16 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2483187913894653
loss_r_feature 11.426738739013672
main criterion 0.25784024596214294
------------iteration 200----------
total loss 1.0863755941390991
loss_r_feature 11.739550590515137
main criterion 0.0047217365354299545
------------iteration 300----------
total loss 1.1690999269485474
loss_r_feature 10.570202827453613
main criterion 0.15793929994106293
------------iteration 400----------
total loss 0.8338804841041565
loss_r_feature 7.585110664367676
main criterion 0.023984257131814957
------------iteration 500----------
total loss 0.9191314578056335
loss_r_feature 8.972332000732422
main criterion 0.04075036570429802
------------iteration 600----------
total loss 0.7514045834541321
loss_r_feature 5.79100227355957
main criterion 0.1020064577460289
------------iteration 700----------
total loss 0.6855343580245972
loss_r_feature 4.127269268035889
main criterion 0.15783950686454773
------------iteration 800----------
total loss 0.5196233987808228
loss_r_feature 3.3906962871551514
main criterion 0.0683276355266571
------------iteration 900----------
total loss 0.3731025457382202
loss_r_feature 2.545321226119995
main criterion 0.005861230660229921
------------iteration 1000----------
total loss 0.3543858230113983
loss_r_feature 2.465790271759033
main criterion 0.00021186393860261887
------------iteration 1100----------
total loss 0.27897655963897705
loss_r_feature 1.7943050861358643
main criterion 0.00040419152355752885
------------iteration 1200----------
total loss 0.2468528151512146
loss_r_feature 1.7134755849838257
main criterion 0.0002744572702795267
------------iteration 1300----------
total loss 0.2379145473241806
loss_r_feature 2.06418514251709
main criterion 0.00017044511332642287
------------iteration 1400----------
total loss 0.18193361163139343
loss_r_feature 1.2968887090682983
main criterion 0.0005073435604572296
------------iteration 1500----------
total loss 0.15949514508247375
loss_r_feature 1.1339085102081299
main criterion 5.4221567552303895e-05
------------iteration 1600----------
total loss 0.1377999633550644
loss_r_feature 1.0117021799087524
main criterion 5.549083653022535e-05
------------iteration 1700----------
total loss 0.1291317194700241
loss_r_feature 0.9771584272384644
main criterion 5.46720766578801e-05
------------iteration 1800----------
total loss 0.11916572600603104
loss_r_feature 0.8939242362976074
main criterion 8.277461893158033e-05
------------iteration 1900----------
total loss 0.11399304121732712
loss_r_feature 0.8484619855880737
main criterion 0.00011670392996165901
------------iteration 2000----------
total loss 0.11218985915184021
loss_r_feature 0.8245635032653809
main criterion 7.885957165854052e-05
------------iteration 2100----------
total loss 0.839111864566803
loss_r_feature 4.7412800788879395
main criterion 0.12119714170694351
------------iteration 2200----------
total loss 0.6943914294242859
loss_r_feature 4.211294174194336
main criterion 0.0008861214737407863
------------iteration 2300----------
total loss 0.510146975517273
loss_r_feature 2.4354960918426514
main criterion 0.0003837196563836187
------------iteration 2400----------
total loss 0.4251266121864319
loss_r_feature 2.303248643875122
main criterion 0.0029620237182825804
------------iteration 2500----------
total loss 0.3381129503250122
loss_r_feature 2.160696506500244
main criterion 0.001714323298074305
------------iteration 2600----------
total loss 0.2700901925563812
loss_r_feature 1.5503849983215332
main criterion 0.00017558511171955615
------------iteration 2700----------
total loss 0.253652423620224
loss_r_feature 1.7569513320922852
main criterion 0.00011198611900908872
------------iteration 2800----------
total loss 0.18741165101528168
loss_r_feature 1.1340420246124268
main criterion 0.00017479952657595277
------------iteration 2900----------
total loss 0.14784906804561615
loss_r_feature 0.7457882761955261
main criterion 0.00016559699724894017
------------iteration 3000----------
total loss 0.14194005727767944
loss_r_feature 0.7204134464263916
main criterion 0.00024749626754783094
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_17', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=17, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 17 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.984799861907959
loss_r_feature 4.643003463745117
main criterion 0.34823647141456604
------------iteration 200----------
total loss 1.106848955154419
loss_r_feature 4.876040935516357
main criterion 0.3775503635406494
------------iteration 300----------
total loss 0.8370380401611328
loss_r_feature 4.30483865737915
main criterion 0.15391147136688232
------------iteration 400----------
total loss 0.6915957927703857
loss_r_feature 3.629958391189575
main criterion 0.08502858877182007
------------iteration 500----------
total loss 0.6833261847496033
loss_r_feature 3.1574110984802246
main criterion 0.1289895623922348
------------iteration 600----------
total loss 0.47350451350212097
loss_r_feature 2.509331226348877
main criterion 0.0003276752831880003
------------iteration 700----------
total loss 0.43404629826545715
loss_r_feature 2.301844835281372
main criterion 0.0007452250574715436
------------iteration 800----------
total loss 0.38382354378700256
loss_r_feature 1.979416012763977
main criterion 0.003382681403309107
------------iteration 900----------
total loss 0.35734114050865173
loss_r_feature 1.791225552558899
main criterion 0.0007764466572552919
------------iteration 1000----------
total loss 0.23723560571670532
loss_r_feature 0.94847571849823
main criterion 0.0003587406827136874
------------iteration 1100----------
total loss 0.23959361016750336
loss_r_feature 0.9724834561347961
main criterion 0.002920489991083741
------------iteration 1200----------
total loss 0.21097972989082336
loss_r_feature 0.8530069589614868
main criterion 0.012659775093197823
------------iteration 1300----------
total loss 0.17149627208709717
loss_r_feature 1.0959643125534058
main criterion 0.000310793548123911
------------iteration 1400----------
total loss 0.13079281151294708
loss_r_feature 0.6457030177116394
main criterion 6.732315523549914e-05
------------iteration 1500----------
total loss 0.11141010373830795
loss_r_feature 0.7910063862800598
main criterion 8.989591151475906e-05
------------iteration 1600----------
total loss 0.09268740564584732
loss_r_feature 0.5981953144073486
main criterion 0.0001066900440491736
------------iteration 1700----------
total loss 0.08551333099603653
loss_r_feature 0.6001251339912415
main criterion 3.6379416997078806e-05
------------iteration 1800----------
total loss 0.07322506606578827
loss_r_feature 0.5009509325027466
main criterion 4.353974509285763e-05
------------iteration 1900----------
total loss 0.07058323919773102
loss_r_feature 0.504915177822113
main criterion 7.020139310043305e-05
------------iteration 2000----------
total loss 0.06828886270523071
loss_r_feature 0.47194209694862366
main criterion 4.244181764079258e-05
------------iteration 2100----------
total loss 0.9350389242172241
loss_r_feature 3.3095004558563232
main criterion 0.16810421645641327
------------iteration 2200----------
total loss 0.5648213624954224
loss_r_feature 1.6038352251052856
main criterion 0.032024674117565155
------------iteration 2300----------
total loss 0.5234648585319519
loss_r_feature 1.2736279964447021
main criterion 0.015792712569236755
------------iteration 2400----------
total loss 0.3548847734928131
loss_r_feature 0.798209011554718
main criterion 0.0014282386982813478
------------iteration 2500----------
total loss 0.2796815037727356
loss_r_feature 1.3152998685836792
main criterion 0.001061591668985784
------------iteration 2600----------
total loss 0.21174503862857819
loss_r_feature 0.5189220905303955
main criterion 0.0005238247686065733
------------iteration 2700----------
total loss 0.14658458530902863
loss_r_feature 0.47638002038002014
main criterion 0.00015284727851394564
------------iteration 2800----------
total loss 0.10359253734350204
loss_r_feature 0.31693652272224426
main criterion 0.00013126859266776592
------------iteration 2900----------
total loss 0.08624155074357986
loss_r_feature 0.27297693490982056
main criterion 9.406762546859682e-05
------------iteration 3000----------
total loss 0.08046570420265198
loss_r_feature 0.24733470380306244
main criterion 9.516545833321288e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_18', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=18, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 18 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.7340410947799683
loss_r_feature 16.184032440185547
main criterion 0.4818398654460907
------------iteration 200----------
total loss 1.2103080749511719
loss_r_feature 14.645393371582031
main criterion 0.019110089167952538
------------iteration 300----------
total loss 1.192506194114685
loss_r_feature 13.696847915649414
main criterion 0.06710966676473618
------------iteration 400----------
total loss 1.1476483345031738
loss_r_feature 10.822017669677734
main criterion 0.2396841049194336
------------iteration 500----------
total loss 0.7910377383232117
loss_r_feature 9.23231029510498
main criterion 0.004487155936658382
------------iteration 600----------
total loss 0.7840568423271179
loss_r_feature 9.124451637268066
main criterion 0.020146289840340614
------------iteration 700----------
total loss 0.6212937831878662
loss_r_feature 7.2141242027282715
main criterion 0.0011534891091287136
------------iteration 800----------
total loss 0.5429326295852661
loss_r_feature 5.96130895614624
main criterion 0.011871088296175003
------------iteration 900----------
total loss 0.41081976890563965
loss_r_feature 4.40548038482666
main criterion 0.0005592199740931392
------------iteration 1000----------
total loss 0.3498450219631195
loss_r_feature 3.622629404067993
main criterion 0.0004630838811863214
------------iteration 1100----------
total loss 0.3487083911895752
loss_r_feature 3.6522693634033203
main criterion 0.00030392067856155336
------------iteration 1200----------
total loss 0.2532164752483368
loss_r_feature 2.5033516883850098
main criterion 0.00026841196813620627
------------iteration 1300----------
total loss 0.24019959568977356
loss_r_feature 2.370084524154663
main criterion 0.000112989466288127
------------iteration 1400----------
total loss 0.1973699927330017
loss_r_feature 1.7332170009613037
main criterion 0.00015323341358453035
------------iteration 1500----------
total loss 0.2035391479730606
loss_r_feature 2.0817084312438965
main criterion 0.0003952209372073412
------------iteration 1600----------
total loss 0.1846577525138855
loss_r_feature 1.8577525615692139
main criterion 0.0001417380990460515
------------iteration 1700----------
total loss 0.1527067869901657
loss_r_feature 1.3315008878707886
main criterion 0.0004986720159649849
------------iteration 1800----------
total loss 0.12504170835018158
loss_r_feature 0.881466269493103
main criterion 6.44888641545549e-05
------------iteration 1900----------
total loss 0.1186666414141655
loss_r_feature 0.8154003620147705
main criterion 9.003191371448338e-05
------------iteration 2000----------
total loss 0.11537453532218933
loss_r_feature 0.7650012373924255
main criterion 8.013026672415435e-05
------------iteration 2100----------
total loss 0.7780553102493286
loss_r_feature 4.765381336212158
main criterion 0.1310015469789505
------------iteration 2200----------
total loss 0.5932462811470032
loss_r_feature 5.037722110748291
main criterion 0.0004588951705954969
------------iteration 2300----------
total loss 0.4840054214000702
loss_r_feature 3.7944116592407227
main criterion 0.0006140404148027301
------------iteration 2400----------
total loss 0.4333043098449707
loss_r_feature 3.649738311767578
main criterion 0.0007875131559558213
------------iteration 2500----------
total loss 0.38235190510749817
loss_r_feature 2.992846727371216
main criterion 0.0003380261769052595
------------iteration 2600----------
total loss 0.3218843638896942
loss_r_feature 2.457749366760254
main criterion 0.0002313747681910172
------------iteration 2700----------
total loss 0.27628031373023987
loss_r_feature 1.9242500066757202
main criterion 0.00019580786465667188
------------iteration 2800----------
total loss 0.2267821878194809
loss_r_feature 1.496056079864502
main criterion 0.0002458618546370417
------------iteration 2900----------
total loss 0.17563262581825256
loss_r_feature 0.8810644745826721
main criterion 0.00019433726265560836
------------iteration 3000----------
total loss 0.15935170650482178
loss_r_feature 0.6668713092803955
main criterion 0.00020348432008177042
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_19', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=19, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 19 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2460713386535645
loss_r_feature 9.525065422058105
main criterion 0.317571222782135
------------iteration 200----------
total loss 0.8866291046142578
loss_r_feature 7.212369441986084
main criterion 0.04204360768198967
------------iteration 300----------
total loss 0.6089938879013062
loss_r_feature 4.523847579956055
main criterion 0.008094849064946175
------------iteration 400----------
total loss 0.5582670569419861
loss_r_feature 3.7662901878356934
main criterion 0.02921157144010067
------------iteration 500----------
total loss 0.5783188939094543
loss_r_feature 4.262884140014648
main criterion 0.0024906641338020563
------------iteration 600----------
total loss 0.5236444473266602
loss_r_feature 3.6196532249450684
main criterion 0.012977282516658306
------------iteration 700----------
total loss 0.4895945191383362
loss_r_feature 2.7576704025268555
main criterion 0.06553949415683746
------------iteration 800----------
total loss 0.4707460105419159
loss_r_feature 3.1126279830932617
main criterion 0.028236540034413338
------------iteration 900----------
total loss 0.33286377787590027
loss_r_feature 2.2221579551696777
main criterion 0.0002033703203778714
------------iteration 1000----------
total loss 0.42076510190963745
loss_r_feature 1.5855364799499512
main criterion 0.15816059708595276
------------iteration 1100----------
total loss 0.23071080446243286
loss_r_feature 1.3474972248077393
main criterion 0.0001991071185329929
------------iteration 1200----------
total loss 0.24889503419399261
loss_r_feature 1.8997597694396973
main criterion 0.0001616979279788211
------------iteration 1300----------
total loss 0.1953187882900238
loss_r_feature 1.2235803604125977
main criterion 0.00014673915575258434
------------iteration 1400----------
total loss 0.1645335555076599
loss_r_feature 1.0632691383361816
main criterion 0.00014040835958439857
------------iteration 1500----------
total loss 0.14694444835186005
loss_r_feature 1.0211344957351685
main criterion 0.00011427658319007605
------------iteration 1600----------
total loss 0.11650170385837555
loss_r_feature 0.6531673073768616
main criterion 0.00017761855269782245
------------iteration 1700----------
total loss 0.1006479263305664
loss_r_feature 0.5053974986076355
main criterion 9.303636761615053e-05
------------iteration 1800----------
total loss 0.08824219554662704
loss_r_feature 0.4090338945388794
main criterion 6.771797779947519e-05
------------iteration 1900----------
total loss 0.08235063403844833
loss_r_feature 0.36825284361839294
main criterion 9.111876715905964e-05
------------iteration 2000----------
total loss 0.07952878624200821
loss_r_feature 0.3315744400024414
main criterion 9.444110037293285e-05
------------iteration 2100----------
total loss 0.7942297458648682
loss_r_feature 3.9578185081481934
main criterion 0.05662851780653
------------iteration 2200----------
total loss 0.4965533912181854
loss_r_feature 1.9205738306045532
main criterion 0.0013967780396342278
------------iteration 2300----------
total loss 0.4510767459869385
loss_r_feature 2.108436107635498
main criterion 0.0003262971877120435
------------iteration 2400----------
total loss 0.42013996839523315
loss_r_feature 2.0565757751464844
main criterion 0.0020319430623203516
------------iteration 2500----------
total loss 0.3134474456310272
loss_r_feature 1.5977511405944824
main criterion 0.0003992677084170282
------------iteration 2600----------
total loss 0.2779974639415741
loss_r_feature 1.1705435514450073
main criterion 0.00018150464165955782
------------iteration 2700----------
total loss 0.21820105612277985
loss_r_feature 0.9400091171264648
main criterion 0.00011443786934250966
------------iteration 2800----------
total loss 0.17486712336540222
loss_r_feature 0.7543201446533203
main criterion 0.0001888691185740754
------------iteration 2900----------
total loss 0.13679270446300507
loss_r_feature 0.48226141929626465
main criterion 0.000251539284363389
------------iteration 3000----------
total loss 0.12164902687072754
loss_r_feature 0.3116191625595093
main criterion 0.00018682026711758226
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_20', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=20, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 20 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1943172216415405
loss_r_feature 4.835220813751221
main criterion 0.5047716498374939
------------iteration 200----------
total loss 0.6945170760154724
loss_r_feature 3.9573333263397217
main criterion 0.006424970459192991
------------iteration 300----------
total loss 0.6050076484680176
loss_r_feature 3.0914676189422607
main criterion 0.013752956874668598
------------iteration 400----------
total loss 0.5424501895904541
loss_r_feature 2.430147647857666
main criterion 0.016969790682196617
------------iteration 500----------
total loss 0.5053353309631348
loss_r_feature 2.2876949310302734
main criterion 0.001254341914318502
------------iteration 600----------
total loss 0.4197354316711426
loss_r_feature 1.7696940898895264
main criterion 0.005230971612036228
------------iteration 700----------
total loss 0.3811469078063965
loss_r_feature 1.420891523361206
main criterion 0.000376999523723498
------------iteration 800----------
total loss 0.3453386127948761
loss_r_feature 1.3308494091033936
main criterion 0.009373490698635578
------------iteration 900----------
total loss 0.27242520451545715
loss_r_feature 0.8338907361030579
main criterion 0.00020002426754217595
------------iteration 1000----------
total loss 0.22911372780799866
loss_r_feature 0.6561353206634521
main criterion 0.0007920995121821761
------------iteration 1100----------
total loss 0.20603787899017334
loss_r_feature 0.5335825085639954
main criterion 0.0005148015916347504
------------iteration 1200----------
total loss 0.16603459417819977
loss_r_feature 0.7321279644966125
main criterion 0.0005736379534937441
------------iteration 1300----------
total loss 0.14696525037288666
loss_r_feature 0.5443281531333923
main criterion 0.000365029409294948
------------iteration 1400----------
total loss 0.12234746664762497
loss_r_feature 0.352277010679245
main criterion 0.00010072517761727795
------------iteration 1500----------
total loss 0.10355690866708755
loss_r_feature 0.4109952449798584
main criterion 6.665963883278891e-05
------------iteration 1600----------
total loss 0.09295885264873505
loss_r_feature 0.48318204283714294
main criterion 4.987521606381051e-05
------------iteration 1700----------
total loss 0.07096999138593674
loss_r_feature 0.24507483839988708
main criterion 4.078102938365191e-05
------------iteration 1800----------
total loss 0.0615176223218441
loss_r_feature 0.22039829194545746
main criterion 5.319496267475188e-05
------------iteration 1900----------
total loss 0.05336805060505867
loss_r_feature 0.13668911159038544
main criterion 4.544181501842104e-05
------------iteration 2000----------
total loss 0.05104457214474678
loss_r_feature 0.10730281472206116
main criterion 4.495944085647352e-05
------------iteration 2100----------
total loss 0.7907958030700684
loss_r_feature 2.149685859680176
main criterion 0.1209922730922699
------------iteration 2200----------
total loss 0.5219899415969849
loss_r_feature 1.3514434099197388
main criterion 0.001533779315650463
------------iteration 2300----------
total loss 0.39812806248664856
loss_r_feature 1.0285005569458008
main criterion 0.0013045115629211068
------------iteration 2400----------
total loss 0.33299940824508667
loss_r_feature 0.8804768323898315
main criterion 0.0005823408719152212
------------iteration 2500----------
total loss 0.2784111797809601
loss_r_feature 0.9715746641159058
main criterion 0.0006072017131373286
------------iteration 2600----------
total loss 0.22702345252037048
loss_r_feature 0.8554658889770508
main criterion 0.00018572312546893954
------------iteration 2700----------
total loss 0.15583425760269165
loss_r_feature 0.5445197820663452
main criterion 7.121869566617534e-05
------------iteration 2800----------
total loss 0.11576540768146515
loss_r_feature 0.4145246744155884
main criterion 0.00016665179282426834
------------iteration 2900----------
total loss 0.08247296512126923
loss_r_feature 0.2045300006866455
main criterion 0.00012373803474474698
------------iteration 3000----------
total loss 0.07475218176841736
loss_r_feature 0.16441255807876587
main criterion 0.00013677914103027433
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_21', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=21, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 21 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.877783477306366
loss_r_feature 6.399356842041016
main criterion 0.09022361040115356
------------iteration 200----------
total loss 0.6859309077262878
loss_r_feature 4.123382568359375
main criterion 0.024296104907989502
------------iteration 300----------
total loss 0.5835094451904297
loss_r_feature 3.4579858779907227
main criterion 0.014342335984110832
------------iteration 400----------
total loss 0.5109241604804993
loss_r_feature 2.890738010406494
main criterion 0.0032603517174720764
------------iteration 500----------
total loss 0.5313147306442261
loss_r_feature 3.037839412689209
main criterion 0.005795550998300314
------------iteration 600----------
total loss 0.461405873298645
loss_r_feature 2.8659677505493164
main criterion 0.0011763666989281774
------------iteration 700----------
total loss 0.38224121928215027
loss_r_feature 1.9523248672485352
main criterion 0.007996567524969578
------------iteration 800----------
total loss 0.3619743883609772
loss_r_feature 1.983893632888794
main criterion 0.0006084024207666516
------------iteration 900----------
total loss 0.296037882566452
loss_r_feature 1.6380767822265625
main criterion 0.00011268793605268002
------------iteration 1000----------
total loss 0.27555182576179504
loss_r_feature 1.4253995418548584
main criterion 0.0005507519235834479
------------iteration 1100----------
total loss 0.2462114840745926
loss_r_feature 1.3339942693710327
main criterion 0.002466520993039012
------------iteration 1200----------
total loss 0.3845353126525879
loss_r_feature 2.0272374153137207
main criterion 0.13249826431274414
------------iteration 1300----------
total loss 0.21485207974910736
loss_r_feature 1.5219309329986572
main criterion 0.00015183145296759903
------------iteration 1400----------
total loss 0.1680089235305786
loss_r_feature 0.9899424910545349
main criterion 0.00018791980983223766
------------iteration 1500----------
total loss 0.1602819561958313
loss_r_feature 1.219395637512207
main criterion 6.635663157794625e-05
------------iteration 1600----------
total loss 0.13006670773029327
loss_r_feature 0.8915401697158813
main criterion 5.198097642278299e-05
------------iteration 1700----------
total loss 0.11474777013063431
loss_r_feature 0.7929450273513794
main criterion 4.072472802363336e-05
------------iteration 1800----------
total loss 0.08767466247081757
loss_r_feature 0.42429661750793457
main criterion 4.207107122056186e-05
------------iteration 1900----------
total loss 0.08252187818288803
loss_r_feature 0.40950798988342285
main criterion 0.00010883439244935289
------------iteration 2000----------
total loss 0.0788620188832283
loss_r_feature 0.3559037744998932
main criterion 5.13823761139065e-05
------------iteration 2100----------
total loss 0.626003623008728
loss_r_feature 2.4737863540649414
main criterion 0.002206588163971901
------------iteration 2200----------
total loss 0.5260775685310364
loss_r_feature 1.7593584060668945
main criterion 0.0019873413257300854
------------iteration 2300----------
total loss 0.4634034037590027
loss_r_feature 1.8859999179840088
main criterion 0.0004279417044017464
------------iteration 2400----------
total loss 0.4486406445503235
loss_r_feature 1.6027569770812988
main criterion 0.0005920316325500607
------------iteration 2500----------
total loss 0.34533801674842834
loss_r_feature 1.540033221244812
main criterion 0.0012956472346559167
------------iteration 2600----------
total loss 0.2923010289669037
loss_r_feature 1.2648868560791016
main criterion 0.0002110273635480553
------------iteration 2700----------
total loss 0.23035411536693573
loss_r_feature 1.0386464595794678
main criterion 4.369376983959228e-05
------------iteration 2800----------
total loss 0.19898761808872223
loss_r_feature 1.3112248182296753
main criterion 8.406517008552328e-05
------------iteration 2900----------
total loss 0.12537533044815063
loss_r_feature 0.5027967095375061
main criterion 9.153589053312317e-05
------------iteration 3000----------
total loss 0.11512550711631775
loss_r_feature 0.458858460187912
main criterion 0.00014920247485861182
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_22', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=22, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 22 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0114206075668335
loss_r_feature 2.888411283493042
main criterion 0.40778523683547974
------------iteration 200----------
total loss 0.6711994409561157
loss_r_feature 2.055558919906616
main criterion 0.06727787107229233
------------iteration 300----------
total loss 0.606827437877655
loss_r_feature 1.4968605041503906
main criterion 0.07871054857969284
------------iteration 400----------
total loss 0.4736471474170685
loss_r_feature 1.127955436706543
main criterion 0.014302889816462994
------------iteration 500----------
total loss 0.43339625000953674
loss_r_feature 0.963348388671875
main criterion 0.008206257596611977
------------iteration 600----------
total loss 0.3844856321811676
loss_r_feature 0.9738085269927979
main criterion 0.0012923616450279951
------------iteration 700----------
total loss 0.36669930815696716
loss_r_feature 1.136757493019104
main criterion 0.032679956406354904
------------iteration 800----------
total loss 0.3096630275249481
loss_r_feature 0.6215996742248535
main criterion 0.004367745015770197
------------iteration 900----------
total loss 0.2801903188228607
loss_r_feature 0.5599356293678284
main criterion 0.0007270427304320037
------------iteration 1000----------
total loss 0.24527914822101593
loss_r_feature 0.7338600754737854
main criterion 0.0002847145078703761
------------iteration 1100----------
total loss 0.23376019299030304
loss_r_feature 0.678842306137085
main criterion 0.00016435713041573763
------------iteration 1200----------
total loss 0.22998200356960297
loss_r_feature 1.0342190265655518
main criterion 0.0003205066022928804
------------iteration 1300----------
total loss 0.16060875356197357
loss_r_feature 0.39698755741119385
main criterion 0.00015257812628988177
------------iteration 1400----------
total loss 0.15043243765830994
loss_r_feature 0.41858726739883423
main criterion 0.00044050856376998127
------------iteration 1500----------
total loss 0.12874086201190948
loss_r_feature 0.534470796585083
main criterion 6.45899199298583e-05
------------iteration 1600----------
total loss 0.10392002016305923
loss_r_feature 0.4236696660518646
main criterion 9.338418021798134e-05
------------iteration 1700----------
total loss 0.08201045542955399
loss_r_feature 0.26277434825897217
main criterion 0.00011577416444197297
------------iteration 1800----------
total loss 0.06932050734758377
loss_r_feature 0.22182801365852356
main criterion 4.336607162258588e-05
------------iteration 1900----------
total loss 0.06245208531618118
loss_r_feature 0.19789275527000427
main criterion 4.33527457062155e-05
------------iteration 2000----------
total loss 0.0587720163166523
loss_r_feature 0.14640478789806366
main criterion 3.3220079785678536e-05
------------iteration 2100----------
total loss 0.6457537412643433
loss_r_feature 1.1001800298690796
main criterion 0.02241368591785431
------------iteration 2200----------
total loss 0.5188577175140381
loss_r_feature 0.9093594551086426
main criterion 0.0003025745099876076
------------iteration 2300----------
total loss 0.42899346351623535
loss_r_feature 1.2137056589126587
main criterion 0.0001421298220520839
------------iteration 2400----------
total loss 0.41938474774360657
loss_r_feature 1.1441988945007324
main criterion 0.0009449791978113353
------------iteration 2500----------
total loss 0.35687586665153503
loss_r_feature 1.3253934383392334
main criterion 0.0004908522241748869
------------iteration 2600----------
total loss 0.29760465025901794
loss_r_feature 0.7915779948234558
main criterion 0.0001196935772895813
------------iteration 2700----------
total loss 0.2135692834854126
loss_r_feature 0.8307940363883972
main criterion 4.246170283295214e-05
------------iteration 2800----------
total loss 0.15037649869918823
loss_r_feature 0.5612749457359314
main criterion 6.485101039288566e-05
------------iteration 2900----------
total loss 0.09637655317783356
loss_r_feature 0.2703961133956909
main criterion 9.742948896018788e-05
------------iteration 3000----------
total loss 0.08107263594865799
loss_r_feature 0.14950254559516907
main criterion 9.652170410845429e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_23', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=23, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 23 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1661477088928223
loss_r_feature 1.9736599922180176
main criterion 0.595223069190979
------------iteration 200----------
total loss 0.6462829113006592
loss_r_feature 1.2877072095870972
main criterion 0.06737373769283295
------------iteration 300----------
total loss 0.4301724433898926
loss_r_feature 0.34709635376930237
main criterion 0.02102166786789894
------------iteration 400----------
total loss 0.6050434112548828
loss_r_feature 0.4047234356403351
main criterion 0.1928766965866089
------------iteration 500----------
total loss 0.4116148352622986
loss_r_feature 0.41925275325775146
main criterion 0.01925615966320038
------------iteration 600----------
total loss 0.3425717353820801
loss_r_feature 0.5142785310745239
main criterion 0.0007556054042652249
------------iteration 700----------
total loss 0.324878066778183
loss_r_feature 0.5507448315620422
main criterion 0.0009925728663802147
------------iteration 800----------
total loss 0.2928365170955658
loss_r_feature 0.2642143964767456
main criterion 0.0017897601937875152
------------iteration 900----------
total loss 0.3491784930229187
loss_r_feature 0.20969116687774658
main criterion 0.11270958185195923
------------iteration 1000----------
total loss 0.23182068765163422
loss_r_feature 0.20562976598739624
main criterion 0.00017213930550497025
------------iteration 1100----------
total loss 0.22401629388332367
loss_r_feature 0.252521812915802
main criterion 0.0032515397761017084
------------iteration 1200----------
total loss 0.20930445194244385
loss_r_feature 0.7308009266853333
main criterion 0.007211838383227587
------------iteration 1300----------
total loss 0.15063856542110443
loss_r_feature 0.3281412720680237
main criterion 0.000152215565321967
------------iteration 1400----------
total loss 0.13852562010288239
loss_r_feature 0.5937904715538025
main criterion 0.0002255953149870038
------------iteration 1500----------
total loss 0.10222861170768738
loss_r_feature 0.2982816696166992
main criterion 0.00015236085164360702
------------iteration 1600----------
total loss 0.08371828496456146
loss_r_feature 0.2518691420555115
main criterion 0.00011970854393439367
------------iteration 1700----------
total loss 0.07145138829946518
loss_r_feature 0.2977088391780853
main criterion 8.178821735782549e-05
------------iteration 1800----------
total loss 0.055588383227586746
loss_r_feature 0.1884300708770752
main criterion 6.200007192092016e-05
------------iteration 1900----------
total loss 0.044933125376701355
loss_r_feature 0.08570540696382523
main criterion 3.931625178665854e-05
------------iteration 2000----------
total loss 0.04216349869966507
loss_r_feature 0.050916239619255066
main criterion 3.070903767365962e-05
------------iteration 2100----------
total loss 0.6526878476142883
loss_r_feature 0.48596832156181335
main criterion 0.011603367514908314
------------iteration 2200----------
total loss 0.45771828293800354
loss_r_feature 0.5314895510673523
main criterion 0.0004601155815180391
------------iteration 2300----------
total loss 0.39711645245552063
loss_r_feature 0.7354846596717834
main criterion 0.0007434189319610596
------------iteration 2400----------
total loss 0.40057095885276794
loss_r_feature 0.6132196187973022
main criterion 0.0027236072346568108
------------iteration 2500----------
total loss 0.30257588624954224
loss_r_feature 0.6183826327323914
main criterion 0.000989800551906228
------------iteration 2600----------
total loss 0.2251245379447937
loss_r_feature 0.3925195038318634
main criterion 0.00021336400823201984
------------iteration 2700----------
total loss 0.1593237817287445
loss_r_feature 0.42325592041015625
main criterion 9.587012755218893e-05
------------iteration 2800----------
total loss 0.11043594777584076
loss_r_feature 0.34306061267852783
main criterion 0.00025233413907699287
------------iteration 2900----------
total loss 0.07787391543388367
loss_r_feature 0.3338771462440491
main criterion 6.496532296296209e-05
------------iteration 3000----------
total loss 0.05561724677681923
loss_r_feature 0.06486281752586365
main criterion 7.050335261737928e-05
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_24', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=24, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 24 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.3860901594161987
loss_r_feature 13.191665649414062
main criterion 0.29078689217567444
------------iteration 200----------
total loss 1.1584511995315552
loss_r_feature 12.735519409179688
main criterion 0.022773869335651398
------------iteration 300----------
total loss 0.951363205909729
loss_r_feature 9.923393249511719
main criterion 0.0016489221015945077
------------iteration 400----------
total loss 0.7721797823905945
loss_r_feature 7.502176284790039
main criterion 0.0094570592045784
------------iteration 500----------
total loss 0.7265758514404297
loss_r_feature 6.917996883392334
main criterion 0.016976960003376007
------------iteration 600----------
total loss 0.7505531907081604
loss_r_feature 5.902789115905762
main criterion 0.11671952903270721
------------iteration 700----------
total loss 0.5626339912414551
loss_r_feature 5.056774616241455
main criterion 0.0012518324656412005
------------iteration 800----------
total loss 0.5384591817855835
loss_r_feature 4.834009647369385
main criterion 0.017786875367164612
------------iteration 900----------
total loss 0.4177248477935791
loss_r_feature 3.506903648376465
main criterion 0.00034278869861736894
------------iteration 1000----------
total loss 0.3764709532260895
loss_r_feature 3.364560842514038
main criterion 0.00018288787396159023
------------iteration 1100----------
total loss 0.3381091058254242
loss_r_feature 2.8332161903381348
main criterion 0.0004190963227301836
------------iteration 1200----------
total loss 0.35821226239204407
loss_r_feature 3.6148910522460938
main criterion 0.0011164442403241992
------------iteration 1300----------
total loss 0.27052754163742065
loss_r_feature 2.3375771045684814
main criterion 8.361347863683477e-05
------------iteration 1400----------
total loss 0.2508760988712311
loss_r_feature 2.204906940460205
main criterion 0.00013238420069683343
------------iteration 1500----------
total loss 0.21676553785800934
loss_r_feature 1.878743290901184
main criterion 7.675343658775091e-05
------------iteration 1600----------
total loss 0.1998170018196106
loss_r_feature 1.8373156785964966
main criterion 9.891856461763382e-05
------------iteration 1700----------
total loss 0.16512753069400787
loss_r_feature 1.356645941734314
main criterion 0.0001138257939601317
------------iteration 1800----------
total loss 0.1415434330701828
loss_r_feature 1.0562394857406616
main criterion 6.015272083459422e-05
------------iteration 1900----------
total loss 0.1316501945257187
loss_r_feature 0.9470481276512146
main criterion 9.135634172707796e-05
------------iteration 2000----------
total loss 0.1277090609073639
loss_r_feature 0.8883798122406006
main criterion 5.081813287688419e-05
------------iteration 2100----------
total loss 0.698982834815979
loss_r_feature 4.969085693359375
main criterion 0.012414325959980488
------------iteration 2200----------
total loss 0.7599813938140869
loss_r_feature 4.896678924560547
main criterion 0.0012909425422549248
------------iteration 2300----------
total loss 0.6034301519393921
loss_r_feature 4.23154878616333
main criterion 0.0010624630376696587
------------iteration 2400----------
total loss 0.5223793983459473
loss_r_feature 3.373117208480835
main criterion 0.0006158069591037929
------------iteration 2500----------
total loss 0.5373884439468384
loss_r_feature 3.9990293979644775
main criterion 0.00027044606395065784
------------iteration 2600----------
total loss 0.41414371132850647
loss_r_feature 2.9144158363342285
main criterion 0.00040939211612567306
------------iteration 2700----------
total loss 0.33019116520881653
loss_r_feature 2.090453624725342
main criterion 8.036774670472369e-05
------------iteration 2800----------
total loss 0.2808891534805298
loss_r_feature 2.1847245693206787
main criterion 0.00013686770398635417
------------iteration 2900----------
total loss 0.19359925389289856
loss_r_feature 1.091618537902832
main criterion 0.00017539015971124172
------------iteration 3000----------
total loss 0.1793842762708664
loss_r_feature 0.9924283623695374
main criterion 0.00020088357268832624
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_25', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=25, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 25 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.5388330221176147
loss_r_feature 12.493906021118164
main criterion 0.46084466576576233
------------iteration 200----------
total loss 0.975034773349762
loss_r_feature 5.021520137786865
main criterion 0.24476711452007294
------------iteration 300----------
total loss 0.68326735496521
loss_r_feature 4.300561904907227
main criterion 0.008976840414106846
------------iteration 400----------
total loss 0.6242383122444153
loss_r_feature 3.599452018737793
main criterion 0.013898828066885471
------------iteration 500----------
total loss 0.5727705955505371
loss_r_feature 3.1997852325439453
main criterion 0.00034992204746231437
------------iteration 600----------
total loss 0.6700297594070435
loss_r_feature 4.5756425857543945
main criterion 0.034723713994026184
------------iteration 700----------
total loss 0.566836953163147
loss_r_feature 3.5889389514923096
main criterion 0.0008718724129721522
------------iteration 800----------
total loss 0.5131220817565918
loss_r_feature 2.790684700012207
main criterion 0.00033687445102259517
------------iteration 900----------
total loss 0.46239450573921204
loss_r_feature 2.208697557449341
main criterion 0.00012104414054192603
------------iteration 1000----------
total loss 0.46086686849594116
loss_r_feature 2.543832302093506
main criterion 0.0002621496969368309
------------iteration 1100----------
total loss 0.47869351506233215
loss_r_feature 3.333625316619873
main criterion 0.0021087813656777143
------------iteration 1200----------
total loss 0.43123775720596313
loss_r_feature 2.883063554763794
main criterion 0.0004762682656291872
------------iteration 1300----------
total loss 0.3992549180984497
loss_r_feature 2.676938533782959
main criterion 0.0005394970066845417
------------iteration 1400----------
total loss 0.35294309258461
loss_r_feature 2.152498722076416
main criterion 0.00017018670041579753
------------iteration 1500----------
total loss 0.28025567531585693
loss_r_feature 1.1638091802597046
main criterion 0.0001393730053678155
------------iteration 1600----------
total loss 0.2606361210346222
loss_r_feature 1.1934982538223267
main criterion 0.00014529371401295066
------------iteration 1700----------
total loss 0.22940091788768768
loss_r_feature 0.9421296119689941
main criterion 0.0001406278315698728
------------iteration 1800----------
total loss 0.20399808883666992
loss_r_feature 0.7016563415527344
main criterion 7.998835644684732e-05
------------iteration 1900----------
total loss 0.1979658603668213
loss_r_feature 0.7159887552261353
main criterion 0.00011264342901995406
------------iteration 2000----------
total loss 0.19507089257240295
loss_r_feature 0.6835051774978638
main criterion 0.00011202815221622586
------------iteration 2100----------
total loss 0.7564057111740112
loss_r_feature 4.392971992492676
main criterion 0.0013313662493601441
------------iteration 2200----------
total loss 0.7730552554130554
loss_r_feature 3.3691391944885254
main criterion 0.00023742837947793305
------------iteration 2300----------
total loss 0.7600994110107422
loss_r_feature 3.566389322280884
main criterion 0.0018728742143139243
------------iteration 2400----------
total loss 0.7719350457191467
loss_r_feature 3.4276490211486816
main criterion 0.0036344067193567753
------------iteration 2500----------
total loss 0.6324716806411743
loss_r_feature 2.500419855117798
main criterion 0.0007547247223556042
------------iteration 2600----------
total loss 0.6557735204696655
loss_r_feature 4.293970108032227
main criterion 0.000403907208237797
------------iteration 2700----------
total loss 0.4482089877128601
loss_r_feature 1.4700895547866821
main criterion 0.00017806814867071807
------------iteration 2800----------
total loss 0.36502593755722046
loss_r_feature 1.2687410116195679
main criterion 0.00048622084432281554
------------iteration 2900----------
total loss 0.31330668926239014
loss_r_feature 1.2245713472366333
main criterion 0.0002278393949382007
------------iteration 3000----------
total loss 0.270718514919281
loss_r_feature 0.6193464398384094
main criterion 0.00020288270025048405
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_26', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=26, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 26 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.1432808637619019
loss_r_feature 8.885952949523926
main criterion 0.23791217803955078
------------iteration 200----------
total loss 0.7516736388206482
loss_r_feature 4.586673259735107
main criterion 0.004323406144976616
------------iteration 300----------
total loss 0.61025071144104
loss_r_feature 2.346993923187256
main criterion 0.0486559197306633
------------iteration 400----------
total loss 0.5811926126480103
loss_r_feature 2.717386484146118
main criterion 0.043429624289274216
------------iteration 500----------
total loss 0.4950554370880127
loss_r_feature 2.0311479568481445
main criterion 0.0015532122924923897
------------iteration 600----------
total loss 0.5640190243721008
loss_r_feature 2.2136144638061523
main criterion 0.06805886328220367
------------iteration 700----------
total loss 0.49448227882385254
loss_r_feature 2.448338031768799
main criterion 0.0008220227318815887
------------iteration 800----------
total loss 0.43491435050964355
loss_r_feature 1.5656702518463135
main criterion 0.004359631333500147
------------iteration 900----------
total loss 0.4043385982513428
loss_r_feature 1.4583353996276855
main criterion 0.00014482211554422975
------------iteration 1000----------
total loss 0.43088671565055847
loss_r_feature 2.336015462875366
main criterion 0.0002827573334798217
------------iteration 1100----------
total loss 0.3574315309524536
loss_r_feature 1.44686758518219
main criterion 0.00010169288725592196
------------iteration 1200----------
total loss 0.3870258629322052
loss_r_feature 2.453303098678589
main criterion 0.00013037887401878834
------------iteration 1300----------
total loss 0.3357856273651123
loss_r_feature 1.4842015504837036
main criterion 0.021293049678206444
------------iteration 1400----------
total loss 0.3037900924682617
loss_r_feature 1.6859440803527832
main criterion 0.0001058592606568709
------------iteration 1500----------
total loss 0.25000709295272827
loss_r_feature 1.0778807401657104
main criterion 9.670836152508855e-05
------------iteration 1600----------
total loss 0.22887831926345825
loss_r_feature 1.0837173461914062
main criterion 0.00021634864970110357
------------iteration 1700----------
total loss 0.2078833132982254
loss_r_feature 1.018376111984253
main criterion 7.949598511913791e-05
------------iteration 1800----------
total loss 0.1651003211736679
loss_r_feature 0.41954246163368225
main criterion 5.183390385354869e-05
------------iteration 1900----------
total loss 0.1618613749742508
loss_r_feature 0.4816770553588867
main criterion 8.088662434602156e-05
------------iteration 2000----------
total loss 0.1553518921136856
loss_r_feature 0.37525445222854614
main criterion 4.327166243456304e-05
------------iteration 2100----------
total loss 0.6741870641708374
loss_r_feature 2.650331497192383
main criterion 0.0009598555625416338
------------iteration 2200----------
total loss 0.6608127355575562
loss_r_feature 1.8230552673339844
main criterion 0.00029106313013471663
------------iteration 2300----------
total loss 0.7339485883712769
loss_r_feature 2.813656806945801
main criterion 0.00035477944766171277
------------iteration 2400----------
total loss 0.6622889637947083
loss_r_feature 2.156688690185547
main criterion 0.0005043669370934367
------------iteration 2500----------
total loss 0.5913785696029663
loss_r_feature 2.1155645847320557
main criterion 0.0004086426633875817
------------iteration 2600----------
total loss 0.465212881565094
loss_r_feature 1.357295274734497
main criterion 0.00031087579554878175
------------iteration 2700----------
total loss 0.3752102553844452
loss_r_feature 1.0676298141479492
main criterion 0.00012114273704355583
------------iteration 2800----------
total loss 0.2976522445678711
loss_r_feature 0.8691800832748413
main criterion 0.00013307100743986666
------------iteration 2900----------
total loss 0.2418675422668457
loss_r_feature 0.757837176322937
main criterion 0.0002105798339471221
------------iteration 3000----------
total loss 0.2178073227405548
loss_r_feature 0.5093864798545837
main criterion 0.00016091759607661515
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_27', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=27, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 27 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.164329767227173
loss_r_feature 27.621286392211914
main criterion 0.34453949332237244
------------iteration 200----------
total loss 1.7192209959030151
loss_r_feature 25.30421257019043
main criterion 0.004685840103775263
------------iteration 300----------
total loss 1.518675684928894
loss_r_feature 22.142122268676758
main criterion 0.010333994403481483
------------iteration 400----------
total loss 1.4107638597488403
loss_r_feature 20.226591110229492
main criterion 0.022036025300621986
------------iteration 500----------
total loss 1.2240943908691406
loss_r_feature 17.590776443481445
main criterion 0.0019030615221709013
------------iteration 600----------
total loss 1.1599063873291016
loss_r_feature 16.448423385620117
main criterion 0.013682788237929344
------------iteration 700----------
total loss 0.9213688373565674
loss_r_feature 12.90506362915039
main criterion 0.018645765259861946
------------iteration 800----------
total loss 1.0008608102798462
loss_r_feature 14.306365966796875
main criterion 0.008686360903084278
------------iteration 900----------
total loss 0.7130814790725708
loss_r_feature 9.911735534667969
main criterion 0.0006414088420569897
------------iteration 1000----------
total loss 0.7014446258544922
loss_r_feature 9.712532997131348
main criterion 0.0014506331644952297
------------iteration 1100----------
total loss 0.49865806102752686
loss_r_feature 6.5399885177612305
main criterion 0.0024509085342288017
------------iteration 1200----------
total loss 0.40392163395881653
loss_r_feature 5.11464786529541
main criterion 0.0004956555785611272
------------iteration 1300----------
total loss 0.34922584891319275
loss_r_feature 4.1661858558654785
main criterion 0.001064329408109188
------------iteration 1400----------
total loss 0.30472198128700256
loss_r_feature 3.5281059741973877
main criterion 0.00021988463413435966
------------iteration 1500----------
total loss 0.28714001178741455
loss_r_feature 3.4198641777038574
main criterion 0.0001298300630878657
------------iteration 1600----------
total loss 0.21975232660770416
loss_r_feature 2.1788489818573
main criterion 0.00021973688853904605
------------iteration 1700----------
total loss 0.23546874523162842
loss_r_feature 2.581331729888916
main criterion 0.00016052316641435027
------------iteration 1800----------
total loss 0.18919365108013153
loss_r_feature 1.719834804534912
main criterion 0.00015098390576895326
------------iteration 1900----------
total loss 0.1852618008852005
loss_r_feature 1.6723320484161377
main criterion 0.00014457253564614803
------------iteration 2000----------
total loss 0.17710545659065247
loss_r_feature 1.5184404850006104
main criterion 0.00014656540588475764
------------iteration 2100----------
total loss 1.184483528137207
loss_r_feature 12.524785041809082
main criterion 0.09221901744604111
------------iteration 2200----------
total loss 0.880168080329895
loss_r_feature 10.057613372802734
main criterion 0.0005116316606290638
------------iteration 2300----------
total loss 0.7324774265289307
loss_r_feature 8.324103355407715
main criterion 0.0004183097917120904
------------iteration 2400----------
total loss 0.6436196565628052
loss_r_feature 7.246735095977783
main criterion 0.0007210674812085927
------------iteration 2500----------
total loss 0.5410544276237488
loss_r_feature 5.656628608703613
main criterion 0.0005069093895144761
------------iteration 2600----------
total loss 0.4649977385997772
loss_r_feature 4.531431674957275
main criterion 0.000408575520850718
------------iteration 2700----------
total loss 0.3946106433868408
loss_r_feature 3.6232686042785645
main criterion 0.00028268268215470016
------------iteration 2800----------
total loss 0.3154982328414917
loss_r_feature 2.500401496887207
main criterion 0.0002850929740816355
------------iteration 2900----------
total loss 0.25493869185447693
loss_r_feature 1.5774880647659302
main criterion 0.00018185774388257414
------------iteration 3000----------
total loss 0.24581339955329895
loss_r_feature 1.471453309059143
main criterion 0.0003064274205826223
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_28', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=28, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 28 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.6368283033370972
loss_r_feature 18.523906707763672
main criterion 0.259440541267395
------------iteration 200----------
total loss 1.3984593152999878
loss_r_feature 16.68907356262207
main criterion 0.07283304631710052
------------iteration 300----------
total loss 1.091247797012329
loss_r_feature 13.318915367126465
main criterion 0.004433995112776756
------------iteration 400----------
total loss 1.0275673866271973
loss_r_feature 11.645750045776367
main criterion 0.04850592464208603
------------iteration 500----------
total loss 1.0050612688064575
loss_r_feature 11.897205352783203
main criterion 0.01765057072043419
------------iteration 600----------
total loss 1.0102872848510742
loss_r_feature 10.748291969299316
main criterion 0.1149405837059021
------------iteration 700----------
total loss 0.8201009631156921
loss_r_feature 8.476869583129883
main criterion 0.09186305105686188
------------iteration 800----------
total loss 0.5961863398551941
loss_r_feature 6.809703826904297
main criterion 0.0017985380254685879
------------iteration 900----------
total loss 0.5965885519981384
loss_r_feature 6.607473373413086
main criterion 0.0008841114467941225
------------iteration 1000----------
total loss 0.49174878001213074
loss_r_feature 5.126592636108398
main criterion 0.0210279431194067
------------iteration 1100----------
total loss 0.4134945869445801
loss_r_feature 4.271697521209717
main criterion 0.0036610316019505262
------------iteration 1200----------
total loss 0.39522990584373474
loss_r_feature 4.239086151123047
main criterion 0.0010799458250403404
------------iteration 1300----------
total loss 0.3154522776603699
loss_r_feature 3.0590522289276123
main criterion 0.000421672040829435
------------iteration 1400----------
total loss 0.27588167786598206
loss_r_feature 2.547048568725586
main criterion 0.00035460537765175104
------------iteration 1500----------
total loss 0.26563769578933716
loss_r_feature 2.5661227703094482
main criterion 0.0003168440598528832
------------iteration 1600----------
total loss 0.22408567368984222
loss_r_feature 1.9400734901428223
main criterion 0.00018955941777676344
------------iteration 1700----------
total loss 0.2011936753988266
loss_r_feature 1.6549359560012817
main criterion 0.0001895427267299965
------------iteration 1800----------
total loss 0.1592293530702591
loss_r_feature 0.9541630744934082
main criterion 0.00015944727056194097
------------iteration 1900----------
total loss 0.14925183355808258
loss_r_feature 0.8286304473876953
main criterion 0.0002091538772219792
------------iteration 2000----------
total loss 0.14558355510234833
loss_r_feature 0.7677459716796875
main criterion 0.0004040852072648704
------------iteration 2100----------
total loss 0.8283506631851196
loss_r_feature 7.053196430206299
main criterion 0.011685801669955254
------------iteration 2200----------
total loss 0.7528442144393921
loss_r_feature 6.200225353240967
main criterion 0.0017921901308000088
------------iteration 2300----------
total loss 0.7013047337532043
loss_r_feature 6.252121925354004
main criterion 0.0008379244245588779
------------iteration 2400----------
total loss 0.6538766622543335
loss_r_feature 5.578950881958008
main criterion 0.0019288905896246433
------------iteration 2500----------
total loss 0.5455703139305115
loss_r_feature 4.267802715301514
main criterion 0.0007012138376012444
------------iteration 2600----------
total loss 0.46605730056762695
loss_r_feature 3.5001511573791504
main criterion 0.00047381705371662974
------------iteration 2700----------
total loss 0.36042988300323486
loss_r_feature 2.341054916381836
main criterion 0.000249951786827296
------------iteration 2800----------
total loss 0.3082500994205475
loss_r_feature 1.9900894165039062
main criterion 0.0006041092565283179
------------iteration 2900----------
total loss 0.24788810312747955
loss_r_feature 1.3231086730957031
main criterion 0.0006190434796735644
------------iteration 3000----------
total loss 0.21380551159381866
loss_r_feature 0.7968980669975281
main criterion 0.0004002319765277207
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_29', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=29, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 29 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0885672569274902
loss_r_feature 11.207079887390137
main criterion 0.08829089254140854
------------iteration 200----------
total loss 0.81541508436203
loss_r_feature 7.114843368530273
main criterion 0.02233944833278656
------------iteration 300----------
total loss 0.808281421661377
loss_r_feature 6.616528511047363
main criterion 0.06654372811317444
------------iteration 400----------
total loss 0.6988037824630737
loss_r_feature 5.999662399291992
main criterion 0.001349963597021997
------------iteration 500----------
total loss 0.6415947079658508
loss_r_feature 5.521063327789307
main criterion 0.0005698339082300663
------------iteration 600----------
total loss 0.7060512900352478
loss_r_feature 5.654284477233887
main criterion 0.08651131391525269
------------iteration 700----------
total loss 0.5325959920883179
loss_r_feature 4.445341110229492
main criterion 0.0007745058392174542
------------iteration 800----------
total loss 0.5470938682556152
loss_r_feature 4.671879291534424
main criterion 0.013925663195550442
------------iteration 900----------
total loss 0.4669196605682373
loss_r_feature 3.9153237342834473
main criterion 0.00018478742276784033
------------iteration 1000----------
total loss 0.43969792127609253
loss_r_feature 3.7388973236083984
main criterion 0.0007194816716946661
------------iteration 1100----------
total loss 0.42896056175231934
loss_r_feature 3.8202130794525146
main criterion 0.0007821316248737276
------------iteration 1200----------
total loss 0.4355998933315277
loss_r_feature 4.492307186126709
main criterion 0.001860315795056522
------------iteration 1300----------
total loss 0.34002968668937683
loss_r_feature 2.8693535327911377
main criterion 0.0006547588855028152
------------iteration 1400----------
total loss 0.2998490035533905
loss_r_feature 2.5007917881011963
main criterion 0.00030378156225197017
------------iteration 1500----------
total loss 0.27833497524261475
loss_r_feature 2.5071091651916504
main criterion 0.00033926780452020466
------------iteration 1600----------
total loss 0.23994013667106628
loss_r_feature 2.017758369445801
main criterion 0.00028813519747927785
------------iteration 1700----------
total loss 0.21808281540870667
loss_r_feature 1.8495745658874512
main criterion 0.0001909413986140862
------------iteration 1800----------
total loss 0.18598781526088715
loss_r_feature 1.4030649662017822
main criterion 0.00025836139684543014
------------iteration 1900----------
total loss 0.17776618897914886
loss_r_feature 1.348702311515808
main criterion 0.00017760458285920322
------------iteration 2000----------
total loss 0.16999606788158417
loss_r_feature 1.214600920677185
main criterion 0.00027666770620271564
------------iteration 2100----------
total loss 0.8615757822990417
loss_r_feature 4.94703483581543
main criterion 0.0066543747670948505
------------iteration 2200----------
total loss 0.6892108917236328
loss_r_feature 3.6175875663757324
main criterion 0.00023021384549792856
------------iteration 2300----------
total loss 0.6824578642845154
loss_r_feature 4.220697402954102
main criterion 0.001678326865658164
------------iteration 2400----------
total loss 0.7262388467788696
loss_r_feature 4.717228889465332
main criterion 0.001454592333175242
------------iteration 2500----------
total loss 0.6067512631416321
loss_r_feature 3.648174285888672
main criterion 0.00034186686389148235
------------iteration 2600----------
total loss 0.5100940465927124
loss_r_feature 3.10505747795105
main criterion 0.0005933110369369388
------------iteration 2700----------
total loss 0.39256975054740906
loss_r_feature 2.0066256523132324
main criterion 0.00024256583128590137
------------iteration 2800----------
total loss 0.30028414726257324
loss_r_feature 1.2375848293304443
main criterion 0.0002698675380088389
------------iteration 2900----------
total loss 0.24523481726646423
loss_r_feature 0.8805912137031555
main criterion 0.0002562555018812418
------------iteration 3000----------
total loss 0.23121590912342072
loss_r_feature 0.7968699932098389
main criterion 0.00048267265083268285
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_30', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=30, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 30 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7948565483093262
loss_r_feature 4.370081901550293
main criterion 0.14140887558460236
------------iteration 200----------
total loss 0.6675189733505249
loss_r_feature 3.6010704040527344
main criterion 0.003942760173231363
------------iteration 300----------
total loss 0.5339828133583069
loss_r_feature 2.4849770069122314
main criterion 0.008916383609175682
------------iteration 400----------
total loss 0.5038232803344727
loss_r_feature 2.313258647918701
main criterion 0.006059365812689066
------------iteration 500----------
total loss 0.5586514472961426
loss_r_feature 2.1634600162506104
main criterion 0.07357095927000046
------------iteration 600----------
total loss 0.47657036781311035
loss_r_feature 2.522432565689087
main criterion 0.0035300322342664003
------------iteration 700----------
total loss 0.4217972755432129
loss_r_feature 1.832031011581421
main criterion 0.0003246446722187102
------------iteration 800----------
total loss 0.4174399971961975
loss_r_feature 2.173776149749756
main criterion 0.001942262751981616
------------iteration 900----------
total loss 0.33482053875923157
loss_r_feature 1.4090404510498047
main criterion 0.0002525422314647585
------------iteration 1000----------
total loss 0.34428176283836365
loss_r_feature 1.6766185760498047
main criterion 0.0007773925899527967
------------iteration 1100----------
total loss 0.3030661642551422
loss_r_feature 1.5966440439224243
main criterion 0.00011367574916221201
------------iteration 1200----------
total loss 0.2850062847137451
loss_r_feature 1.6976120471954346
main criterion 0.0001710031065158546
------------iteration 1300----------
total loss 0.2321249395608902
loss_r_feature 1.0870070457458496
main criterion 0.00024065544130280614
------------iteration 1400----------
total loss 0.20725472271442413
loss_r_feature 0.9968899488449097
main criterion 0.00033079073182307184
------------iteration 1500----------
total loss 0.1890401393175125
loss_r_feature 0.9775651097297668
main criterion 0.0038144581485539675
------------iteration 1600----------
total loss 0.19579178094863892
loss_r_feature 1.517260193824768
main criterion 0.00012083409092156217
------------iteration 1700----------
total loss 0.14907890558242798
loss_r_feature 0.9056341648101807
main criterion 0.0002297109749633819
------------iteration 1800----------
total loss 0.1232709288597107
loss_r_feature 0.6286946535110474
main criterion 9.217452316079289e-05
------------iteration 1900----------
total loss 0.11575009673833847
loss_r_feature 0.6081579923629761
main criterion 0.00011544134758878499
------------iteration 2000----------
total loss 0.1136203184723854
loss_r_feature 0.5917794108390808
main criterion 6.482921162387356e-05
------------iteration 2100----------
total loss 0.7025930285453796
loss_r_feature 2.4500064849853516
main criterion 0.0019987025298178196
------------iteration 2200----------
total loss 0.6498757004737854
loss_r_feature 1.8315107822418213
main criterion 0.0007831311668269336
------------iteration 2300----------
total loss 0.5694162249565125
loss_r_feature 1.9411749839782715
main criterion 0.0006332759512588382
------------iteration 2400----------
total loss 0.5366824269294739
loss_r_feature 1.8443026542663574
main criterion 0.001567687140777707
------------iteration 2500----------
total loss 0.46707701683044434
loss_r_feature 1.7359298467636108
main criterion 0.00039527969784103334
------------iteration 2600----------
total loss 0.38120943307876587
loss_r_feature 1.3593047857284546
main criterion 0.0003461865126155317
------------iteration 2700----------
total loss 0.2893141806125641
loss_r_feature 0.8098629117012024
main criterion 0.00023662651074118912
------------iteration 2800----------
total loss 0.22940868139266968
loss_r_feature 0.7529342174530029
main criterion 0.000180652248673141
------------iteration 2900----------
total loss 0.17019349336624146
loss_r_feature 0.4177957773208618
main criterion 0.0001813441631384194
------------iteration 3000----------
total loss 0.1577989012002945
loss_r_feature 0.37832844257354736
main criterion 0.0002866807335522026
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_31', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=31, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 31 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0295392274856567
loss_r_feature 9.059928894042969
main criterion 0.11395539343357086
------------iteration 200----------
total loss 0.8060781359672546
loss_r_feature 6.374005317687988
main criterion 0.009799746796488762
------------iteration 300----------
total loss 0.5863980054855347
loss_r_feature 4.206864356994629
main criterion 0.01508577261120081
------------iteration 400----------
total loss 0.5351271033287048
loss_r_feature 3.860654830932617
main criterion 0.004152262583374977
------------iteration 500----------
total loss 0.5203057527542114
loss_r_feature 3.550140857696533
main criterion 0.0001722900487948209
------------iteration 600----------
total loss 0.5629897713661194
loss_r_feature 4.128895282745361
main criterion 0.02909168228507042
------------iteration 700----------
total loss 0.4316280782222748
loss_r_feature 3.003009796142578
main criterion 0.0004061406943947077
------------iteration 800----------
total loss 0.5423642992973328
loss_r_feature 3.301485538482666
main criterion 0.08931185305118561
------------iteration 900----------
total loss 0.3706361651420593
loss_r_feature 2.4153974056243896
main criterion 0.00014430430019274354
------------iteration 1000----------
total loss 0.39911335706710815
loss_r_feature 2.3237130641937256
main criterion 0.04168161377310753
------------iteration 1100----------
total loss 0.3794940114021301
loss_r_feature 2.3709776401519775
main criterion 0.035208817571401596
------------iteration 1200----------
total loss 0.3263947367668152
loss_r_feature 2.468966007232666
main criterion 0.0004843405040446669
------------iteration 1300----------
total loss 0.26794713735580444
loss_r_feature 1.7970471382141113
main criterion 0.00022186411661095917
------------iteration 1400----------
total loss 0.24758468568325043
loss_r_feature 1.718427062034607
main criterion 0.00013134672190062702
------------iteration 1500----------
total loss 0.2330569475889206
loss_r_feature 1.838902473449707
main criterion 0.00012664833047892898
------------iteration 1600----------
total loss 0.19096560776233673
loss_r_feature 1.3069640398025513
main criterion 0.00020214890537317842
------------iteration 1700----------
total loss 0.16639356315135956
loss_r_feature 1.0813418626785278
main criterion 9.583064093021676e-05
------------iteration 1800----------
total loss 0.14595484733581543
loss_r_feature 0.8834018707275391
main criterion 0.00014190966612659395
------------iteration 1900----------
total loss 0.13353699445724487
loss_r_feature 0.7470848560333252
main criterion 0.00014310050755739212
------------iteration 2000----------
total loss 0.12885986268520355
loss_r_feature 0.6777013540267944
main criterion 0.00015032589726615697
------------iteration 2100----------
total loss 0.6136760115623474
loss_r_feature 3.328488826751709
main criterion 0.0011732997372746468
------------iteration 2200----------
total loss 0.5965965390205383
loss_r_feature 2.939426898956299
main criterion 0.0002958193945232779
------------iteration 2300----------
total loss 0.599371612071991
loss_r_feature 3.2154700756073
main criterion 0.000427713937824592
------------iteration 2400----------
total loss 0.5686722993850708
loss_r_feature 2.681279182434082
main criterion 0.00083822978194803
------------iteration 2500----------
total loss 0.5008592009544373
loss_r_feature 2.438314437866211
main criterion 0.00029241121956147254
------------iteration 2600----------
total loss 0.39569076895713806
loss_r_feature 1.665743350982666
main criterion 0.0003626075922511518
------------iteration 2700----------
total loss 0.32775411009788513
loss_r_feature 1.4958137273788452
main criterion 0.0001749633956933394
------------iteration 2800----------
total loss 0.2503761947154999
loss_r_feature 1.032379388809204
main criterion 0.0001762410392984748
------------iteration 2900----------
total loss 0.19765914976596832
loss_r_feature 0.7530582547187805
main criterion 0.0001650244666961953
------------iteration 3000----------
total loss 0.18127967417240143
loss_r_feature 0.6290273666381836
main criterion 0.00023800015333108604
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_32', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=32, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 32 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.9623804092407227
loss_r_feature 5.051393985748291
main criterion 0.2395763099193573
------------iteration 200----------
total loss 0.6217530369758606
loss_r_feature 2.847135305404663
main criterion 0.0072818598710000515
------------iteration 300----------
total loss 0.6045018434524536
loss_r_feature 2.686721086502075
main criterion 0.014780748635530472
------------iteration 400----------
total loss 0.5947935581207275
loss_r_feature 2.8686208724975586
main criterion 0.0467153862118721
------------iteration 500----------
total loss 0.49492812156677246
loss_r_feature 1.7905956506729126
main criterion 0.0042306906543672085
------------iteration 600----------
total loss 0.5156427621841431
loss_r_feature 2.4215328693389893
main criterion 0.006132406648248434
------------iteration 700----------
total loss 0.5174201130867004
loss_r_feature 2.7990875244140625
main criterion 0.02358977124094963
------------iteration 800----------
total loss 0.4661373794078827
loss_r_feature 1.8969740867614746
main criterion 0.016600212082266808
------------iteration 900----------
total loss 0.40030592679977417
loss_r_feature 1.4791779518127441
main criterion 0.0005195230478420854
------------iteration 1000----------
total loss 0.41977792978286743
loss_r_feature 2.5196146965026855
main criterion 0.0003719264059327543
------------iteration 1100----------
total loss 0.3356665372848511
loss_r_feature 1.1971622705459595
main criterion 0.00044956005876883864
------------iteration 1200----------
total loss 0.32999032735824585
loss_r_feature 1.6426115036010742
main criterion 0.0005700307665392756
------------iteration 1300----------
total loss 0.3172812759876251
loss_r_feature 1.8037011623382568
main criterion 0.00016017661255318671
------------iteration 1400----------
total loss 0.34748175740242004
loss_r_feature 2.121145486831665
main criterion 0.044404711574316025
------------iteration 1500----------
total loss 0.24809086322784424
loss_r_feature 1.5197625160217285
main criterion 0.00013589023728854954
------------iteration 1600----------
total loss 0.20086903870105743
loss_r_feature 1.0133535861968994
main criterion 0.0001723892637528479
------------iteration 1700----------
total loss 0.17244431376457214
loss_r_feature 0.8170883655548096
main criterion 7.882280624471605e-05
------------iteration 1800----------
total loss 0.163238525390625
loss_r_feature 0.8861488699913025
main criterion 0.00011965929297730327
------------iteration 1900----------
total loss 0.14007160067558289
loss_r_feature 0.5632697343826294
main criterion 0.00013804214540868998
------------iteration 2000----------
total loss 0.13588184118270874
loss_r_feature 0.5066928863525391
main criterion 0.00010773607937153429
------------iteration 2100----------
total loss 0.6221297383308411
loss_r_feature 2.4059150218963623
main criterion 0.001251980080269277
------------iteration 2200----------
total loss 0.6860210299491882
loss_r_feature 1.9295090436935425
main criterion 0.0004356255230959505
------------iteration 2300----------
total loss 0.6460676789283752
loss_r_feature 1.9328285455703735
main criterion 0.0007320066215470433
------------iteration 2400----------
total loss 0.6387999057769775
loss_r_feature 1.7282873392105103
main criterion 0.005351657047867775
------------iteration 2500----------
total loss 0.5434892773628235
loss_r_feature 1.7505574226379395
main criterion 0.0006289415759965777
------------iteration 2600----------
total loss 0.46298351883888245
loss_r_feature 1.8319028615951538
main criterion 0.0005032464978285134
------------iteration 2700----------
total loss 0.35716187953948975
loss_r_feature 1.0640685558319092
main criterion 0.00027033541118726134
------------iteration 2800----------
total loss 0.28521448373794556
loss_r_feature 0.9499651193618774
main criterion 0.0002827508142217994
------------iteration 2900----------
total loss 0.2208532840013504
loss_r_feature 0.6672245264053345
main criterion 0.00019340708968229592
------------iteration 3000----------
total loss 0.1944396197795868
loss_r_feature 0.3586295247077942
main criterion 0.0002855349739547819
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_33', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=33, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 33 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2268338203430176
loss_r_feature 1.948363184928894
main criterion 0.6887885332107544
------------iteration 200----------
total loss 0.6853032112121582
loss_r_feature 1.653446912765503
main criterion 0.0785711482167244
------------iteration 300----------
total loss 0.5256543755531311
loss_r_feature 0.9576265811920166
main criterion 0.027635809034109116
------------iteration 400----------
total loss 0.4572324752807617
loss_r_feature 0.842688798904419
main criterion 0.008528852835297585
------------iteration 500----------
total loss 0.416865736246109
loss_r_feature 0.5521784424781799
main criterion 0.003702460555359721
------------iteration 600----------
total loss 0.4002154469490051
loss_r_feature 0.6104040741920471
main criterion 0.0011850239243358374
------------iteration 700----------
total loss 0.34169480204582214
loss_r_feature 0.6369513869285583
main criterion 0.0001837521995184943
------------iteration 800----------
total loss 0.37411442399024963
loss_r_feature 0.8081232905387878
main criterion 0.029679162427783012
------------iteration 900----------
total loss 0.2933001220226288
loss_r_feature 0.43558216094970703
main criterion 0.00022793676180299371
------------iteration 1000----------
total loss 0.27641674876213074
loss_r_feature 0.5407180786132812
main criterion 0.0004978510551154613
------------iteration 1100----------
total loss 0.25225621461868286
loss_r_feature 0.47097933292388916
main criterion 0.0004759047587867826
------------iteration 1200----------
total loss 0.23602545261383057
loss_r_feature 0.8328315019607544
main criterion 0.0022928116377443075
------------iteration 1300----------
total loss 0.18074318766593933
loss_r_feature 0.33008649945259094
main criterion 0.00026168650947511196
------------iteration 1400----------
total loss 0.16453039646148682
loss_r_feature 0.3799433708190918
main criterion 0.00013611390022560954
------------iteration 1500----------
total loss 0.14700768887996674
loss_r_feature 0.49722057580947876
main criterion 0.0001369940728181973
------------iteration 1600----------
total loss 0.12655195593833923
loss_r_feature 0.4713403582572937
main criterion 0.00012138469173805788
------------iteration 1700----------
total loss 0.10639610141515732
loss_r_feature 0.38944122195243835
main criterion 7.334366819122806e-05
------------iteration 1800----------
total loss 0.0865529403090477
loss_r_feature 0.2294766753911972
main criterion 6.147220847196877e-05
------------iteration 1900----------
total loss 0.07701916247606277
loss_r_feature 0.15970087051391602
main criterion 6.837416003691033e-05
------------iteration 2000----------
total loss 0.07817789167165756
loss_r_feature 0.20621103048324585
main criterion 5.503400825546123e-05
------------iteration 2100----------
total loss 0.5530926585197449
loss_r_feature 0.6634473204612732
main criterion 0.003622130723670125
------------iteration 2200----------
total loss 0.458609014749527
loss_r_feature 0.5163000226020813
main criterion 0.0007333406247198582
------------iteration 2300----------
total loss 0.4484357237815857
loss_r_feature 0.9629931449890137
main criterion 0.0018775304779410362
------------iteration 2400----------
total loss 0.41716092824935913
loss_r_feature 0.5619868636131287
main criterion 0.0008923953282646835
------------iteration 2500----------
total loss 0.36919647455215454
loss_r_feature 0.7191573977470398
main criterion 0.0004015464801341295
------------iteration 2600----------
total loss 0.2986307144165039
loss_r_feature 0.579026997089386
main criterion 0.0005027670995332301
------------iteration 2700----------
total loss 0.237040713429451
loss_r_feature 0.680578351020813
main criterion 0.00018493396055418998
------------iteration 2800----------
total loss 0.158763125538826
loss_r_feature 0.25691643357276917
main criterion 0.00015675641770940274
------------iteration 2900----------
total loss 0.1163378357887268
loss_r_feature 0.2385212779045105
main criterion 0.00013329288049135357
------------iteration 3000----------
total loss 0.10068171471357346
loss_r_feature 0.13630342483520508
main criterion 0.00018320012895856053
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_34', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=34, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 34 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.383976936340332
loss_r_feature 6.9060378074646
main criterion 0.5720489621162415
------------iteration 200----------
total loss 0.7874308228492737
loss_r_feature 5.463850498199463
main criterion 0.005216260440647602
------------iteration 300----------
total loss 0.7456067800521851
loss_r_feature 4.3534255027771
main criterion 0.08784878253936768
------------iteration 400----------
total loss 0.6094326376914978
loss_r_feature 3.748354911804199
main criterion 0.01923401653766632
------------iteration 500----------
total loss 0.5264381170272827
loss_r_feature 3.038984537124634
main criterion 0.01823098212480545
------------iteration 600----------
total loss 0.49196141958236694
loss_r_feature 3.1899092197418213
main criterion 0.004090281669050455
------------iteration 700----------
total loss 0.5546630620956421
loss_r_feature 2.6412181854248047
main criterion 0.10604139417409897
------------iteration 800----------
total loss 0.4282720983028412
loss_r_feature 2.656970262527466
main criterion 0.013109053485095501
------------iteration 900----------
total loss 0.3924381136894226
loss_r_feature 2.316131353378296
main criterion 0.00017280358588322997
------------iteration 1000----------
total loss 0.37443649768829346
loss_r_feature 2.0960607528686523
main criterion 0.005438324995338917
------------iteration 1100----------
total loss 0.3566074073314667
loss_r_feature 2.127689838409424
main criterion 0.012081671506166458
------------iteration 1200----------
total loss 0.3187761902809143
loss_r_feature 2.2704033851623535
main criterion 0.0007978829671628773
------------iteration 1300----------
total loss 0.2672324478626251
loss_r_feature 1.5878702402114868
main criterion 0.00018619575712364167
------------iteration 1400----------
total loss 0.2512664198875427
loss_r_feature 1.6735596656799316
main criterion 0.00018930489022750407
------------iteration 1500----------
total loss 0.2070552408695221
loss_r_feature 1.2285003662109375
main criterion 0.000202085793716833
------------iteration 1600----------
total loss 0.18927176296710968
loss_r_feature 1.1670914888381958
main criterion 0.00017596037650946528
------------iteration 1700----------
total loss 0.15942980349063873
loss_r_feature 0.8573205471038818
main criterion 0.00014389808347914368
------------iteration 1800----------
total loss 0.14227619767189026
loss_r_feature 0.7436844706535339
main criterion 0.00012883002636954188
------------iteration 1900----------
total loss 0.13309158384799957
loss_r_feature 0.6811598539352417
main criterion 0.0001276957045774907
------------iteration 2000----------
total loss 0.12543748319149017
loss_r_feature 0.5521457195281982
main criterion 0.00013086479157209396
------------iteration 2100----------
total loss 0.5950928926467896
loss_r_feature 2.7985615730285645
main criterion 0.0016285090241581202
------------iteration 2200----------
total loss 0.615365207195282
loss_r_feature 2.298830509185791
main criterion 0.00046612872392870486
------------iteration 2300----------
total loss 0.5240527391433716
loss_r_feature 1.7896409034729004
main criterion 0.00046251824824139476
------------iteration 2400----------
total loss 0.5728539228439331
loss_r_feature 2.3240489959716797
main criterion 0.0005691570113413036
------------iteration 2500----------
total loss 0.4753280282020569
loss_r_feature 1.877020001411438
main criterion 0.0011382887605577707
------------iteration 2600----------
total loss 0.4066840410232544
loss_r_feature 1.5315884351730347
main criterion 0.0004038309562020004
------------iteration 2700----------
total loss 0.31946825981140137
loss_r_feature 1.1036003828048706
main criterion 0.0001694226375548169
------------iteration 2800----------
total loss 0.25187909603118896
loss_r_feature 0.901578426361084
main criterion 0.0003131074772682041
------------iteration 2900----------
total loss 0.19497933983802795
loss_r_feature 0.6141223907470703
main criterion 0.0002377829805482179
------------iteration 3000----------
total loss 0.17789103090763092
loss_r_feature 0.5116543769836426
main criterion 0.0002758874907158315
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_35', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=35, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 35 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0374512672424316
loss_r_feature 3.923654556274414
main criterion 0.37131208181381226
------------iteration 200----------
total loss 0.7946223020553589
loss_r_feature 2.3412957191467285
main criterion 0.15880563855171204
------------iteration 300----------
total loss 0.5933624505996704
loss_r_feature 1.9765033721923828
main criterion 0.04795612022280693
------------iteration 400----------
total loss 0.5219446420669556
loss_r_feature 1.7047441005706787
main criterion 0.0034260426182299852
------------iteration 500----------
total loss 0.49415352940559387
loss_r_feature 1.4999967813491821
main criterion 0.005237913690507412
------------iteration 600----------
total loss 0.4684646427631378
loss_r_feature 1.55890691280365
main criterion 0.012549949809908867
------------iteration 700----------
total loss 0.4909394681453705
loss_r_feature 2.005842924118042
main criterion 0.022340795025229454
------------iteration 800----------
total loss 0.42159679532051086
loss_r_feature 1.7442089319229126
main criterion 0.005543073173612356
------------iteration 900----------
total loss 0.37738651037216187
loss_r_feature 1.1139363050460815
main criterion 0.0006991744739934802
------------iteration 1000----------
total loss 0.36131685972213745
loss_r_feature 1.265434980392456
main criterion 0.0005899709649384022
------------iteration 1100----------
total loss 0.32558581233024597
loss_r_feature 1.0773093700408936
main criterion 0.0012509948574006557
------------iteration 1200----------
total loss 0.33405202627182007
loss_r_feature 1.8053886890411377
main criterion 0.0009811966447159648
------------iteration 1300----------
total loss 0.2754161059856415
loss_r_feature 1.2269724607467651
main criterion 0.00024007562024053186
------------iteration 1400----------
total loss 0.2506972551345825
loss_r_feature 1.1647170782089233
main criterion 0.0012933786492794752
------------iteration 1500----------
total loss 0.20682436227798462
loss_r_feature 0.8086260557174683
main criterion 0.00011149306374136358
------------iteration 1600----------
total loss 0.17396864295005798
loss_r_feature 0.6078817248344421
main criterion 0.0002081781130982563
------------iteration 1700----------
total loss 0.152887761592865
loss_r_feature 0.5444961190223694
main criterion 0.00041925240657292306
------------iteration 1800----------
total loss 0.14357994496822357
loss_r_feature 0.6206167340278625
main criterion 0.00014053669292479753
------------iteration 1900----------
total loss 0.12551191449165344
loss_r_feature 0.39581701159477234
main criterion 0.0001688346965238452
------------iteration 2000----------
total loss 0.12221480160951614
loss_r_feature 0.35803383588790894
main criterion 9.387625323142856e-05
------------iteration 2100----------
total loss 0.6690840721130371
loss_r_feature 1.9839982986450195
main criterion 0.007684692740440369
------------iteration 2200----------
total loss 0.6550644040107727
loss_r_feature 1.3407843112945557
main criterion 0.0007120421505533159
------------iteration 2300----------
total loss 0.6179162263870239
loss_r_feature 1.1808037757873535
main criterion 0.0005598965217359364
------------iteration 2400----------
total loss 0.5924009084701538
loss_r_feature 1.3604748249053955
main criterion 0.0018932627281174064
------------iteration 2500----------
total loss 0.5000599026679993
loss_r_feature 1.0643011331558228
main criterion 0.0006126732332631946
------------iteration 2600----------
total loss 0.415452241897583
loss_r_feature 0.7987605333328247
main criterion 0.0006036887061782181
------------iteration 2700----------
total loss 0.3502025902271271
loss_r_feature 0.9420932531356812
main criterion 0.0001788775116438046
------------iteration 2800----------
total loss 0.27060654759407043
loss_r_feature 0.757276177406311
main criterion 0.0002557618427090347
------------iteration 2900----------
total loss 0.21543550491333008
loss_r_feature 0.653735876083374
main criterion 0.0002052500785794109
------------iteration 3000----------
total loss 0.18557345867156982
loss_r_feature 0.2849111258983612
main criterion 0.00021885300520807505
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_36', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=36, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 36 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8194400072097778
loss_r_feature 2.051628589630127
main criterion 0.26207074522972107
------------iteration 200----------
total loss 0.7170805931091309
loss_r_feature 0.8644556403160095
main criterion 0.19025245308876038
------------iteration 300----------
total loss 0.6113941669464111
loss_r_feature 0.8276957869529724
main criterion 0.1618458330631256
------------iteration 400----------
total loss 0.46024155616760254
loss_r_feature 0.8236769437789917
main criterion 0.009626034647226334
------------iteration 500----------
total loss 0.4139723479747772
loss_r_feature 0.5206260681152344
main criterion 0.0006517532165162265
------------iteration 600----------
total loss 0.3993907868862152
loss_r_feature 0.7816004753112793
main criterion 0.0020323353819549084
------------iteration 700----------
total loss 0.4078837037086487
loss_r_feature 0.537772536277771
main criterion 0.04281674325466156
------------iteration 800----------
total loss 0.38071537017822266
loss_r_feature 0.8433166146278381
main criterion 0.022423727437853813
------------iteration 900----------
total loss 0.32203614711761475
loss_r_feature 0.5324328541755676
main criterion 0.0006873487727716565
------------iteration 1000----------
total loss 0.29090675711631775
loss_r_feature 0.5684167742729187
main criterion 0.0003092404513154179
------------iteration 1100----------
total loss 0.2693929672241211
loss_r_feature 0.4778026342391968
main criterion 0.00036236303276382387
------------iteration 1200----------
total loss 0.24399074912071228
loss_r_feature 0.6338706612586975
main criterion 0.0003647137782536447
------------iteration 1300----------
total loss 0.2034602016210556
loss_r_feature 0.33107995986938477
main criterion 0.0005928731989115477
------------iteration 1400----------
total loss 0.1726800799369812
loss_r_feature 0.30008915066719055
main criterion 0.0003269347071181983
------------iteration 1500----------
total loss 0.15158255398273468
loss_r_feature 0.3414255976676941
main criterion 0.0008200025768019259
------------iteration 1600----------
total loss 0.12797152996063232
loss_r_feature 0.26492777466773987
main criterion 0.00048722251085564494
------------iteration 1700----------
total loss 0.1102977767586708
loss_r_feature 0.26689741015434265
main criterion 0.00017411893350072205
------------iteration 1800----------
total loss 0.0997246652841568
loss_r_feature 0.3150809407234192
main criterion 8.380016515729949e-05
------------iteration 1900----------
total loss 0.09053058922290802
loss_r_feature 0.2587904930114746
main criterion 6.374647637130693e-05
------------iteration 2000----------
total loss 0.08275216817855835
loss_r_feature 0.12621688842773438
main criterion 4.4907174014952034e-05
------------iteration 2100----------
total loss 0.5391461849212646
loss_r_feature 0.7058441042900085
main criterion 0.0021934579126536846
------------iteration 2200----------
total loss 0.5477104783058167
loss_r_feature 0.652539074420929
main criterion 0.0015921161975711584
------------iteration 2300----------
total loss 0.48063865303993225
loss_r_feature 0.44381195306777954
main criterion 0.0006150967092253268
------------iteration 2400----------
total loss 0.4492175281047821
loss_r_feature 0.9774553179740906
main criterion 0.0011249829549342394
------------iteration 2500----------
total loss 0.401523232460022
loss_r_feature 0.716349184513092
main criterion 0.00043174787424504757
------------iteration 2600----------
total loss 0.33116769790649414
loss_r_feature 0.4744308590888977
main criterion 0.0003887981583829969
------------iteration 2700----------
total loss 0.25859615206718445
loss_r_feature 0.49023258686065674
main criterion 0.00014184901374392211
------------iteration 2800----------
total loss 0.19105379283428192
loss_r_feature 0.35696250200271606
main criterion 0.00019595919002313167
------------iteration 2900----------
total loss 0.13831762969493866
loss_r_feature 0.2402862310409546
main criterion 0.00018330368038732558
------------iteration 3000----------
total loss 0.12051782757043839
loss_r_feature 0.11861234158277512
main criterion 0.0001511634181952104
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_37', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=37, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 37 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0856090784072876
loss_r_feature 6.020116329193115
main criterion 0.33824726939201355
------------iteration 200----------
total loss 0.8548520803451538
loss_r_feature 4.799563884735107
main criterion 0.12975411117076874
------------iteration 300----------
total loss 0.6769339442253113
loss_r_feature 4.180239200592041
main criterion 0.019492503255605698
------------iteration 400----------
total loss 0.5933695435523987
loss_r_feature 3.3813462257385254
main criterion 0.024603035300970078
------------iteration 500----------
total loss 0.5571251511573792
loss_r_feature 3.0970144271850586
main criterion 0.017275836318731308
------------iteration 600----------
total loss 0.5065063834190369
loss_r_feature 3.1580300331115723
main criterion 0.001183083513751626
------------iteration 700----------
total loss 0.46803775429725647
loss_r_feature 2.344341278076172
main criterion 0.02840436063706875
------------iteration 800----------
total loss 0.4809632897377014
loss_r_feature 2.920236825942993
main criterion 0.014024709351360798
------------iteration 900----------
total loss 0.4210306406021118
loss_r_feature 2.398183822631836
main criterion 0.0004764875047840178
------------iteration 1000----------
total loss 0.36678969860076904
loss_r_feature 2.0748987197875977
main criterion 0.0005695835570804775
------------iteration 1100----------
total loss 0.368007630109787
loss_r_feature 2.320701837539673
main criterion 0.0010098787024617195
------------iteration 1200----------
total loss 0.3295718729496002
loss_r_feature 2.231283664703369
main criterion 0.0009407746838405728
------------iteration 1300----------
total loss 0.26534149050712585
loss_r_feature 1.3936935663223267
main criterion 0.00027772606699727476
------------iteration 1400----------
total loss 0.2503346800804138
loss_r_feature 1.518860101699829
main criterion 0.00022492019343189895
------------iteration 1500----------
total loss 0.21020440757274628
loss_r_feature 1.1527354717254639
main criterion 0.0002627140493132174
------------iteration 1600----------
total loss 0.20012611150741577
loss_r_feature 1.3102854490280151
main criterion 0.00033034212538041174
------------iteration 1700----------
total loss 0.16374365985393524
loss_r_feature 0.8749767541885376
main criterion 0.00023699161829426885
------------iteration 1800----------
total loss 0.14001251757144928
loss_r_feature 0.6264400482177734
main criterion 0.00011750293924706057
------------iteration 1900----------
total loss 0.12957772612571716
loss_r_feature 0.5416072010993958
main criterion 0.00019651201728265733
------------iteration 2000----------
total loss 0.1251319944858551
loss_r_feature 0.47693368792533875
main criterion 0.00022336884285323322
------------iteration 2100----------
total loss 0.6441745758056641
loss_r_feature 2.541879177093506
main criterion 0.0013021910563111305
------------iteration 2200----------
total loss 0.5980311036109924
loss_r_feature 2.447650671005249
main criterion 0.000625775835942477
------------iteration 2300----------
total loss 0.5956934094429016
loss_r_feature 2.411038875579834
main criterion 0.002980067627504468
------------iteration 2400----------
total loss 0.5896978378295898
loss_r_feature 2.217214584350586
main criterion 0.0016112144803628325
------------iteration 2500----------
total loss 0.4881341755390167
loss_r_feature 1.5183831453323364
main criterion 0.000634629453998059
------------iteration 2600----------
total loss 0.4022912085056305
loss_r_feature 1.2836366891860962
main criterion 0.00036820568493567407
------------iteration 2700----------
total loss 0.3198625445365906
loss_r_feature 0.985794186592102
main criterion 0.0002406756393611431
------------iteration 2800----------
total loss 0.2578026354312897
loss_r_feature 0.9152451157569885
main criterion 0.0003119163156952709
------------iteration 2900----------
total loss 0.20837193727493286
loss_r_feature 0.7296034693717957
main criterion 0.00027476256946101785
------------iteration 3000----------
total loss 0.18187303841114044
loss_r_feature 0.4168339967727661
main criterion 0.0003213456948287785
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_38', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=38, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 38 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.736511766910553
loss_r_feature 3.419969320297241
main criterion 0.12365199625492096
------------iteration 200----------
total loss 0.6194760799407959
loss_r_feature 2.373319149017334
main criterion 0.008343687281012535
------------iteration 300----------
total loss 0.6023663282394409
loss_r_feature 2.0816805362701416
main criterion 0.05528819561004639
------------iteration 400----------
total loss 0.5517528057098389
loss_r_feature 1.7741246223449707
main criterion 0.028228357434272766
------------iteration 500----------
total loss 0.47863131761550903
loss_r_feature 1.6517360210418701
main criterion 0.0038019237108528614
------------iteration 600----------
total loss 0.45572200417518616
loss_r_feature 1.4176506996154785
main criterion 0.00034785130992531776
------------iteration 700----------
total loss 0.47052323818206787
loss_r_feature 2.0302436351776123
main criterion 0.008264772593975067
------------iteration 800----------
total loss 0.43666231632232666
loss_r_feature 1.7134119272232056
main criterion 0.01104734092950821
------------iteration 900----------
total loss 0.37508636713027954
loss_r_feature 1.080023169517517
main criterion 0.0007535899640060961
------------iteration 1000----------
total loss 0.38468244671821594
loss_r_feature 1.680537462234497
main criterion 0.008596292696893215
------------iteration 1100----------
total loss 0.32043173909187317
loss_r_feature 1.102702021598816
main criterion 0.0006465856567956507
------------iteration 1200----------
total loss 0.307594895362854
loss_r_feature 1.3802647590637207
main criterion 0.0003718626976478845
------------iteration 1300----------
total loss 0.25056493282318115
loss_r_feature 0.8074480891227722
main criterion 0.000612633943092078
------------iteration 1400----------
total loss 0.23279839754104614
loss_r_feature 0.9477100372314453
main criterion 0.0012378435349091887
------------iteration 1500----------
total loss 0.20247730612754822
loss_r_feature 0.8403642177581787
main criterion 0.00020929600577801466
------------iteration 1600----------
total loss 0.18267624080181122
loss_r_feature 0.8404611945152283
main criterion 0.0002542324655223638
------------iteration 1700----------
total loss 0.14786292612552643
loss_r_feature 0.5215983390808105
main criterion 0.00021651622955687344
------------iteration 1800----------
total loss 0.13811095058918
loss_r_feature 0.5810747146606445
main criterion 8.299740875372663e-05
------------iteration 1900----------
total loss 0.12359102070331573
loss_r_feature 0.4332873821258545
main criterion 0.00019529140263330191
------------iteration 2000----------
total loss 0.11853483319282532
loss_r_feature 0.3600326478481293
main criterion 0.00014548136095982045
------------iteration 2100----------
total loss 0.6665159463882446
loss_r_feature 1.501453161239624
main criterion 0.0011774717131629586
------------iteration 2200----------
total loss 0.6343335509300232
loss_r_feature 1.4112679958343506
main criterion 0.000620171194896102
------------iteration 2300----------
total loss 0.5904871821403503
loss_r_feature 1.0450955629348755
main criterion 0.0008500415133312345
------------iteration 2400----------
total loss 0.5944546461105347
loss_r_feature 1.7225064039230347
main criterion 0.0021423473954200745
------------iteration 2500----------
total loss 0.510686457157135
loss_r_feature 1.2720597982406616
main criterion 0.0007282636943273246
------------iteration 2600----------
total loss 0.4082740545272827
loss_r_feature 0.8895735740661621
main criterion 0.00043965756776742637
------------iteration 2700----------
total loss 0.36540138721466064
loss_r_feature 1.3964234590530396
main criterion 0.0005007613799534738
------------iteration 2800----------
total loss 0.2598792612552643
loss_r_feature 0.6804461479187012
main criterion 0.0004093172901775688
------------iteration 2900----------
total loss 0.19703564047813416
loss_r_feature 0.355429083108902
main criterion 0.0003292188630439341
------------iteration 3000----------
total loss 0.1825585663318634
loss_r_feature 0.3001466691493988
main criterion 0.0003575031296350062
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_39', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=39, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 39 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8219105005264282
loss_r_feature 1.5520493984222412
main criterion 0.30233731865882874
------------iteration 200----------
total loss 0.5320078134536743
loss_r_feature 0.9622326493263245
main criterion 0.002148709027096629
------------iteration 300----------
total loss 0.4955873489379883
loss_r_feature 0.8536200523376465
main criterion 0.007650807499885559
------------iteration 400----------
total loss 0.43578702211380005
loss_r_feature 0.7969314455986023
main criterion 0.003207882633432746
------------iteration 500----------
total loss 0.43995794653892517
loss_r_feature 0.623434841632843
main criterion 0.021644655615091324
------------iteration 600----------
total loss 0.433604896068573
loss_r_feature 0.717656672000885
main criterion 0.01119222305715084
------------iteration 700----------
total loss 0.3803376853466034
loss_r_feature 0.7157396078109741
main criterion 0.0009504513000138104
------------iteration 800----------
total loss 0.3724827170372009
loss_r_feature 0.606644332408905
main criterion 0.024531342089176178
------------iteration 900----------
total loss 0.3353179395198822
loss_r_feature 0.47709032893180847
main criterion 0.007199933752417564
------------iteration 1000----------
total loss 0.300920307636261
loss_r_feature 0.4955553412437439
main criterion 0.001656358246691525
------------iteration 1100----------
total loss 0.28101515769958496
loss_r_feature 0.4445688724517822
main criterion 0.0010418175952509046
------------iteration 1200----------
total loss 0.23369966447353363
loss_r_feature 0.3544810712337494
main criterion 0.00018547529180068523
------------iteration 1300----------
total loss 0.20140717923641205
loss_r_feature 0.30476251244544983
main criterion 0.0003723373229149729
------------iteration 1400----------
total loss 0.19517271220684052
loss_r_feature 0.5873932242393494
main criterion 0.00040611991425976157
------------iteration 1500----------
total loss 0.15960493683815002
loss_r_feature 0.33048078417778015
main criterion 0.00015943059406708926
------------iteration 1600----------
total loss 0.1563597321510315
loss_r_feature 0.7389997243881226
main criterion 0.0010215870570391417
------------iteration 1700----------
total loss 0.11412211507558823
loss_r_feature 0.24603323638439178
main criterion 0.00014019843365531415
------------iteration 1800----------
total loss 0.09732585400342941
loss_r_feature 0.16928431391716003
main criterion 0.00014226527127902955
------------iteration 1900----------
total loss 0.09437364339828491
loss_r_feature 0.23115161061286926
main criterion 0.0009470095974393189
------------iteration 2000----------
total loss 0.08756453543901443
loss_r_feature 0.13543671369552612
main criterion 0.00012084604531992227
------------iteration 2100----------
total loss 0.6701877117156982
loss_r_feature 0.973866879940033
main criterion 0.002384910359978676
------------iteration 2200----------
total loss 0.5907394886016846
loss_r_feature 0.6412439346313477
main criterion 0.0006370588089339435
------------iteration 2300----------
total loss 0.5269913077354431
loss_r_feature 0.8670526146888733
main criterion 0.0006770928739570081
------------iteration 2400----------
total loss 0.48838746547698975
loss_r_feature 0.44647717475891113
main criterion 0.0012930163647979498
------------iteration 2500----------
total loss 0.40738385915756226
loss_r_feature 0.45137062668800354
main criterion 0.00037752219941467047
------------iteration 2600----------
total loss 0.34651538729667664
loss_r_feature 0.44200584292411804
main criterion 0.0004990115994587541
------------iteration 2700----------
total loss 0.2854284644126892
loss_r_feature 0.7557135224342346
main criterion 0.00023939163656905293
------------iteration 2800----------
total loss 0.19132129848003387
loss_r_feature 0.2560959756374359
main criterion 0.00020047205907758325
------------iteration 2900----------
total loss 0.14376164972782135
loss_r_feature 0.19858136773109436
main criterion 0.00021379065583460033
------------iteration 3000----------
total loss 0.12792626023292542
loss_r_feature 0.11799484491348267
main criterion 0.00019482418429106474
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_40', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=40, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 40 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.5346319675445557
loss_r_feature 7.147717475891113
main criterion 0.7076255083084106
------------iteration 200----------
total loss 0.7802518010139465
loss_r_feature 5.389214515686035
main criterion 0.015944581478834152
------------iteration 300----------
total loss 0.6401456594467163
loss_r_feature 4.0090651512146
main criterion 0.026401028037071228
------------iteration 400----------
total loss 0.7238117456436157
loss_r_feature 3.534041404724121
main criterion 0.1556285321712494
------------iteration 500----------
total loss 0.49971017241477966
loss_r_feature 2.8979477882385254
main criterion 0.000546485825907439
------------iteration 600----------
total loss 0.6158909797668457
loss_r_feature 3.3253085613250732
main criterion 0.07269835472106934
------------iteration 700----------
total loss 0.48471584916114807
loss_r_feature 2.7513811588287354
main criterion 0.0035628783516585827
------------iteration 800----------
total loss 0.4763287901878357
loss_r_feature 2.6875293254852295
main criterion 0.0402379035949707
------------iteration 900----------
total loss 0.4154694676399231
loss_r_feature 2.30830454826355
main criterion 0.0004949283902533352
------------iteration 1000----------
total loss 0.3629165589809418
loss_r_feature 1.9599474668502808
main criterion 0.00047362130135297775
------------iteration 1100----------
total loss 0.3418678343296051
loss_r_feature 1.770303726196289
main criterion 0.013348866254091263
------------iteration 1200----------
total loss 0.34190621972084045
loss_r_feature 2.411165237426758
main criterion 0.004914386197924614
------------iteration 1300----------
total loss 0.2660805881023407
loss_r_feature 1.3789269924163818
main criterion 0.0003501614846754819
------------iteration 1400----------
total loss 0.24561187624931335
loss_r_feature 1.3901454210281372
main criterion 0.0002799014328047633
------------iteration 1500----------
total loss 0.24007369577884674
loss_r_feature 1.704228401184082
main criterion 0.0006967287044972181
------------iteration 1600----------
total loss 0.1848551630973816
loss_r_feature 0.9235255718231201
main criterion 0.00023185776080936193
------------iteration 1700----------
total loss 0.16578179597854614
loss_r_feature 0.8150991201400757
main criterion 0.0006846253527328372
------------iteration 1800----------
total loss 0.14249952137470245
loss_r_feature 0.5679337382316589
main criterion 0.00019708073523361236
------------iteration 1900----------
total loss 0.13513071835041046
loss_r_feature 0.5324234962463379
main criterion 0.00019799874280579388
------------iteration 2000----------
total loss 0.13267183303833008
loss_r_feature 0.5023385286331177
main criterion 0.0003087075019720942
------------iteration 2100----------
total loss 0.6246498227119446
loss_r_feature 2.9282217025756836
main criterion 0.0015793029451742768
------------iteration 2200----------
total loss 0.5509270429611206
loss_r_feature 1.7823070287704468
main criterion 0.0005541676073335111
------------iteration 2300----------
total loss 0.5696468353271484
loss_r_feature 1.9731324911117554
main criterion 0.0007938456255942583
------------iteration 2400----------
total loss 0.5453988313674927
loss_r_feature 2.0099875926971436
main criterion 0.0008827356505207717
------------iteration 2500----------
total loss 0.4977640211582184
loss_r_feature 1.5010790824890137
main criterion 0.0008127174805849791
------------iteration 2600----------
total loss 0.404596209526062
loss_r_feature 1.333702564239502
main criterion 0.0006521171890199184
------------iteration 2700----------
total loss 0.3277646005153656
loss_r_feature 1.1136001348495483
main criterion 0.00038349087117239833
------------iteration 2800----------
total loss 0.2577787935733795
loss_r_feature 0.8043035268783569
main criterion 0.00033998838625848293
------------iteration 2900----------
total loss 0.20144861936569214
loss_r_feature 0.5426204800605774
main criterion 0.00028751674108207226
------------iteration 3000----------
total loss 0.18415528535842896
loss_r_feature 0.40086084604263306
main criterion 0.0003145691298414022
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_41', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=41, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 41 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.260018229484558
loss_r_feature 4.790288925170898
main criterion 0.5684789419174194
------------iteration 200----------
total loss 0.7143657803535461
loss_r_feature 3.0253090858459473
main criterion 0.05454026535153389
------------iteration 300----------
total loss 0.6211830973625183
loss_r_feature 2.580756664276123
main criterion 0.017481373623013496
------------iteration 400----------
total loss 0.7330222129821777
loss_r_feature 2.083271026611328
main criterion 0.20060603320598602
------------iteration 500----------
total loss 0.5202153325080872
loss_r_feature 1.8385529518127441
main criterion 0.0010900095803663135
------------iteration 600----------
total loss 0.5267537832260132
loss_r_feature 2.004411458969116
main criterion 0.00908676814287901
------------iteration 700----------
total loss 0.4929962456226349
loss_r_feature 2.1282074451446533
main criterion 0.00047871057176962495
------------iteration 800----------
total loss 0.4594384729862213
loss_r_feature 1.7935385704040527
main criterion 0.0016684329602867365
------------iteration 900----------
total loss 0.4222097396850586
loss_r_feature 1.4960858821868896
main criterion 0.005602658726274967
------------iteration 1000----------
total loss 0.39613214135169983
loss_r_feature 1.5262343883514404
main criterion 0.0007303519523702562
------------iteration 1100----------
total loss 0.37526559829711914
loss_r_feature 1.48446786403656
main criterion 0.0008152585942298174
------------iteration 1200----------
total loss 0.35261300206184387
loss_r_feature 1.6624956130981445
main criterion 0.0004315119585953653
------------iteration 1300----------
total loss 0.3013665974140167
loss_r_feature 1.2193629741668701
main criterion 0.0004737877461593598
------------iteration 1400----------
total loss 0.27641093730926514
loss_r_feature 1.1682195663452148
main criterion 0.0003394316299818456
------------iteration 1500----------
total loss 0.2555978298187256
loss_r_feature 1.2586320638656616
main criterion 0.0004297019331716001
------------iteration 1600----------
total loss 0.2123926877975464
loss_r_feature 0.8238992094993591
main criterion 0.0002116898394888267
------------iteration 1700----------
total loss 0.18096815049648285
loss_r_feature 0.5712278485298157
main criterion 0.00022577529307454824
------------iteration 1800----------
total loss 0.17317599058151245
loss_r_feature 0.6700518727302551
main criterion 0.00014699042367283255
------------iteration 1900----------
total loss 0.15731866657733917
loss_r_feature 0.4921628534793854
main criterion 0.00015405759040731937
------------iteration 2000----------
total loss 0.15873771905899048
loss_r_feature 0.5439243912696838
main criterion 0.00020338466856628656
------------iteration 2100----------
total loss 0.7061185836791992
loss_r_feature 2.2680954933166504
main criterion 0.001033008680678904
------------iteration 2200----------
total loss 0.7308923006057739
loss_r_feature 1.781852126121521
main criterion 0.0016458624741062522
------------iteration 2300----------
total loss 0.6549455523490906
loss_r_feature 1.1960183382034302
main criterion 0.0010345322079956532
------------iteration 2400----------
total loss 0.6716736555099487
loss_r_feature 1.8853074312210083
main criterion 0.0030887045431882143
------------iteration 2500----------
total loss 0.5654546618461609
loss_r_feature 1.338189959526062
main criterion 0.0007365337805822492
------------iteration 2600----------
total loss 0.4894217550754547
loss_r_feature 1.3464964628219604
main criterion 0.0008900182438082993
------------iteration 2700----------
total loss 0.41081687808036804
loss_r_feature 1.4450716972351074
main criterion 0.0004225363954901695
------------iteration 2800----------
total loss 0.3230327367782593
loss_r_feature 0.9887769818305969
main criterion 0.0005978914559818804
------------iteration 2900----------
total loss 0.2561464011669159
loss_r_feature 0.6614780426025391
main criterion 0.00028502443456090987
------------iteration 3000----------
total loss 0.23057569563388824
loss_r_feature 0.3795492351055145
main criterion 0.0005444482667371631
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_42', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=42, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 42 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7691833972930908
loss_r_feature 2.606700897216797
main criterion 0.1720145046710968
------------iteration 200----------
total loss 0.6905443668365479
loss_r_feature 1.4530067443847656
main criterion 0.11728635430335999
------------iteration 300----------
total loss 0.5730528831481934
loss_r_feature 1.6257445812225342
main criterion 0.004498706199228764
------------iteration 400----------
total loss 0.5509694218635559
loss_r_feature 1.6529626846313477
main criterion 0.027939733117818832
------------iteration 500----------
total loss 0.4903371036052704
loss_r_feature 1.1812859773635864
main criterion 0.002835325663909316
------------iteration 600----------
total loss 0.4644981920719147
loss_r_feature 0.9892520904541016
main criterion 0.0008566868491470814
------------iteration 700----------
total loss 0.4287179708480835
loss_r_feature 0.9961899518966675
main criterion 0.00033951352816075087
------------iteration 800----------
total loss 0.512324333190918
loss_r_feature 1.6536052227020264
main criterion 0.06110091879963875
------------iteration 900----------
total loss 0.3965849280357361
loss_r_feature 0.814314603805542
main criterion 0.0006603026413358748
------------iteration 1000----------
total loss 0.35933107137680054
loss_r_feature 0.6384711265563965
main criterion 0.0006592766148969531
------------iteration 1100----------
total loss 0.34228214621543884
loss_r_feature 0.8455032706260681
main criterion 0.0013217412633821368
------------iteration 1200----------
total loss 0.2974242866039276
loss_r_feature 0.7759565711021423
main criterion 0.00029763771453872323
------------iteration 1300----------
total loss 0.28624531626701355
loss_r_feature 0.8735784888267517
main criterion 0.005474104546010494
------------iteration 1400----------
total loss 0.2360871136188507
loss_r_feature 0.5638473629951477
main criterion 0.00015320706006605178
------------iteration 1500----------
total loss 0.2094937264919281
loss_r_feature 0.464081734418869
main criterion 0.0002777277841232717
------------iteration 1600----------
total loss 0.1776014119386673
loss_r_feature 0.3794792592525482
main criterion 0.00025752256624400616
------------iteration 1700----------
total loss 0.1592578887939453
loss_r_feature 0.3271484076976776
main criterion 0.00043395019019953907
------------iteration 1800----------
total loss 0.14289233088493347
loss_r_feature 0.2667521834373474
main criterion 0.00015651543799322098
------------iteration 1900----------
total loss 0.135362446308136
loss_r_feature 0.24649091064929962
main criterion 0.00013823385233990848
------------iteration 2000----------
total loss 0.14250901341438293
loss_r_feature 0.4125960171222687
main criterion 0.00014919710520189255
------------iteration 2100----------
total loss 0.7539296746253967
loss_r_feature 1.78618323802948
main criterion 0.0031103091314435005
------------iteration 2200----------
total loss 0.6847875714302063
loss_r_feature 0.7053652405738831
main criterion 0.0008511270279996097
------------iteration 2300----------
total loss 0.6098402738571167
loss_r_feature 0.6450769305229187
main criterion 0.001088292570784688
------------iteration 2400----------
total loss 0.6146065592765808
loss_r_feature 1.5082520246505737
main criterion 0.003067890414968133
------------iteration 2500----------
total loss 0.5519008040428162
loss_r_feature 1.0197272300720215
main criterion 0.000604091736022383
------------iteration 2600----------
total loss 0.4379352927207947
loss_r_feature 0.8933994174003601
main criterion 0.0005597940180450678
------------iteration 2700----------
total loss 0.3449379801750183
loss_r_feature 0.43860912322998047
main criterion 0.00031715823570266366
------------iteration 2800----------
total loss 0.30418017506599426
loss_r_feature 0.9359883666038513
main criterion 0.00028965031378902495
------------iteration 2900----------
total loss 0.239170640707016
loss_r_feature 0.6659921407699585
main criterion 0.00020664121257141232
------------iteration 3000----------
total loss 0.20557600259780884
loss_r_feature 0.22886210680007935
main criterion 0.00029878938221372664
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_43', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=43, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 43 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.104135274887085
loss_r_feature 8.282196044921875
main criterion 0.2513139247894287
------------iteration 200----------
total loss 0.8169001340866089
loss_r_feature 6.721137046813965
main criterion 0.00646739499643445
------------iteration 300----------
total loss 0.7462944984436035
loss_r_feature 6.0683512687683105
main criterion 0.002768738893792033
------------iteration 400----------
total loss 0.7316105961799622
loss_r_feature 4.705561637878418
main criterion 0.08945735543966293
------------iteration 500----------
total loss 0.6038687229156494
loss_r_feature 4.492680549621582
main criterion 0.0007167853182181716
------------iteration 600----------
total loss 0.5701404213905334
loss_r_feature 4.231148719787598
main criterion 0.0005144791211932898
------------iteration 700----------
total loss 0.5361721515655518
loss_r_feature 3.8187310695648193
main criterion 0.0005482185515575111
------------iteration 800----------
total loss 0.5665467977523804
loss_r_feature 4.404002666473389
main criterion 0.0024190640542656183
------------iteration 900----------
total loss 0.4995393753051758
loss_r_feature 3.512376546859741
main criterion 0.0011867755092680454
------------iteration 1000----------
total loss 0.4881235361099243
loss_r_feature 3.7451071739196777
main criterion 0.003292676992714405
------------iteration 1100----------
total loss 0.43130508065223694
loss_r_feature 2.958254814147949
main criterion 0.0021968267392367125
------------iteration 1200----------
total loss 0.460199773311615
loss_r_feature 3.8487651348114014
main criterion 0.010217005386948586
------------iteration 1300----------
total loss 0.3754214346408844
loss_r_feature 2.8384456634521484
main criterion 0.0004828230885323137
------------iteration 1400----------
total loss 0.3189442455768585
loss_r_feature 2.1611757278442383
main criterion 0.0005234965356066823
------------iteration 1500----------
total loss 0.29809442162513733
loss_r_feature 2.1584649085998535
main criterion 0.0005083449650555849
------------iteration 1600----------
total loss 0.238448366522789
loss_r_feature 1.3875317573547363
main criterion 0.000534944876562804
------------iteration 1700----------
total loss 0.20994769036769867
loss_r_feature 1.1086736917495728
main criterion 0.0002742109354585409
------------iteration 1800----------
total loss 0.20806896686553955
loss_r_feature 1.3175232410430908
main criterion 0.0002528680779505521
------------iteration 1900----------
total loss 0.17736400663852692
loss_r_feature 0.8190479874610901
main criterion 0.00019783072639256716
------------iteration 2000----------
total loss 0.17412590980529785
loss_r_feature 0.7765454649925232
main criterion 0.00019896571757271886
------------iteration 2100----------
total loss 0.7404311299324036
loss_r_feature 3.916076183319092
main criterion 0.001460482832044363
------------iteration 2200----------
total loss 0.7299788594245911
loss_r_feature 3.061450481414795
main criterion 0.0012384146684780717
------------iteration 2300----------
total loss 0.6655627489089966
loss_r_feature 2.8244388103485107
main criterion 0.0015487155178561807
------------iteration 2400----------
total loss 0.6238775849342346
loss_r_feature 2.8018832206726074
main criterion 0.0011996972607448697
------------iteration 2500----------
total loss 0.5654450058937073
loss_r_feature 2.780742883682251
main criterion 0.0016947571421042085
------------iteration 2600----------
total loss 0.4796883463859558
loss_r_feature 1.819780945777893
main criterion 0.0006787789170630276
------------iteration 2700----------
total loss 0.39069467782974243
loss_r_feature 1.392828345298767
main criterion 0.0004617154481820762
------------iteration 2800----------
total loss 0.33045658469200134
loss_r_feature 1.5213913917541504
main criterion 0.0005631764652207494
------------iteration 2900----------
total loss 0.25305187702178955
loss_r_feature 0.732441782951355
main criterion 0.0005143110174685717
------------iteration 3000----------
total loss 0.2375677525997162
loss_r_feature 0.6672408580780029
main criterion 0.0006202076910994947
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_44', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=44, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 44 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.19358491897583
loss_r_feature 8.624411582946777
main criterion 0.3120028078556061
------------iteration 200----------
total loss 0.9116419553756714
loss_r_feature 5.864677906036377
main criterion 0.0923071950674057
------------iteration 300----------
total loss 0.7626089453697205
loss_r_feature 4.972080707550049
main criterion 0.010362296365201473
------------iteration 400----------
total loss 0.6927725672721863
loss_r_feature 4.106547832489014
main criterion 0.0447373166680336
------------iteration 500----------
total loss 0.6142579317092896
loss_r_feature 3.3350112438201904
main criterion 0.012012251652777195
------------iteration 600----------
total loss 0.6084086894989014
loss_r_feature 3.4013137817382812
main criterion 0.009952336549758911
------------iteration 700----------
total loss 0.6008531451225281
loss_r_feature 3.755464792251587
main criterion 0.0020779625046998262
------------iteration 800----------
total loss 0.5457978248596191
loss_r_feature 3.19771671295166
main criterion 0.00597224710509181
------------iteration 900----------
total loss 0.4969535768032074
loss_r_feature 2.4569687843322754
main criterion 0.0007064496749080718
------------iteration 1000----------
total loss 0.45375698804855347
loss_r_feature 2.047593116760254
main criterion 0.0005940659902989864
------------iteration 1100----------
total loss 0.4663929045200348
loss_r_feature 2.7610418796539307
main criterion 0.0035502915270626545
------------iteration 1200----------
total loss 0.5527719855308533
loss_r_feature 3.5229673385620117
main criterion 0.07975046336650848
------------iteration 1300----------
total loss 0.37101808190345764
loss_r_feature 1.9110559225082397
main criterion 0.0004707269254140556
------------iteration 1400----------
total loss 0.34014299511909485
loss_r_feature 1.8144315481185913
main criterion 0.0006403719307854772
------------iteration 1500----------
total loss 0.29406118392944336
loss_r_feature 1.3903849124908447
main criterion 0.0003662000235635787
------------iteration 1600----------
total loss 0.28250327706336975
loss_r_feature 1.5928747653961182
main criterion 0.0004622940323315561
------------iteration 1700----------
total loss 0.23551791906356812
loss_r_feature 1.0169564485549927
main criterion 0.00026976916706189513
------------iteration 1800----------
total loss 0.21556706726551056
loss_r_feature 0.8873322606086731
main criterion 0.00024196357117034495
------------iteration 1900----------
total loss 0.21362091600894928
loss_r_feature 0.9911800622940063
main criterion 0.00017899283557198942
------------iteration 2000----------
total loss 0.20997363328933716
loss_r_feature 0.9410595893859863
main criterion 0.00022988766431808472
------------iteration 2100----------
total loss 0.8135561347007751
loss_r_feature 3.6055054664611816
main criterion 0.0033188944216817617
------------iteration 2200----------
total loss 0.797256350517273
loss_r_feature 2.0017285346984863
main criterion 0.0011289222165942192
------------iteration 2300----------
total loss 0.8243222236633301
loss_r_feature 2.7362849712371826
main criterion 0.0012884852476418018
------------iteration 2400----------
total loss 0.8551724553108215
loss_r_feature 3.6722593307495117
main criterion 0.0022705744486302137
------------iteration 2500----------
total loss 0.6600764393806458
loss_r_feature 2.0523157119750977
main criterion 0.0013839476741850376
------------iteration 2600----------
total loss 0.6375517845153809
loss_r_feature 2.4203312397003174
main criterion 0.0013255325611680746
------------iteration 2700----------
total loss 0.5009116530418396
loss_r_feature 1.4839540719985962
main criterion 0.0005386039265431464
------------iteration 2800----------
total loss 0.4019032120704651
loss_r_feature 0.8888765573501587
main criterion 0.0006609094562008977
------------iteration 2900----------
total loss 0.36008360981941223
loss_r_feature 1.053051471710205
main criterion 0.00048035915824584663
------------iteration 3000----------
total loss 0.3269634246826172
loss_r_feature 0.6084691286087036
main criterion 0.0006090195383876562
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_45', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=45, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 45 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8457272052764893
loss_r_feature 4.4552507400512695
main criterion 0.1750471293926239
------------iteration 200----------
total loss 0.6508853435516357
loss_r_feature 2.912404775619507
main criterion 0.017395110800862312
------------iteration 300----------
total loss 0.5878849029541016
loss_r_feature 2.3271820545196533
main criterion 0.010703492909669876
------------iteration 400----------
total loss 0.522282063961029
loss_r_feature 1.8723978996276855
main criterion 0.005319263786077499
------------iteration 500----------
total loss 0.49942976236343384
loss_r_feature 1.4182721376419067
main criterion 0.0016467617824673653
------------iteration 600----------
total loss 0.4713031053543091
loss_r_feature 1.6384040117263794
main criterion 0.002119686920195818
------------iteration 700----------
total loss 0.4519394338130951
loss_r_feature 1.6738849878311157
main criterion 0.012300629168748856
------------iteration 800----------
total loss 0.44944924116134644
loss_r_feature 1.7107231616973877
main criterion 0.023144852370023727
------------iteration 900----------
total loss 0.361772745847702
loss_r_feature 0.9223202466964722
main criterion 0.0028880026657134295
------------iteration 1000----------
total loss 0.3405517041683197
loss_r_feature 0.9746677875518799
main criterion 0.0023465314880013466
------------iteration 1100----------
total loss 0.3182394206523895
loss_r_feature 0.9768726825714111
main criterion 0.0009630625718273222
------------iteration 1200----------
total loss 0.299722820520401
loss_r_feature 1.1108638048171997
main criterion 0.001005409867502749
------------iteration 1300----------
total loss 0.26049914956092834
loss_r_feature 0.8090168833732605
main criterion 0.003617970971390605
------------iteration 1400----------
total loss 0.23729155957698822
loss_r_feature 0.831082820892334
main criterion 0.002189460676163435
------------iteration 1500----------
total loss 0.2046806663274765
loss_r_feature 0.6697195768356323
main criterion 0.0002880707324948162
------------iteration 1600----------
total loss 0.19020144641399384
loss_r_feature 0.7705342173576355
main criterion 0.00029468818684108555
------------iteration 1700----------
total loss 0.1577509492635727
loss_r_feature 0.489779531955719
main criterion 0.00019987842824775726
------------iteration 1800----------
total loss 0.14311103522777557
loss_r_feature 0.44898125529289246
main criterion 0.00013178333756513894
------------iteration 1900----------
total loss 0.13691407442092896
loss_r_feature 0.45136934518814087
main criterion 0.0001869063125923276
------------iteration 2000----------
total loss 0.12996217608451843
loss_r_feature 0.3358554244041443
main criterion 0.00014670453674625605
------------iteration 2100----------
total loss 0.6340591311454773
loss_r_feature 1.0723479986190796
main criterion 0.040112655609846115
------------iteration 2200----------
total loss 0.6241679191589355
loss_r_feature 0.7691519260406494
main criterion 0.0006808697944507003
------------iteration 2300----------
total loss 0.6333406567573547
loss_r_feature 1.0397419929504395
main criterion 0.0009708012221381068
------------iteration 2400----------
total loss 0.5933719277381897
loss_r_feature 1.152326226234436
main criterion 0.0013103593373671174
------------iteration 2500----------
total loss 0.516176700592041
loss_r_feature 0.7951200008392334
main criterion 0.0006957654841244221
------------iteration 2600----------
total loss 0.45001086592674255
loss_r_feature 1.1947355270385742
main criterion 0.0009194776648655534
------------iteration 2700----------
total loss 0.3434927761554718
loss_r_feature 0.6725896596908569
main criterion 0.00032190897036343813
------------iteration 2800----------
total loss 0.27381330728530884
loss_r_feature 0.557365894317627
main criterion 0.0004198782262392342
------------iteration 2900----------
total loss 0.2241113930940628
loss_r_feature 0.547907292842865
main criterion 0.00028556774486787617
------------iteration 3000----------
total loss 0.20456735789775848
loss_r_feature 0.38775280117988586
main criterion 0.00043357754475437105
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_46', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=46, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 46 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.2060935497283936
loss_r_feature 8.581121444702148
main criterion 0.3364049792289734
------------iteration 200----------
total loss 1.055701732635498
loss_r_feature 8.064047813415527
main criterion 0.15856890380382538
------------iteration 300----------
total loss 0.790730893611908
loss_r_feature 6.915383815765381
main criterion 0.00395614467561245
------------iteration 400----------
total loss 0.6856479644775391
loss_r_feature 5.854596138000488
main criterion 0.017333559691905975
------------iteration 500----------
total loss 0.6244475245475769
loss_r_feature 5.159601211547852
main criterion 0.0014726268127560616
------------iteration 600----------
total loss 0.6125332713127136
loss_r_feature 5.0597639083862305
main criterion 0.001697119907476008
------------iteration 700----------
total loss 0.5800504684448242
loss_r_feature 4.699941635131836
main criterion 0.0013360243756324053
------------iteration 800----------
total loss 0.5071820020675659
loss_r_feature 4.427006244659424
main criterion 0.014517375268042088
------------iteration 900----------
total loss 0.4309141933917999
loss_r_feature 3.1077260971069336
main criterion 0.0020986502058804035
------------iteration 1000----------
total loss 0.3856161832809448
loss_r_feature 2.769434690475464
main criterion 0.0006583810318261385
------------iteration 1100----------
total loss 0.33282536268234253
loss_r_feature 2.415677785873413
main criterion 0.0005724735092371702
------------iteration 1200----------
total loss 0.29731738567352295
loss_r_feature 2.132861852645874
main criterion 0.0011485253926366568
------------iteration 1300----------
total loss 0.26154935359954834
loss_r_feature 1.8148446083068848
main criterion 0.00030184932984411716
------------iteration 1400----------
total loss 0.2421739250421524
loss_r_feature 1.7582542896270752
main criterion 0.0006413557566702366
------------iteration 1500----------
total loss 0.21745620667934418
loss_r_feature 1.6779488325119019
main criterion 0.0006574817816726863
------------iteration 1600----------
total loss 0.18442697823047638
loss_r_feature 1.3233221769332886
main criterion 0.0006385429878719151
------------iteration 1700----------
total loss 0.1628662347793579
loss_r_feature 1.1601983308792114
main criterion 0.00025078526232391596
------------iteration 1800----------
total loss 0.145542711019516
loss_r_feature 1.0307986736297607
main criterion 0.00025769189232960343
------------iteration 1900----------
total loss 0.13557937741279602
loss_r_feature 0.9411798715591431
main criterion 0.00020641308219637722
------------iteration 2000----------
total loss 0.12917698919773102
loss_r_feature 0.8351172208786011
main criterion 0.00023859164502937347
------------iteration 2100----------
total loss 0.6305657029151917
loss_r_feature 3.0989203453063965
main criterion 0.0056123025715351105
------------iteration 2200----------
total loss 0.6351199150085449
loss_r_feature 2.7903544902801514
main criterion 0.002014177618548274
------------iteration 2300----------
total loss 0.5651516914367676
loss_r_feature 2.8494668006896973
main criterion 0.0009278722573071718
------------iteration 2400----------
total loss 0.5366067886352539
loss_r_feature 2.9586265087127686
main criterion 0.0018441317370161414
------------iteration 2500----------
total loss 0.4871472120285034
loss_r_feature 2.653747081756592
main criterion 0.0006273420294746757
------------iteration 2600----------
total loss 0.39459046721458435
loss_r_feature 1.8024189472198486
main criterion 0.000909418857190758
------------iteration 2700----------
total loss 0.31499987840652466
loss_r_feature 1.2396602630615234
main criterion 0.0003343932912684977
------------iteration 2800----------
total loss 0.2631247937679291
loss_r_feature 1.3219101428985596
main criterion 0.0003903074830304831
------------iteration 2900----------
total loss 0.19491620361804962
loss_r_feature 0.7387175559997559
main criterion 0.0004561467212624848
------------iteration 3000----------
total loss 0.18059822916984558
loss_r_feature 0.6764980554580688
main criterion 0.00047782587353140116
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_47', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=47, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 47 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 2.0927090644836426
loss_r_feature 29.869464874267578
main criterion 0.1272362917661667
------------iteration 200----------
total loss 2.1614990234375
loss_r_feature 28.0833740234375
main criterion 0.1824946403503418
------------iteration 300----------
total loss 1.8749324083328247
loss_r_feature 24.568483352661133
main criterion 0.07093314081430435
------------iteration 400----------
total loss 1.7810232639312744
loss_r_feature 23.305482864379883
main criterion 0.045790817588567734
------------iteration 500----------
total loss 1.6989227533340454
loss_r_feature 20.16541290283203
main criterion 0.12241367250680923
------------iteration 600----------
total loss 1.6768594980239868
loss_r_feature 20.751544952392578
main criterion 0.07415565103292465
------------iteration 700----------
total loss 1.601324200630188
loss_r_feature 20.70165252685547
main criterion 0.015772799029946327
------------iteration 800----------
total loss 1.5839945077896118
loss_r_feature 19.383270263671875
main criterion 0.08129075169563293
------------iteration 900----------
total loss 1.2297316789627075
loss_r_feature 14.202494621276855
main criterion 0.0034171072766184807
------------iteration 1000----------
total loss 1.195837140083313
loss_r_feature 13.938485145568848
main criterion 0.0032412877772003412
------------iteration 1100----------
total loss 1.1231061220169067
loss_r_feature 12.80865478515625
main criterion 0.008233283646404743
------------iteration 1200----------
total loss 0.9648683667182922
loss_r_feature 10.256123542785645
main criterion 0.0037778099067509174
------------iteration 1300----------
total loss 0.8648841381072998
loss_r_feature 8.724862098693848
main criterion 0.003685783129185438
------------iteration 1400----------
total loss 0.8028299808502197
loss_r_feature 7.969818592071533
main criterion 0.001952471793629229
------------iteration 1500----------
total loss 0.7324471473693848
loss_r_feature 7.052746772766113
main criterion 0.002138101728633046
------------iteration 1600----------
total loss 0.7350026369094849
loss_r_feature 7.465974807739258
main criterion 0.0037720196414738894
------------iteration 1700----------
total loss 0.591981828212738
loss_r_feature 4.9111328125
main criterion 0.0018764135893434286
------------iteration 1800----------
total loss 0.5827730894088745
loss_r_feature 4.932303428649902
main criterion 0.0022335629910230637
------------iteration 1900----------
total loss 0.6567533612251282
loss_r_feature 6.521151542663574
main criterion 0.0015142380725592375
------------iteration 2000----------
total loss 0.5399314165115356
loss_r_feature 4.2009429931640625
main criterion 0.0014702881453558803
------------iteration 2100----------
total loss 1.7095166444778442
loss_r_feature 15.938438415527344
main criterion 0.0056276400573551655
------------iteration 2200----------
total loss 1.9550976753234863
loss_r_feature 18.402725219726562
main criterion 0.0047160545364022255
------------iteration 2300----------
total loss 1.9839214086532593
loss_r_feature 19.070098876953125
main criterion 0.005354671739041805
------------iteration 2400----------
total loss 1.8989454507827759
loss_r_feature 18.219131469726562
main criterion 0.016312023624777794
------------iteration 2500----------
total loss 1.5650041103363037
loss_r_feature 13.171710968017578
main criterion 0.006751243490725756
------------iteration 2600----------
total loss 1.3141578435897827
loss_r_feature 9.524079322814941
main criterion 0.004890193697065115
------------iteration 2700----------
total loss 1.1196552515029907
loss_r_feature 7.244722843170166
main criterion 0.0028181530069559813
------------iteration 2800----------
total loss 1.0142759084701538
loss_r_feature 6.654720783233643
main criterion 0.00282512279227376
------------iteration 2900----------
total loss 0.9077397584915161
loss_r_feature 5.4170122146606445
main criterion 0.0022829119116067886
------------iteration 3000----------
total loss 0.8647699952125549
loss_r_feature 4.727053165435791
main criterion 0.0030584526248276234
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_48', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=48, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 48 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.8630587458610535
loss_r_feature 7.517110824584961
main criterion 0.025718489661812782
------------iteration 200----------
total loss 1.028913140296936
loss_r_feature 6.6438703536987305
main criterion 0.15961132943630219
------------iteration 300----------
total loss 0.8079337477684021
loss_r_feature 5.087482929229736
main criterion 0.016068950295448303
------------iteration 400----------
total loss 0.8102273344993591
loss_r_feature 5.745449542999268
main criterion 0.005695080850273371
------------iteration 500----------
total loss 0.71164870262146
loss_r_feature 4.1005778312683105
main criterion 0.0034390545915812254
------------iteration 600----------
total loss 0.7078939080238342
loss_r_feature 4.189507007598877
main criterion 0.0032686253543943167
------------iteration 700----------
total loss 0.659339189529419
loss_r_feature 3.572430372238159
main criterion 0.004570699296891689
------------iteration 800----------
total loss 0.7831249833106995
loss_r_feature 5.482667922973633
main criterion 0.048392556607723236
------------iteration 900----------
total loss 0.5571326017379761
loss_r_feature 2.638969659805298
main criterion 0.002108935033902526
------------iteration 1000----------
total loss 0.5950557589530945
loss_r_feature 3.651073455810547
main criterion 0.002113667316734791
------------iteration 1100----------
total loss 0.5351080894470215
loss_r_feature 2.854649543762207
main criterion 0.0015062394086271524
------------iteration 1200----------
total loss 0.5107691884040833
loss_r_feature 2.9070935249328613
main criterion 0.0018034126842394471
------------iteration 1300----------
total loss 0.45051994919776917
loss_r_feature 2.2497434616088867
main criterion 0.0009516454301774502
------------iteration 1400----------
total loss 0.42271527647972107
loss_r_feature 2.3352839946746826
main criterion 0.0015655538300052285
------------iteration 1500----------
total loss 0.36173275113105774
loss_r_feature 1.7194621562957764
main criterion 0.0006671113078482449
------------iteration 1600----------
total loss 0.39967143535614014
loss_r_feature 2.8701891899108887
main criterion 0.003715518396347761
------------iteration 1700----------
total loss 0.30845823884010315
loss_r_feature 1.51131272315979
main criterion 0.0008669832604937255
------------iteration 1800----------
total loss 0.27707692980766296
loss_r_feature 1.1459598541259766
main criterion 0.0006584758521057665
------------iteration 1900----------
total loss 0.26982253789901733
loss_r_feature 1.144645094871521
main criterion 0.0004830719262827188
------------iteration 2000----------
total loss 0.29176151752471924
loss_r_feature 1.6022158861160278
main criterion 0.0007373644621111453
------------iteration 2100----------
total loss 0.9617483615875244
loss_r_feature 3.868378162384033
main criterion 0.008320336230099201
------------iteration 2200----------
total loss 1.0262154340744019
loss_r_feature 2.9093146324157715
main criterion 0.0030279443599283695
------------iteration 2300----------
total loss 0.9796143174171448
loss_r_feature 2.7499735355377197
main criterion 0.0017516548978164792
------------iteration 2400----------
total loss 1.0358725786209106
loss_r_feature 4.012122631072998
main criterion 0.004208248108625412
------------iteration 2500----------
total loss 0.8370189070701599
loss_r_feature 2.338137149810791
main criterion 0.0024528305511921644
------------iteration 2600----------
total loss 0.8031971454620361
loss_r_feature 3.333312511444092
main criterion 0.0016694075893610716
------------iteration 2700----------
total loss 0.6843842267990112
loss_r_feature 2.8009634017944336
main criterion 0.0013549759751185775
------------iteration 2800----------
total loss 0.5309262871742249
loss_r_feature 1.3073228597640991
main criterion 0.0013734467793256044
------------iteration 2900----------
total loss 0.4612125754356384
loss_r_feature 1.0077264308929443
main criterion 0.0010068750707432628
------------iteration 3000----------
total loss 0.43909960985183716
loss_r_feature 0.8055675625801086
main criterion 0.0013290721690282226
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_49', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=49, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 49 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.243492841720581
loss_r_feature 3.7148280143737793
main criterion 0.5823715925216675
------------iteration 200----------
total loss 0.6614867448806763
loss_r_feature 2.229677438735962
main criterion 0.04015466570854187
------------iteration 300----------
total loss 0.5388975739479065
loss_r_feature 1.5808706283569336
main criterion 0.0029092817567288876
------------iteration 400----------
total loss 0.504684329032898
loss_r_feature 1.5523494482040405
main criterion 0.004698772914707661
------------iteration 500----------
total loss 0.46768200397491455
loss_r_feature 1.1609746217727661
main criterion 0.002380626043304801
------------iteration 600----------
total loss 0.4710295796394348
loss_r_feature 1.3093851804733276
main criterion 0.001960162539035082
------------iteration 700----------
total loss 0.43208417296409607
loss_r_feature 1.214719295501709
main criterion 0.0061990050598979
------------iteration 800----------
total loss 0.43286770582199097
loss_r_feature 1.287408471107483
main criterion 0.010470000095665455
------------iteration 900----------
total loss 0.3678472936153412
loss_r_feature 0.7422972917556763
main criterion 0.00047547862050123513
------------iteration 1000----------
total loss 0.342482328414917
loss_r_feature 0.846967339515686
main criterion 0.0007918541668914258
------------iteration 1100----------
total loss 0.3200579881668091
loss_r_feature 0.798008382320404
main criterion 0.0008628202485851943
------------iteration 1200----------
total loss 0.2985753118991852
loss_r_feature 0.9481455087661743
main criterion 0.00036653311690315604
------------iteration 1300----------
total loss 0.26421165466308594
loss_r_feature 0.7198970317840576
main criterion 0.0005949347978457808
------------iteration 1400----------
total loss 0.23855353891849518
loss_r_feature 0.736962080001831
main criterion 0.0007461190689355135
------------iteration 1500----------
total loss 0.20538774132728577
loss_r_feature 0.5750085115432739
main criterion 0.0003498367441352457
------------iteration 1600----------
total loss 0.1956188827753067
loss_r_feature 0.8195005655288696
main criterion 0.0004188563907518983
------------iteration 1700----------
total loss 0.1617210954427719
loss_r_feature 0.5078117847442627
main criterion 0.0003908727958332747
------------iteration 1800----------
total loss 0.14390450716018677
loss_r_feature 0.41244906187057495
main criterion 0.00029307432123459876
------------iteration 1900----------
total loss 0.13416220247745514
loss_r_feature 0.3515647351741791
main criterion 0.00030419774702750146
------------iteration 2000----------
total loss 0.13226985931396484
loss_r_feature 0.33896076679229736
main criterion 0.0002322603831999004
------------iteration 2100----------
total loss 0.6824414134025574
loss_r_feature 1.0287396907806396
main criterion 0.0015497459098696709
------------iteration 2200----------
total loss 0.6903383731842041
loss_r_feature 0.812372624874115
main criterion 0.0019152031745761633
------------iteration 2300----------
total loss 0.6584944128990173
loss_r_feature 0.8417192697525024
main criterion 0.001587793929502368
------------iteration 2400----------
total loss 0.6395785808563232
loss_r_feature 1.1178154945373535
main criterion 0.003033185377717018
------------iteration 2500----------
total loss 0.5356885194778442
loss_r_feature 0.8508133888244629
main criterion 0.0018483309540897608
------------iteration 2600----------
total loss 0.4460965096950531
loss_r_feature 0.8822464346885681
main criterion 0.0011422702809795737
------------iteration 2700----------
total loss 0.37669506669044495
loss_r_feature 0.904883623123169
main criterion 0.0006140160257928073
------------iteration 2800----------
total loss 0.28058886528015137
loss_r_feature 0.4334510564804077
main criterion 0.0005670214886777103
------------iteration 2900----------
total loss 0.23502838611602783
loss_r_feature 0.5690379738807678
main criterion 0.0004809225210919976
------------iteration 3000----------
total loss 0.21144762635231018
loss_r_feature 0.3303629159927368
main criterion 0.0005677881999872625
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_50', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=50, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 50 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 3.7185862064361572
loss_r_feature 59.6345329284668
main criterion 0.2229754626750946
------------iteration 200----------
total loss 2.6209187507629395
loss_r_feature 38.71752166748047
main criterion 0.028987934812903404
------------iteration 300----------
total loss 2.739713191986084
loss_r_feature 37.34061813354492
main criterion 0.20393836498260498
------------iteration 400----------
total loss 2.796252965927124
loss_r_feature 39.87846374511719
main criterion 0.12885920703411102
------------iteration 500----------
total loss 2.1640961170196533
loss_r_feature 29.31952476501465
main criterion 0.022152408957481384
------------iteration 600----------
total loss 2.3319637775421143
loss_r_feature 31.21157455444336
main criterion 0.09370695799589157
------------iteration 700----------
total loss 2.37782883644104
loss_r_feature 34.152259826660156
main criterion 0.0074160136282444
------------iteration 800----------
total loss 2.3500969409942627
loss_r_feature 31.42521095275879
main criterion 0.12036839872598648
------------iteration 900----------
total loss 1.9102553129196167
loss_r_feature 24.503318786621094
main criterion 0.04675573855638504
------------iteration 1000----------
total loss 2.0147628784179688
loss_r_feature 27.511137008666992
main criterion 0.010242706164717674
------------iteration 1100----------
total loss 1.813712239265442
loss_r_feature 23.65198516845703
main criterion 0.013565889559686184
------------iteration 1200----------
total loss 1.6678870916366577
loss_r_feature 21.176624298095703
main criterion 0.015166664496064186
------------iteration 1300----------
total loss 1.5204131603240967
loss_r_feature 18.6874942779541
main criterion 0.012213319540023804
------------iteration 1400----------
total loss 1.3924940824508667
loss_r_feature 16.538619995117188
main criterion 0.010321605019271374
------------iteration 1500----------
total loss 1.2465214729309082
loss_r_feature 14.060476303100586
main criterion 0.00968202855437994
------------iteration 1600----------
total loss 1.188928246498108
loss_r_feature 13.280673027038574
main criterion 0.006739388685673475
------------iteration 1700----------
total loss 1.0779985189437866
loss_r_feature 11.261722564697266
main criterion 0.009067310020327568
------------iteration 1800----------
total loss 1.0084311962127686
loss_r_feature 10.080196380615234
main criterion 0.0072257923893630505
------------iteration 1900----------
total loss 1.253385305404663
loss_r_feature 15.015592575073242
main criterion 0.009539850056171417
------------iteration 2000----------
total loss 1.1053770780563354
loss_r_feature 12.149717330932617
main criterion 0.005300265736877918
------------iteration 2100----------
total loss 2.4487905502319336
loss_r_feature 26.38357162475586
main criterion 0.027345577254891396
------------iteration 2200----------
total loss 2.661405086517334
loss_r_feature 26.81236457824707
main criterion 0.014691631309688091
------------iteration 2300----------
total loss 2.909851312637329
loss_r_feature 31.871013641357422
main criterion 0.011068833991885185
------------iteration 2400----------
total loss 2.997929811477661
loss_r_feature 33.5109748840332
main criterion 0.038092441856861115
------------iteration 2500----------
total loss 2.3518426418304443
loss_r_feature 22.03396224975586
main criterion 0.03593761473894119
------------iteration 2600----------
total loss 2.0413060188293457
loss_r_feature 17.578248977661133
main criterion 0.014922038652002811
------------iteration 2700----------
total loss 2.2445619106292725
loss_r_feature 23.021955490112305
main criterion 0.009910987690091133
------------iteration 2800----------
total loss 1.811198115348816
loss_r_feature 15.681915283203125
main criterion 0.008010423742234707
------------iteration 2900----------
total loss 1.536738395690918
loss_r_feature 10.940962791442871
main criterion 0.007478214334696531
------------iteration 3000----------
total loss 1.6291089057922363
loss_r_feature 12.882861137390137
main criterion 0.010294364765286446
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_51', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=51, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 51 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 1.0363590717315674
loss_r_feature 6.404431343078613
main criterion 0.25039076805114746
------------iteration 200----------
total loss 0.9140120148658752
loss_r_feature 5.421230792999268
main criterion 0.04437233880162239
------------iteration 300----------
total loss 0.959643542766571
loss_r_feature 5.771661758422852
main criterion 0.06500378996133804
------------iteration 400----------
total loss 1.0441498756408691
loss_r_feature 6.065125465393066
main criterion 0.14188431203365326
------------iteration 500----------
total loss 0.8659656047821045
loss_r_feature 5.133274078369141
main criterion 0.017959194257855415
------------iteration 600----------
total loss 0.8143592476844788
loss_r_feature 4.42741060256958
main criterion 0.006600629072636366
------------iteration 700----------
total loss 0.7585767507553101
loss_r_feature 3.5725693702697754
main criterion 0.015643225982785225
------------iteration 800----------
total loss 0.7455939650535583
loss_r_feature 3.5603890419006348
main criterion 0.010071761906147003
------------iteration 900----------
total loss 0.6898044347763062
loss_r_feature 2.9828715324401855
main criterion 0.003597476053982973
------------iteration 1000----------
total loss 0.9066697359085083
loss_r_feature 4.968229293823242
main criterion 0.14085176587104797
------------iteration 1100----------
total loss 0.6327276229858398
loss_r_feature 2.705174446105957
main criterion 0.004698286298662424
------------iteration 1200----------
total loss 0.8739995956420898
loss_r_feature 6.23587703704834
main criterion 0.09369836747646332
------------iteration 1300----------
total loss 0.5808257460594177
loss_r_feature 2.8904991149902344
main criterion 0.0031335484236478806
------------iteration 1400----------
total loss 0.49493637681007385
loss_r_feature 1.747958779335022
main criterion 0.004505856893956661
------------iteration 1500----------
total loss 0.47500747442245483
loss_r_feature 2.056079864501953
main criterion 0.0026865978725254536
------------iteration 1600----------
total loss 0.4267549514770508
loss_r_feature 1.491647481918335
main criterion 0.0035960059612989426
------------iteration 1700----------
total loss 0.3997305929660797
loss_r_feature 1.359785556793213
main criterion 0.003227202221751213
------------iteration 1800----------
total loss 0.3752797245979309
loss_r_feature 1.1553030014038086
main criterion 0.0022581841330975294
------------iteration 1900----------
total loss 0.3722229301929474
loss_r_feature 1.2206716537475586
main criterion 0.00224259402602911
------------iteration 2000----------
total loss 0.41202738881111145
loss_r_feature 2.0446860790252686
main criterion 0.0017952326452359557
------------iteration 2100----------
total loss 1.1399800777435303
loss_r_feature 3.967897653579712
main criterion 0.007441674824804068
------------iteration 2200----------
total loss 1.2161909341812134
loss_r_feature 3.2756402492523193
main criterion 0.006006241776049137
------------iteration 2300----------
total loss 1.2500208616256714
loss_r_feature 4.386602401733398
main criterion 0.008662783540785313
------------iteration 2400----------
total loss 1.3186653852462769
loss_r_feature 6.2328410148620605
main criterion 0.023899180814623833
------------iteration 2500----------
total loss 1.0801244974136353
loss_r_feature 3.4071004390716553
main criterion 0.00634925439953804
------------iteration 2600----------
total loss 0.9254035949707031
loss_r_feature 2.0051090717315674
main criterion 0.004713890608400106
------------iteration 2700----------
total loss 0.8304261565208435
loss_r_feature 2.2759487628936768
main criterion 0.003950957674533129
------------iteration 2800----------
total loss 0.7062653303146362
loss_r_feature 1.5045064687728882
main criterion 0.0036813844926655293
------------iteration 2900----------
total loss 0.6297212839126587
loss_r_feature 1.0531872510910034
main criterion 0.0027853993233293295
------------iteration 3000----------
total loss 0.6251986026763916
loss_r_feature 1.2030665874481201
main criterion 0.0029368028044700623
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_52', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=52, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Confirming BN layer 52 specified
get_images call
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
------------iteration 100----------
total loss 0.7567978501319885
loss_r_feature 3.796804428100586
main criterion 0.10713683068752289
------------iteration 200----------
total loss 0.7286089062690735
loss_r_feature 2.605719566345215
main criterion 0.04591735452413559
------------iteration 300----------
total loss 0.6286371946334839
loss_r_feature 2.1476004123687744
main criterion 0.005763869732618332
------------iteration 400----------
total loss 0.614168643951416
loss_r_feature 1.69858717918396
main criterion 0.05177807807922363
------------iteration 500----------
total loss 0.5225605368614197
loss_r_feature 1.2848864793777466
main criterion 0.005744500085711479
------------iteration 600----------
total loss 0.5101230144500732
loss_r_feature 1.3475842475891113
main criterion 0.0026991991326212883
------------iteration 700----------
total loss 0.5012457370758057
loss_r_feature 1.259368896484375
main criterion 0.024160413071513176
------------iteration 800----------
total loss 0.4665699005126953
loss_r_feature 1.499642252922058
main criterion 0.003146324073895812
------------iteration 900----------
total loss 0.40686458349227905
loss_r_feature 0.9431177973747253
main criterion 0.001723648514598608
------------iteration 1000----------
total loss 0.3766108751296997
loss_r_feature 0.9269095659255981
main criterion 0.0020042727701365948
------------iteration 1100----------
total loss 0.36260780692100525
loss_r_feature 0.991295576095581
main criterion 0.006687795277684927
------------iteration 1200----------
total loss 0.33323439955711365
loss_r_feature 1.095099687576294
main criterion 0.003512198803946376
------------iteration 1300----------
total loss 0.28807154297828674
loss_r_feature 0.8694043159484863
main criterion 0.0009822370484471321
------------iteration 1400----------
total loss 0.2629612386226654
loss_r_feature 0.8971713781356812
main criterion 0.0015770342433825135
------------iteration 1500----------
total loss 0.2316448986530304
loss_r_feature 0.805547297000885
main criterion 0.0011056093499064445
------------iteration 1600----------
total loss 0.2082604169845581
loss_r_feature 0.8093118667602539
main criterion 0.0012174074072390795
------------iteration 1700----------
total loss 0.1747523844242096
loss_r_feature 0.5567777156829834
main criterion 0.0008020871900953352
------------iteration 1800----------
total loss 0.16008888185024261
loss_r_feature 0.5352495908737183
main criterion 0.0006296784849837422
------------iteration 1900----------
total loss 0.15043652057647705
loss_r_feature 0.4782617390155792
main criterion 0.0005841711536049843
------------iteration 2000----------
total loss 0.14732734858989716
loss_r_feature 0.4400712847709656
main criterion 0.0005229903035797179
------------iteration 2100----------
total loss 0.7038133144378662
loss_r_feature 0.8967500329017639
main criterion 0.002403055550530553
------------iteration 2200----------
total loss 0.6968503594398499
loss_r_feature 0.8075990676879883
main criterion 0.002155802445486188
------------iteration 2300----------
total loss 0.666228175163269
loss_r_feature 0.9152175188064575
main criterion 0.001825769548304379
------------iteration 2400----------
total loss 0.6856706738471985
loss_r_feature 1.100441336631775
main criterion 0.008167163468897343
------------iteration 2500----------
total loss 0.5428066849708557
loss_r_feature 0.7452383637428284
main criterion 0.0026140662375837564
------------iteration 2600----------
total loss 0.45861607789993286
loss_r_feature 0.7055348753929138
main criterion 0.002464170567691326
------------iteration 2700----------
total loss 0.378256231546402
loss_r_feature 0.7942038774490356
main criterion 0.0020352215506136417
------------iteration 2800----------
total loss 0.2865821123123169
loss_r_feature 0.5507287383079529
main criterion 0.0010783574543893337
------------iteration 2900----------
total loss 0.23899199068546295
loss_r_feature 0.6602287292480469
main criterion 0.0006672152085229754
------------iteration 3000----------
total loss 0.21553277969360352
loss_r_feature 0.41770875453948975
main criterion 0.0009473596001043916
Namespace(adi_scale=0.0, all_targets=False, arch_name='resnet50', bs=42, comment='', do_flip=False, epochs=20000, exp_name='exp1_layer_53', first_bn_multiplier=10.0, fp16=False, jitter=30, l2=1e-05, local_rank=0, lr=0.2, main_loss_multiplier=1.0, no_cuda=False, r_feature=0.05, random_label=False, setting_id=0, specified_layer=53, stop_layer=None, store_best_images=True, targets='1,2,11,25,63,92,94,107,151,154,207,250,270,277,283,292,340,288,289,344,385,386,466,599,607,776,907,955,972,937,930,904,890,845,763,661,499,490,489,479,430,402', tv_l1=0.0, tv_l2=0.0001, verifier=False, verifier_arch='mobilenet_v2', worldsize=1)
loading torchvision model for inversion with the name: resnet50
==> Resuming from checkpoint..
Deep inversion class generation
Traceback (most recent call last):
  File "imagenet_inversion.py", line 243, in <module>
    main()
  File "imagenet_inversion.py", line 239, in main
    run(args)
  File "imagenet_inversion.py", line 189, in run
    specified_layer=args.specified_layer)
  File "/content/drive/My Drive/dl/RIDeepInversion/DI-Aaron/deepinversion.py", line 212, in __init__
    assert specified_layer < bn_layer_ct, f"specified_layer must be less than {bn_layer_ct} for this {self.net_teacher.__class__.__name__} model"
AssertionError: specified_layer must be less than 53 for this ResNet model
